<!DOCTYPE html><html lang="en" class="h-full"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.ico"><meta name="generator" content="Astro v5.5.3"><!-- Canonical URL --><link rel="canonical" href="https://ckvv.net/blog/react/react-apicompoent/"><!-- Primary Meta Tags --><title>React API &amp; ç»„ä»¶</title><meta name="title" content="React API &#38; ç»„ä»¶"><meta name="description" content="Welcome to my website!"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://ckvv.net/blog/react/react-apicompoent/"><meta property="og:title" content="React API &#38; ç»„ä»¶"><meta property="og:description" content="Welcome to my website!"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://ckvv.net/blog/react/react-apicompoent/"><meta property="twitter:title" content="React API &#38; ç»„ä»¶"><meta property="twitter:description" content="Welcome to my website!"><link rel="stylesheet" href="/_astro/about.CwStxpji.css">
<style>.outline-item-active[data-astro-cid-v2nb7cev]{color:var(--color-sky-700)}
</style></head> <body class="flex flex-col min-h-full"> <header class="sticky top-0 px-4 bg-white z-10 shadow-md"> <nav class="w-full max-w-6xl m-auto elect-none flex justify-between items-center text-2xl my-4"> <div class="flex gap-2 md:gap-4 items-center font-bold"> <h2><a href="/">CK Blog</a></h2> </div> <div class="flex gap-2 md:gap-4"> <a href="/" class="group clink cursor-pointer shrink-0 select-none relative flex items-center px-1"> Home <div class="h-1 bg-blue-500 w-0 group-hover:w-full transition-width duration-500 ease-in-out absolute -bottom-1 left-0" style=""></div> </a> <a href="/tag/" class="group clink cursor-pointer shrink-0 select-none relative flex items-center px-1"> Tag <div class="h-1 bg-blue-500 w-0 group-hover:w-full transition-width duration-500 ease-in-out absolute -bottom-1 left-0" style=""></div> </a> <a href="/assets/" class="group clink cursor-pointer shrink-0 select-none relative flex items-center hidden md:inline"> Assets <div class="h-1 bg-blue-500 w-0 group-hover:w-full transition-width duration-500 ease-in-out absolute -bottom-1 left-0" style=""></div> </a> <a href="/about/" class="group clink cursor-pointer shrink-0 select-none relative flex items-center px-1"> About <div class="h-1 bg-blue-500 w-0 group-hover:w-full transition-width duration-500 ease-in-out absolute -bottom-1 left-0" style=""></div> </a> <a href="https://github.com/ckvv/ckvv.github.io" target="_blank" aria-label="GitHub" class="hidden md:inline"> <svg viewBox="0 0 32 32" role="img" width="32" height="32" fill="none">
<path fill-rule="evenodd" clip-rule="evenodd" d="M16 0C7.16 0 0 7.16 0 16C0 23.08 4.58 29.06 10.94 31.18C11.74 31.32 12.04 30.84 12.04 30.42C12.04 30.04 12.02 28.78 12.02 27.44C8 28.18 6.96 26.46 6.64 25.56C6.46 25.1 5.68 23.68 5 23.3C4.44 23 3.64 22.26 4.98 22.24C6.24 22.22 7.14 23.4 7.44 23.88C8.88 26.3 11.18 25.62 12.1 25.2C12.24 24.16 12.66 23.46 13.12 23.06C9.56 22.66 5.84 21.28 5.84 15.16C5.84 13.42 6.46 11.98 7.48 10.86C7.32 10.46 6.76 8.82 7.64 6.62C7.64 6.62 8.98 6.2 12.04 8.26C13.32 7.9 14.68 7.72 16.04 7.72C17.4 7.72 18.76 7.9 20.04 8.26C23.1 6.18 24.44 6.62 24.44 6.62C25.32 8.82 24.76 10.46 24.6 10.86C25.62 11.98 26.24 13.4 26.24 15.16C26.24 21.3 22.5 22.66 18.94 23.06C19.52 23.56 20.02 24.52 20.02 26.02C20.02 28.16 20 29.88 20 30.42C20 30.84 20.3 31.34 21.1 31.18C27.42 29.06 32 23.06 32 16C32 7.16 24.84 0 16 0V0Z" fill="#24292E" />
</svg> </a> </div> </nav> </header> <main class="w-full max-w-5xl mx-auto px-4 py-8 flex-grow font-tabular-nums">  <h1 class="text-4xl font-bold my-4">React API &amp; ç»„ä»¶</h1>
  <div class="my-2 flex justify-between items-center"><div class="flex gap-4"><a href="/tag/react/" class="bg-gray-100 hover:bg-gray-300 text-sky-700 px-2 py-1 rounded cursor-pointer"> react </a></div><span> 2024/08/25 </span></div>
  <div class="sticky z-10 top-20 inline-block text-left w-full" data-astro-cid-v2nb7cev><div class="2xl:hidden flex justify-end" data-astro-cid-v2nb7cev><button type="button" class="inline-flex justify-center gap-x-1.5 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 hover:bg-gray-50" id="menu-button" aria-expanded="false" aria-haspopup="true" data-astro-cid-v2nb7cev>
On this page
<svg class="-mr-1 size-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" data-astro-cid-v2nb7cev><path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" data-astro-cid-v2nb7cev></path></svg></button></div><div id="md-outline-content" class="max-h-[calc(100vh-200px)] overflow-auto hidden absolute right-0 py-2 mt-2 min-w-48 max-w-full origin-top-right rounded-md bg-white ring-1 shadow-lg ring-black/5 focus:outline-hidden 2xl:-right-12 2xl:float-right 2xl:translate-x-full 2xl:max-w-[min(calc(50vw-580px),320px)]" aria-orientation="vertical" aria-labelledby="menu-button" tabindex="-1" data-astro-cid-v2nb7cev><a class="outline-item block px-4 py-1 text-sm break-all" href="#api" data-astro-cid-v2nb7cev>API</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#createcontext" data-astro-cid-v2nb7cev>createContext</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#forwardref" data-astro-cid-v2nb7cev>forwardRef</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#lazy" data-astro-cid-v2nb7cev>lazy</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#ä¸è¦åœ¨å…¶ä»–ç»„ä»¶-å†…éƒ¨-å£°æ˜-lazy-ç»„ä»¶" data-astro-cid-v2nb7cev>ä¸è¦åœ¨å…¶ä»–ç»„ä»¶ å†…éƒ¨ å£°æ˜ lazy ç»„ä»¶</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#memo" data-astro-cid-v2nb7cev>memo</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#å‚è€ƒ" data-astro-cid-v2nb7cev>å‚è€ƒ</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#å½“-props-æ²¡æœ‰æ”¹å˜æ—¶è·³è¿‡é‡æ–°æ¸²æŸ“" data-astro-cid-v2nb7cev>å½“ props æ²¡æœ‰æ”¹å˜æ—¶è·³è¿‡é‡æ–°æ¸²æŸ“</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#æœ€å°åŒ–-props-çš„å˜åŒ–" data-astro-cid-v2nb7cev>æœ€å°åŒ– props çš„å˜åŒ–</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°" data-astro-cid-v2nb7cev>è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#starttransition" data-astro-cid-v2nb7cev>startTransition</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#å°†-state-æ›´æ–°æ ‡è®°ä¸ºéé˜»å¡-transition" data-astro-cid-v2nb7cev>å°† state æ›´æ–°æ ‡è®°ä¸ºéé˜»å¡ transition</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#ç»„ä»¶" data-astro-cid-v2nb7cev>ç»„ä»¶</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#fragment" data-astro-cid-v2nb7cev>Fragment</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#profiler" data-astro-cid-v2nb7cev>Profiler</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#strictmode" data-astro-cid-v2nb7cev>StrictMode</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#suspense" data-astro-cid-v2nb7cev>Suspense</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#é€æ­¥åŠ è½½å†…å®¹" data-astro-cid-v2nb7cev>é€æ­¥åŠ è½½å†…å®¹</a><a class="outline-item block px-4 py-1 text-sm break-all" href="#åœ¨æ–°å†…å®¹åŠ è½½æ—¶å±•ç¤ºè¿‡æ—¶å†…å®¹" data-astro-cid-v2nb7cev>åœ¨æ–°å†…å®¹åŠ è½½æ—¶å±•ç¤ºè¿‡æ—¶å†…å®¹</a></div></div><script type="module">function f(n,o){let r,t;return(...c)=>{t?(clearTimeout(r),r=setTimeout(()=>{Date.now()-t>=o&&(n(...c),t=Date.now())},o-(Date.now()-t))):(n(...c),t=Date.now())}}function u(n){const o=document.getElementById("menu-button"),r=document.getElementById("md-outline-content"),t=n===void 0?o.getAttribute("aria-expanded")==="true":!n;o.setAttribute("aria-expanded",`${!t}`),r.style.display=t?"none":"block"}function l(){window.innerWidth>=1536&&u(!0)}window.addEventListener("resize",l);document.addEventListener("DOMContentLoaded",()=>{l();const n=document.getElementById("md-outline-content");n.onclick=e=>{e.preventDefault();const i=document.querySelector(e.target.getAttribute("href"));i&&window.scrollTo({top:i.offsetTop-64,behavior:"smooth"})};const o=document.getElementById("menu-button");o.onclick=()=>u(),document.onclick=e=>{if(window.innerWidth>=1536)return;const i=document.getElementById("md-outline-content");e.target.id!=="menu-button"&&!i.contains(e.target)&&o.getAttribute("aria-expanded")==="true"&&u()};const r=document.querySelector(".content").querySelectorAll("h1, h2, h3"),t=document.querySelectorAll(".outline-item"),c={root:null,rootMargin:"0px",threshold:.6},a=f(e=>{e.forEach(i=>{if(i.isIntersecting){const b=i.target.getAttribute("id");t.forEach(s=>{const d=`#${b}`;s.classList.remove("outline-item-active"),s.getAttribute("href")===d&&(s.classList.add("outline-item-active"),history.replaceState(null,"",d))})}})},200),m=new IntersectionObserver(a,c);r.forEach(e=>{m.observe(e)})});</script><div class="content"> <h1 id="api">API</h1>
<p>react åŒ…è¿˜å¯¼å‡ºäº†ä¸€äº›å…¶ä»–çš„ APIï¼Œè¿™äº› API å¯¹äºåˆ›å»ºç»„ä»¶éå¸¸æœ‰ç”¨</p>
<h2 id="createcontext">createContext</h2>
<p>å¯ä»¥åˆ›å»ºä¸€ä¸ª contextï¼Œä½ å¯ä»¥å°†å…¶æä¾›ç»™å­ç»„ä»¶ï¼Œé€šå¸¸ä¼šä¸ useContext ä¸€èµ·é…åˆä½¿ç”¨ã€‚</p>
<h2 id="forwardref">forwardRef</h2>
<p>å…è®¸ç»„ä»¶å°† DOM èŠ‚ç‚¹ä½œä¸º ref æš´éœ²ç»™çˆ¶ç»„ä»¶ã€‚</p>
<h2 id="lazy">lazy</h2>
<p>å…è®¸ä½ å»¶è¿ŸåŠ è½½ç»„ä»¶ï¼Œç›´åˆ°è¯¥ç»„ä»¶éœ€è¦ç¬¬ä¸€æ¬¡è¢«æ¸²æŸ“ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#B392F0">lazy</span><span style="color:#E1E4E8">(load);</span></span></code></pre>
<p>å‚æ•°</p>
<ul>
<li><code>load</code>: ä¸€ä¸ªè¿”å› Promise æˆ–å¦ä¸€ä¸ª thenableï¼ˆå…·æœ‰ then æ–¹æ³•çš„ç±» Promise å¯¹è±¡ï¼‰çš„å‡½æ•°ã€‚React ä¸ä¼šåœ¨ä½ å°è¯•é¦–æ¬¡æ¸²æŸ“è¿”å›çš„ç»„ä»¶ä¹‹å‰è°ƒç”¨ load å‡½æ•°ã€‚åœ¨ React é¦–æ¬¡è°ƒç”¨ load åï¼Œå®ƒå°†ç­‰å¾…å…¶è§£æï¼Œç„¶åå°†è§£æå€¼çš„ .default æ¸²æŸ“ä¸º React ç»„ä»¶ã€‚è¿”å›çš„ Promise å’Œ Promise çš„è§£æå€¼éƒ½å°†è¢«ç¼“å­˜ï¼Œå› æ­¤ React ä¸ä¼šå¤šæ¬¡è°ƒç”¨ load å‡½æ•°ã€‚å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™ React å°†æŠ›å‡ºæ‹’ç»åŸå› ç»™æœ€è¿‘çš„é”™è¯¯è¾¹ç•Œå¤„ç†ã€‚</li>
</ul>
<p>è¿”å›å€¼</p>
<ul>
<li>lazy è¿”å›ä¸€ä¸ª React ç»„ä»¶ï¼Œä½ å¯ä»¥åœ¨ fiber æ ‘ä¸­æ¸²æŸ“ã€‚å½“æ‡’åŠ è½½ç»„ä»¶çš„ä»£ç ä»åœ¨åŠ è½½æ—¶ï¼Œå°è¯•æ¸²æŸ“å®ƒå°†ä¼šå¤„äº æš‚åœ çŠ¶æ€ã€‚ä½¿ç”¨ <suspense> å¯ä»¥åœ¨å…¶åŠ è½½æ—¶æ˜¾ç¤ºä¸€ä¸ªæ­£åœ¨åŠ è½½çš„æç¤ºã€‚</suspense></li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { lazy } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'react'</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> MarkdownPreview</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> lazy</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'./MarkdownPreview.js'</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#6A737D">// æ­¤ä»£ç ä¾èµ–äº åŠ¨æ€ import()ï¼Œå› æ­¤å¯èƒ½éœ€è¦ä½ çš„æ‰“åŒ…å·¥å…·æˆ–æ¡†æ¶æä¾›æ”¯æŒã€‚ä½¿ç”¨è¿™ç§æ¨¡å¼è¦æ±‚å¯¼å…¥çš„æ‡’åŠ è½½ç»„ä»¶å¿…é¡»ä½œä¸º default å¯¼å‡ºã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#79B8FF">Suspense</span><span style="color:#B392F0"> fallback</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{&#x3C;</span><span style="color:#79B8FF">Loading</span><span style="color:#E1E4E8"> />}></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#85E89D">h2</span><span style="color:#E1E4E8">>Preview&#x3C;/</span><span style="color:#85E89D">h2</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#79B8FF">MarkdownPreview</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#79B8FF">Suspense</span><span style="color:#E1E4E8">></span></span></code></pre>
<h3 id="ä¸è¦åœ¨å…¶ä»–ç»„ä»¶-å†…éƒ¨-å£°æ˜-lazy-ç»„ä»¶">ä¸è¦åœ¨å…¶ä»–ç»„ä»¶ å†…éƒ¨ å£°æ˜ lazy ç»„ä»¶</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { lazy } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'react'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// âœ… Good: å°† lazy ç»„ä»¶å£°æ˜åœ¨ç»„ä»¶å¤–éƒ¨</span></span>
<span class="line"><span style="color:#6A737D">// const MarkdownPreview = lazy(() => import('./MarkdownPreview.js'));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> Editor</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#6A737D">  // ğŸ”´ Bad: è¿™å°†å¯¼è‡´åœ¨é‡æ–°æ¸²æŸ“æ—¶é‡ç½®æ‰€æœ‰çŠ¶æ€</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> MarkdownPreview</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> lazy</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#F97583"> import</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'./MarkdownPreview.js'</span><span style="color:#E1E4E8">));</span></span>
<span class="line"><span style="color:#6A737D">  // ...</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="memo">memo</h2>
<p>React é€šå¸¸åœ¨å…¶çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶é‡æ–°æ¸²æŸ“ä¸€ä¸ªç»„ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ memo åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼Œå½“å®ƒçš„çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œåªè¦å®ƒçš„æ–° props ä¸æ—§ props ç›¸åŒæ—¶ï¼ŒReact å°±ä¸ä¼šé‡æ–°æ¸²æŸ“å®ƒã€‚è¿™æ ·çš„ç»„ä»¶è¢«ç§°ä¸º è®°å¿†åŒ–çš„ï¼ˆmemoizedï¼‰ç»„ä»¶ã€‚é€šå¸¸ useMemo ä¸ useCallback ä¸€èµ·é…åˆä½¿ç”¨ã€‚</p>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#B392F0">memo</span><span style="color:#E1E4E8">(Component, arePropsEqual</span><span style="color:#F97583">?</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>å‚æ•°</p>
<ul>
<li><code>Component</code>ï¼šè¦è¿›è¡Œè®°å¿†åŒ–çš„ç»„ä»¶ã€‚memo ä¸ä¼šä¿®æ”¹è¯¥ç»„ä»¶ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„ã€è®°å¿†åŒ–çš„ç»„ä»¶ã€‚å®ƒæ¥å—ä»»ä½•æœ‰æ•ˆçš„ React ç»„ä»¶ï¼ŒåŒ…æ‹¬å‡½æ•°ç»„ä»¶å’Œ forwardRef ç»„ä»¶ã€‚</li>
<li><code>arePropsEqual</code>ï¼šä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šç»„ä»¶çš„å‰ä¸€ä¸ª props å’Œæ–°çš„ propsã€‚å¦‚æœæ—§çš„å’Œæ–°çš„ props ç›¸ç­‰ï¼Œå³ç»„ä»¶ä½¿ç”¨æ–°çš„ props æ¸²æŸ“çš„è¾“å‡ºå’Œè¡¨ç°ä¸æ—§çš„ props å®Œå…¨ç›¸åŒï¼Œåˆ™å®ƒåº”è¯¥è¿”å› trueã€‚å¦åˆ™è¿”å› falseã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦æŒ‡å®šæ­¤å‡½æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact å°†ä½¿ç”¨ <code>Object.is</code> æ¯”è¾ƒæ¯ä¸ª propã€‚</li>
</ul>
<p>è¿”å›å€¼
memo è¿”å›ä¸€ä¸ªæ–°çš„ React ç»„ä»¶ã€‚å®ƒçš„è¡Œä¸ºä¸æä¾›ç»™ memo çš„ç»„ä»¶ç›¸åŒï¼Œåªæ˜¯å½“å®ƒçš„çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ React ä¸ä¼šæ€»æ˜¯é‡æ–°æ¸²æŸ“å®ƒï¼Œé™¤éå®ƒçš„ props å‘ç”Ÿäº†å˜åŒ–ã€‚</p>
<h3 id="å½“-props-æ²¡æœ‰æ”¹å˜æ—¶è·³è¿‡é‡æ–°æ¸²æŸ“">å½“ props æ²¡æœ‰æ”¹å˜æ—¶è·³è¿‡é‡æ–°æ¸²æŸ“</h3>
<p>é€šè¿‡ä½¿ç”¨ <code>memo</code>ï¼Œåªè¦å…¶ props æ²¡æœ‰æ”¹å˜ï¼ŒReact å°±ä¸éœ€è¦é‡æ–°æ¸²æŸ“ã€‚<strong>å³ä½¿ä½¿ç”¨ memoï¼Œå¦‚æœå®ƒè‡ªå·±çš„ state æˆ–æ­£åœ¨ä½¿ç”¨çš„ context å‘ç”Ÿæ›´æ”¹ï¼Œç»„ä»¶ä¹Ÿä¼šé‡æ–°æ¸²æŸ“</strong>ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> const</span><span style="color:#79B8FF"> Greeting</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> memo</span><span style="color:#E1E4E8">(({ </span><span style="color:#FFAB70">name</span><span style="color:#E1E4E8"> }) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#85E89D">h1</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      Hello,</span></span>
<span class="line"><span style="color:#E1E4E8">      {name}</span></span>
<span class="line"><span style="color:#E1E4E8">      !</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/</span><span style="color:#85E89D">h1</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<h3 id="æœ€å°åŒ–-props-çš„å˜åŒ–">æœ€å°åŒ– props çš„å˜åŒ–</h3>
<p>useMemo é¿å…çˆ¶ç»„ä»¶æ¯æ¬¡éƒ½é‡æ–°åˆ›å»ºè¯¥å¯¹è±¡</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> Page</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">name</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setName</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Taylor'</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">age</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setAge</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">42</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> person</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> useMemo</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">    () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> ({ name, age }),</span></span>
<span class="line"><span style="color:#E1E4E8">    [name, age]</span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> &#x3C;</span><span style="color:#79B8FF">Profile</span><span style="color:#B392F0"> person</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{person} />;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> Profile</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> memo</span><span style="color:#E1E4E8">(({ </span><span style="color:#FFAB70">person</span><span style="color:#E1E4E8"> }) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">  // ...</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<p>æ¥å—å•ç‹¬çš„å€¼è€Œä¸æ˜¯æ•´ä¸ªå¯¹è±¡</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> Page</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">name</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setName</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Taylor'</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">age</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setAge</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">42</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> &#x3C;</span><span style="color:#79B8FF">Profile</span><span style="color:#B392F0"> name</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{name} </span><span style="color:#B392F0">age</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{age} />;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> Profile</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> memo</span><span style="color:#E1E4E8">(({ </span><span style="color:#FFAB70">name</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">age</span><span style="color:#E1E4E8"> }) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">  // ...</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<p>æ¥å—ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ï¼Œè€Œä¸æ˜¯å€¼æœ¬èº«</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> GroupsLanding</span><span style="color:#E1E4E8">({ </span><span style="color:#FFAB70">person</span><span style="color:#E1E4E8"> }) {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> hasGroups</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> person.groups </span><span style="color:#F97583">!==</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> &#x3C;</span><span style="color:#79B8FF">CallToAction</span><span style="color:#B392F0"> hasGroups</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{hasGroups} />;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> CallToAction</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> memo</span><span style="color:#E1E4E8">(({ </span><span style="color:#FFAB70">hasGroups</span><span style="color:#E1E4E8"> }) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">  // ...</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<h3 id="è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°">è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°</h3>
<p>ä½ å¯ä»¥æä¾›ä¸€ä¸ªè‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°ï¼ŒReact å°†ä½¿ç”¨å®ƒæ¥æ¯”è¾ƒæ—§çš„å’Œæ–°çš„ propsï¼Œè€Œä¸æ˜¯ä½¿ç”¨æµ…æ¯”è¾ƒã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> Chart</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> memo</span><span style="color:#E1E4E8">(({ </span><span style="color:#FFAB70">dataPoints</span><span style="color:#E1E4E8"> }) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">  // ...</span></span>
<span class="line"><span style="color:#E1E4E8">}, arePropsEqual);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> arePropsEqual</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">oldProps</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">newProps</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6A737D">  // åœ¨æ–°çš„ props ä¸æ—§çš„ props å…·æœ‰ç›¸åŒçš„è¾“å‡ºæ—¶è¿”å› trueï¼›å¦åˆ™åº”è¯¥è¿”å› false</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> Object.</span><span style="color:#B392F0">is</span><span style="color:#E1E4E8">(oldProps, newProps);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="starttransition">startTransition</h2>
<p>startTransition å¯ä»¥è®©ä½ åœ¨ä¸é˜»å¡ UI çš„æƒ…å†µä¸‹æ›´æ–° stateï¼Œ startTransition ä¸ useTransition éå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒä¸æä¾› isPending æ ‡å¿—æ¥è·Ÿè¸ªä¸€ä¸ª transition æ˜¯å¦æ­£åœ¨è¿›è¡Œã€‚ä½ å¯ä»¥åœ¨ useTransition ä¸å¯ç”¨æ—¶è°ƒç”¨ startTransitionã€‚ä¾‹å¦‚ï¼Œåœ¨ç»„ä»¶å¤–éƒ¨ï¼ˆå¦‚ä»æ•°æ®åº“ä¸­ï¼‰ä½¿ç”¨ startTransition</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#B392F0">startTransition</span><span style="color:#E1E4E8">(scope);</span></span></code></pre>
<p>å‚æ•°</p>
<ul>
<li><code>scope</code>ï¼šè°ƒç”¨ä¸€ä¸ªæˆ–å¤šä¸ª set å‡½æ•° æ¥æ›´æ–° state çš„å‡½æ•°ã€‚React ä¼šç«‹å³è°ƒç”¨æ²¡æœ‰å‚æ•°çš„ scopeï¼Œå¹¶å°†åœ¨ scope å‡½æ•°è°ƒç”¨æœŸé—´ï¼Œè°ƒåº¦æ‰€æœ‰çš„ stateï¼Œå¹¶å°†åŒæ­¥æ›´æ–°æ ‡è®°ä¸º transitionã€‚</li>
</ul>
<p>è¿”å›å€¼</p>
<ul>
<li>æ— </li>
</ul>
<p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>startTransition æ²¡æœ‰æä¾›ä¸€ç§è·Ÿè¸ª transition æ˜¯å¦å¤„äºå¾…å®šçŠ¶æ€çš„æ–¹æ³•ã€‚ä¸ºäº†åœ¨ transition è¿›è¡Œæ—¶æ˜¾ç¤ºä¸€ä¸ªå¾…å®šçŠ¶æ€çš„æŒ‡ç¤ºå™¨ï¼Œä½ éœ€è¦ä½¿ç”¨ useTransition</li>
<li>ä¼ é€’ç»™ startTransition çš„å‡½æ•°å¿…é¡»æ˜¯åŒæ­¥çš„ã€‚React ä¼šç«‹å³æ‰§è¡Œæ­¤å‡½æ•°ï¼Œå°†å…¶æ‰§è¡ŒæœŸé—´å‘ç”Ÿçš„æ‰€æœ‰ state æ›´æ–°æ ‡è®°ä¸º transitionã€‚</li>
<li>ä¸€ä¸ªè¢«æ ‡è®°ä¸º transition çš„ state æ›´æ–°æ—¶å°†ä¼šè¢«å…¶ä»– state æ›´æ–°æ‰“æ–­ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ transition å†…éƒ¨æ›´æ–°å›¾è¡¨ç»„ä»¶ï¼Œä½†åœ¨å›¾è¡¨é‡æ–°æ¸²æŸ“æ—¶åœ¨è¾“å…¥æ¡†ä¸­æ‰“å­—ï¼Œåˆ™ React å°†å…ˆå¤„ç†è¾“å…¥ state æ›´æ–°ï¼Œä¹‹åæ‰ä¼šé‡æ–°å¯åŠ¨å¯¹å›¾è¡¨ç»„ä»¶çš„æ¸²æŸ“å·¥ä½œã€‚</li>
<li>å¦‚æœæœ‰å¤šä¸ªæ­£åœ¨è¿›è¡Œçš„ transitionï¼Œå½“å‰ React ä¼šå°†å®ƒä»¬é›†ä¸­åœ¨ä¸€èµ·å¤„ç†ã€‚è¿™æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Œåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šè¢«ç§»é™¤ã€‚</li>
</ul>
<h3 id="å°†-state-æ›´æ–°æ ‡è®°ä¸ºéé˜»å¡-transition">å°† state æ›´æ–°æ ‡è®°ä¸ºéé˜»å¡ transition</h3>
<p>transition å¯ä»¥è®©ç”¨æˆ·ç•Œé¢åœ¨æ…¢é€Ÿè®¾å¤‡ä¸Šä¿æŒæ›´æ–°å“åº”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·å•å‡»ä¸€ä¸ªé€‰é¡¹å¡ååˆæ”¹å˜ä¸»æ„å¹¶å•å‡»å¦ä¸€ä¸ªé€‰é¡¹å¡ï¼Œåˆ™å¯ä»¥åœ¨ç¬¬ä¸€æ¬¡é‡æ–°æ¸²æŸ“å®Œæˆä¹‹å‰æ‰§è¡Œæ­¤æ“ä½œè€Œæ— éœ€ç­‰å¾…ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { startTransition } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'react'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> TabContainer</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">tab</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setTab</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'about'</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">  function</span><span style="color:#B392F0"> selectTab</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">nextTab</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#B392F0">    startTransition</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">      setTab</span><span style="color:#E1E4E8">(nextTab);</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#6A737D">  // ...</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h1 id="ç»„ä»¶">ç»„ä»¶</h1>
<p>React æä¾›äº†ä¸€äº›å†…ç½®çš„ç»„ä»¶ï¼Œä½ å¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨å®ƒä»¬</p>
<h2 id="fragment">Fragment</h2>
<p>é€šå¸¸ä½¿ç”¨ &#x3C;>â€¦&#x3C;/> ä»£æ›¿ï¼Œå®ƒä»¬éƒ½å…è®¸ä½ åœ¨ä¸æ·»åŠ é¢å¤–èŠ‚ç‚¹çš„æƒ…å†µä¸‹å°†å­å…ƒç´ ç»„åˆã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#E1E4E8">&#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#79B8FF">OneChild</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#79B8FF">AnotherChild</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/>;</span></span></code></pre>
<h2 id="profiler">Profiler</h2>
<p>å…è®¸ä½ ç¼–ç¨‹å¼æµ‹é‡ React æ ‘çš„æ¸²æŸ“æ€§èƒ½</p>
<p>å‚æ•°</p>
<ul>
<li>idï¼šå­—ç¬¦ä¸²ï¼Œç”¨äºæ ‡è¯†æ­£åœ¨æµ‹é‡çš„ UI éƒ¨åˆ†ã€‚</li>
<li>onRenderï¼šonRender å›è°ƒå‡½æ•°ï¼Œå½“åŒ…è£¹çš„ç»„ä»¶æ ‘æ›´æ–°æ—¶ï¼ŒReact éƒ½ä¼šè°ƒç”¨å®ƒã€‚å®ƒæ¥æ”¶æœ‰å…³æ¸²æŸ“å†…å®¹å’Œæ‰€èŠ±è´¹æ—¶é—´çš„ä¿¡æ¯ã€‚</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#79B8FF">Profiler</span><span style="color:#B392F0"> id</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"App"</span><span style="color:#B392F0"> onRender</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{onRender}></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#79B8FF">App</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#79B8FF">Profiler</span><span style="color:#E1E4E8">>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">function</span><span style="color:#B392F0"> onRender</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">id</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">phase</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">actualDuration</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">baseDuration</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">startTime</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">commitTime</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6A737D">  // å¯¹æ¸²æŸ“æ—¶é—´è¿›è¡Œæ±‡æ€»æˆ–è®°å½•...</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="strictmode">StrictMode</h2>
<p>å¸®åŠ©ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­å°½æ—©åœ°å‘ç°ç»„ä»¶ä¸­çš„å¸¸è§é”™è¯¯</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { StrictMode } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'react'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { createRoot } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'react-dom/client'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> root</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> createRoot</span><span style="color:#E1E4E8">(document.</span><span style="color:#B392F0">getElementById</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'root'</span><span style="color:#E1E4E8">));</span></span>
<span class="line"><span style="color:#E1E4E8">root.</span><span style="color:#B392F0">render</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#79B8FF">StrictMode</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#79B8FF">App</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;/</span><span style="color:#79B8FF">StrictMode</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">);</span></span></code></pre>
<p>ä¸¥æ ¼æ¨¡å¼å¯ç”¨äº†ä»¥ä¸‹ä»…åœ¨å¼€å‘ç¯å¢ƒä¸‹æœ‰æ•ˆçš„è¡Œä¸ºï¼š</p>
<ul>
<li>ç»„ä»¶å°† é‡æ–°æ¸²æŸ“ä¸€æ¬¡ï¼Œä»¥æŸ¥æ‰¾ç”±äºéçº¯æ¸²æŸ“è€Œå¼•èµ·çš„é”™è¯¯ã€‚</li>
<li>ç»„ä»¶å°† é‡æ–°è¿è¡Œ Effect ä¸€æ¬¡ï¼Œä»¥æŸ¥æ‰¾ç”±äºç¼ºå°‘ Effect æ¸…ç†è€Œå¼•èµ·çš„é”™è¯¯ã€‚</li>
<li>ç»„ä»¶å°†è¢« æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†å·²å¼ƒç”¨çš„ APIã€‚</li>
</ul>
<h3 id="suspense">Suspense</h3>
<p>å…è®¸åœ¨å­ç»„ä»¶å®ŒæˆåŠ è½½å‰å±•ç¤ºåå¤‡æ–¹æ¡ˆ</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#79B8FF">Suspense</span><span style="color:#B392F0"> fallback</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{&#x3C;</span><span style="color:#79B8FF">Loading</span><span style="color:#E1E4E8"> />}></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#79B8FF">SomeComponent</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#79B8FF">Suspense</span><span style="color:#E1E4E8">>;</span></span></code></pre>
<p>å‚æ•°</p>
<ul>
<li><code>children</code>ï¼šçœŸæ­£çš„ UI æ¸²æŸ“å†…å®¹ã€‚å¦‚æœ children åœ¨æ¸²æŸ“ä¸­è¢«æŒ‚èµ·ï¼ŒSuspense è¾¹ç•Œå°†ä¼šæ¸²æŸ“ fallbackã€‚</li>
<li><code>fallback</code>ï¼šçœŸæ­£çš„ UI æœªæ¸²æŸ“å®Œæˆæ—¶ä»£æ›¿å…¶æ¸²æŸ“çš„å¤‡ç”¨ UIï¼Œå®ƒå¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ React èŠ‚ç‚¹ã€‚åå¤‡æ–¹æ¡ˆé€šå¸¸æ˜¯ä¸€ä¸ªè½»é‡çš„å ä½ç¬¦ï¼Œä¾‹å¦‚è¡¨ç¤ºåŠ è½½ä¸­çš„å›¾æ ‡æˆ–è€…éª¨æ¶å±ã€‚å½“ children è¢«æŒ‚èµ·æ—¶ï¼ŒSuspense å°†è‡ªåŠ¨åˆ‡æ¢è‡³æ¸²æŸ“ fallbackï¼›å½“æ•°æ®å‡†å¤‡å¥½æ—¶ï¼Œåˆä¼šè‡ªåŠ¨åˆ‡æ¢è‡³æ¸²æŸ“ childrenã€‚å¦‚æœ fallback åœ¨æ¸²æŸ“ä¸­è¢«æŒ‚èµ·ï¼Œé‚£ä¹ˆå°†è‡ªåŠ¨æ¿€æ´»æœ€è¿‘çš„ Suspense è¾¹ç•Œã€‚</li>
</ul>
<p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>å¦‚æœ Suspense æ­£åœ¨å±•ç¤º React ç»„ä»¶æ ‘ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆå½“å†æ¬¡è¢«æŒ‚èµ·æ—¶ï¼Œé™¤éå¯¼è‡´æ­¤å¤„æ›´æ–°æ˜¯ç”± startTransition æˆ– useDeferredValue å¼•èµ·ï¼Œå¦åˆ™ Suspense å°†å±•ç¤º fallback</li>
<li>åªæœ‰å¯ç”¨äº† Suspense çš„æ•°æ®æºæ‰ä¼šæ¿€æ´» Suspense ç»„ä»¶ï¼Œ 1.æ”¯æŒ Suspense çš„æ¡†æ¶å¦‚ Relay å’Œ Next.jsï¼Œ 2.ä½¿ç”¨ lazy æ‡’åŠ è½½ç»„ä»¶ä»£ç ï¼Œ3.ä½¿ç”¨ use è¯»å– Promise çš„å€¼ã€‚ï¼ˆSuspense æ— æ³• æ£€æµ‹åœ¨ Effect æˆ–äº‹ä»¶å¤„ç†ç¨‹åºä¸­è·å–æ•°æ®çš„æƒ…å†µï¼‰</li>
</ul>
<h3 id="é€æ­¥åŠ è½½å†…å®¹">é€æ­¥åŠ è½½å†…å®¹</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#6A737D">// è°ƒæ•´ä¹‹åï¼ŒBiography ä¸éœ€è¦â€œç­‰å¾…â€ Albums åŠ è½½å®Œæˆå°±å¯ä»¥å±•ç¤ºã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;</span><span style="color:#79B8FF">Suspense</span><span style="color:#B392F0"> fallback</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{&#x3C;</span><span style="color:#79B8FF">BigSpinner</span><span style="color:#E1E4E8"> />}></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#79B8FF">Biography</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;</span><span style="color:#79B8FF">Suspense</span><span style="color:#B392F0"> fallback</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{&#x3C;</span><span style="color:#79B8FF">AlbumsGlimmer</span><span style="color:#E1E4E8"> />}></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;</span><span style="color:#79B8FF">Panel</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#79B8FF">Albums</span><span style="color:#E1E4E8"> /></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/</span><span style="color:#79B8FF">Panel</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">  &#x3C;/</span><span style="color:#79B8FF">Suspense</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">&#x3C;/</span><span style="color:#79B8FF">Suspense</span><span style="color:#E1E4E8">>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 1.å¦‚æœ Biography æ²¡æœ‰åŠ è½½å®Œæˆï¼ŒBigSpinner ä¼šæ˜¾ç¤ºåœ¨æ•´ä¸ªå†…å®¹åŒºåŸŸçš„ä½ç½®ã€‚</span></span>
<span class="line"><span style="color:#6A737D">// 2.ä¸€æ—¦ Biography åŠ è½½å®Œæˆï¼ŒBigSpinner ä¼šè¢«å†…å®¹æ›¿æ¢ã€‚</span></span>
<span class="line"><span style="color:#6A737D">// 3.å¦‚æœ Albums æ²¡æœ‰åŠ è½½å®Œæˆï¼ŒAlbumsGlimmer ä¼šæ˜¾ç¤ºåœ¨ Albums å’Œå®ƒçš„çˆ¶çº§ Panel çš„ä½ç½®ã€‚</span></span>
<span class="line"><span style="color:#6A737D">// 4.æœ€åï¼Œä¸€æ—¦ Albums åŠ è½½å®Œæˆï¼Œå®ƒä¼šæ›¿æ¢ AlbumsGlimmerã€‚</span></span></code></pre>
<h3 id="åœ¨æ–°å†…å®¹åŠ è½½æ—¶å±•ç¤ºè¿‡æ—¶å†…å®¹">åœ¨æ–°å†…å®¹åŠ è½½æ—¶å±•ç¤ºè¿‡æ—¶å†…å®¹</h3>
<p>å»¶è¿Ÿå€¼å’Œ transition éƒ½å¯ä»¥è®©ä½ é¿å…æ˜¾ç¤º Suspense åå¤‡æ–¹æ¡ˆï¼Œè€Œæ˜¯ä½¿ç”¨å†…è”æŒ‡ç¤ºå™¨ã€‚transition å°†æ•´ä¸ªæ›´æ–°æ ‡è®°ä¸ºéç´§æ€¥çš„ï¼Œå› æ­¤å®ƒä»¬é€šå¸¸ç”±æ¡†æ¶å’Œè·¯ç”±åº“ç”¨äºå¯¼èˆªã€‚å¦ä¸€æ–¹é¢ï¼Œå»¶è¿Ÿå€¼åœ¨ä½ å¸Œæœ›å°† UI çš„ä¸€éƒ¨åˆ†æ ‡è®°ä¸ºéç´§æ€¥ï¼Œå¹¶è®©å®ƒâ€œè½åäºâ€ UI çš„å…¶ä½™éƒ¨åˆ†æ—¶éå¸¸æœ‰ç”¨</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="jsx"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { Suspense, useDeferredValue, useState } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> 'react'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> SearchResults </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> './SearchResults.js'</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> default</span><span style="color:#F97583"> function</span><span style="color:#B392F0"> App</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">query</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setQuery</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> deferredQuery</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> useDeferredValue</span><span style="color:#E1E4E8">(query);</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> isStale</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> query </span><span style="color:#F97583">!==</span><span style="color:#E1E4E8"> deferredQuery;</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> (</span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#85E89D">label</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">        Search albums:</span></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;</span><span style="color:#85E89D">input</span><span style="color:#B392F0"> value</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{query} </span><span style="color:#B392F0">onChange</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span><span style="color:#FFAB70">e</span><span style="color:#F97583"> =></span><span style="color:#B392F0"> setQuery</span><span style="color:#E1E4E8">(e.target.value)} /></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;/</span><span style="color:#85E89D">label</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;</span><span style="color:#79B8FF">Suspense</span><span style="color:#B392F0"> fallback</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{&#x3C;</span><span style="color:#85E89D">h2</span><span style="color:#E1E4E8">>Loading...&#x3C;/</span><span style="color:#85E89D">h2</span><span style="color:#E1E4E8">>}></span></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;</span><span style="color:#85E89D">div</span><span style="color:#B392F0"> style</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{{ opacity: isStale </span><span style="color:#F97583">?</span><span style="color:#79B8FF"> 0.5</span><span style="color:#F97583"> :</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8"> }}></span></span>
<span class="line"><span style="color:#E1E4E8">          &#x3C;</span><span style="color:#79B8FF">SearchResults</span><span style="color:#B392F0"> query</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{deferredQuery} /></span></span>
<span class="line"><span style="color:#E1E4E8">        &#x3C;/</span><span style="color:#85E89D">div</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">      &#x3C;/</span><span style="color:#79B8FF">Suspense</span><span style="color:#E1E4E8">></span></span>
<span class="line"><span style="color:#E1E4E8">    &#x3C;/></span></span>
<span class="line"><span style="color:#E1E4E8">  );</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre> </div> <a class="flex gap-1 my-4 text-blue-600 cursor-pointer select-none" href="https://github.com/ckvv/ckvv.github.io/tree/main/content/react/react-api&compoent.md"> <svg viewBox="0 0 24 24" role="img" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4">
  <path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
  <path d="M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z" />
</svg>
Edit this page on GitHub
</a> <div id="cusdis_thread" class="mt-12" data-host="https://cusdis.com" data-app-id="c2b015f9-9a4b-4997-b66f-f9c6ca26ebdd" data-page-id="/blog/react/react-apicompoent/" data-page-url="content/react/react-api&#38;compoent.md" data-page-title="React API &#38; ç»„ä»¶" data-iframe="/js/cusdis/iframe.umd.js" data-style="/js/cusdis/style.css"></div> <script>
window.CUSDIS_LOCALE = {
  powered_by: '',
  post_comment: 'å‘é€',
  loading: 'åŠ è½½ä¸­...',
  // comment
  email: 'é‚®ç®±(å¯é€‰)',
  nickname: 'æ˜µç§°',
  reply_placeholder: 'å†…å®¹',
  reply_btn: 'å›å¤',
  sending: 'å‘é€ä¸­...',
  // reply
  mod_badge: 'ç®¡ç†å‘˜',
  content_is_required: 'å†…å®¹ä¸èƒ½ä¸ºç©º',
  nickname_is_required: 'æ˜µç§°ä¸èƒ½ä¸ºç©º',
  comment_has_been_sent: 'è¯„è®ºå·²å‘é€, ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡åä¼šå±•ç¤º',
};
</script> <script async src="/js/cusdis/cusdis.min.js"></script>  </main> </body></html>