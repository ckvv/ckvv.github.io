<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=theme-color content="#ffffff"><meta name=color-scheme content="light dark"><meta name=description content="API react åŒ…è¿˜å¯¼å‡ºäº†ä¸€äº›å…¶ä»–çš„ APIï¼Œè¿™äº› API å¯¹äºåˆ›å»ºç»„ä»¶éå¸¸æœ‰ç”¨
createContext å¯ä»¥åˆ›å»ºä¸€ä¸ª contextï¼Œä½ å¯ä»¥å°†å…¶æä¾›ç»™å­ç»„ä»¶ï¼Œé€šå¸¸ä¼šä¸ useContext ä¸€èµ·é…åˆä½¿ç”¨ã€‚
forwardRef å…è®¸ç»„ä»¶å°† DOM èŠ‚ç‚¹ä½œä¸º ref æš´éœ²ç»™çˆ¶ç»„ä»¶ã€‚
lazy å…è®¸ä½ å»¶è¿ŸåŠ è½½ç»„ä»¶ï¼Œç›´åˆ°è¯¥ç»„ä»¶éœ€è¦ç¬¬ä¸€æ¬¡è¢«æ¸²æŸ“ã€‚
lazy(load) å‚æ•°
load: ä¸€ä¸ªè¿”å› Promise æˆ–å¦ä¸€ä¸ª thenableï¼ˆå…·æœ‰ then æ–¹æ³•çš„ç±» Promise å¯¹è±¡ï¼‰çš„å‡½æ•°ã€‚React ä¸ä¼šåœ¨ä½ å°è¯•é¦–æ¬¡æ¸²æŸ“è¿”å›çš„ç»„ä»¶ä¹‹å‰è°ƒç”¨ load å‡½æ•°ã€‚åœ¨ React é¦–æ¬¡è°ƒç”¨ load åï¼Œå®ƒå°†ç­‰å¾…å…¶è§£æï¼Œç„¶åå°†è§£æå€¼çš„ .default æ¸²æŸ“ä¸º React ç»„ä»¶ã€‚è¿”å›çš„ Promise å’Œ Promise çš„è§£æå€¼éƒ½å°†è¢«ç¼“å­˜ï¼Œå› æ­¤ React ä¸ä¼šå¤šæ¬¡è°ƒç”¨ load å‡½æ•°ã€‚å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™ React å°†æŠ›å‡ºæ‹’ç»åŸå› ç»™æœ€è¿‘çš„é”™è¯¯è¾¹ç•Œå¤„ç†ã€‚ è¿”å›å€¼
lazy è¿”å›ä¸€ä¸ª React ç»„ä»¶ï¼Œä½ å¯ä»¥åœ¨ fiber æ ‘ä¸­æ¸²æŸ“ã€‚å½“æ‡’åŠ è½½ç»„ä»¶çš„ä»£ç ä»åœ¨åŠ è½½æ—¶ï¼Œå°è¯•æ¸²æŸ“å®ƒå°†ä¼šå¤„äº æš‚åœ çŠ¶æ€ã€‚ä½¿ç”¨ å¯ä»¥åœ¨å…¶åŠ è½½æ—¶æ˜¾ç¤ºä¸€ä¸ªæ­£åœ¨åŠ è½½çš„æç¤ºã€‚ import { lazy } from 'react'; const MarkdownPreview = lazy(() => import('."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="React API & ç»„ä»¶"><meta name=twitter:description content="API react åŒ…è¿˜å¯¼å‡ºäº†ä¸€äº›å…¶ä»–çš„ APIï¼Œè¿™äº› API å¯¹äºåˆ›å»ºç»„ä»¶éå¸¸æœ‰ç”¨
createContext å¯ä»¥åˆ›å»ºä¸€ä¸ª contextï¼Œä½ å¯ä»¥å°†å…¶æä¾›ç»™å­ç»„ä»¶ï¼Œé€šå¸¸ä¼šä¸ useContext ä¸€èµ·é…åˆä½¿ç”¨ã€‚
forwardRef å…è®¸ç»„ä»¶å°† DOM èŠ‚ç‚¹ä½œä¸º ref æš´éœ²ç»™çˆ¶ç»„ä»¶ã€‚
lazy å…è®¸ä½ å»¶è¿ŸåŠ è½½ç»„ä»¶ï¼Œç›´åˆ°è¯¥ç»„ä»¶éœ€è¦ç¬¬ä¸€æ¬¡è¢«æ¸²æŸ“ã€‚
lazy(load) å‚æ•°
load: ä¸€ä¸ªè¿”å› Promise æˆ–å¦ä¸€ä¸ª thenableï¼ˆå…·æœ‰ then æ–¹æ³•çš„ç±» Promise å¯¹è±¡ï¼‰çš„å‡½æ•°ã€‚React ä¸ä¼šåœ¨ä½ å°è¯•é¦–æ¬¡æ¸²æŸ“è¿”å›çš„ç»„ä»¶ä¹‹å‰è°ƒç”¨ load å‡½æ•°ã€‚åœ¨ React é¦–æ¬¡è°ƒç”¨ load åï¼Œå®ƒå°†ç­‰å¾…å…¶è§£æï¼Œç„¶åå°†è§£æå€¼çš„ .default æ¸²æŸ“ä¸º React ç»„ä»¶ã€‚è¿”å›çš„ Promise å’Œ Promise çš„è§£æå€¼éƒ½å°†è¢«ç¼“å­˜ï¼Œå› æ­¤ React ä¸ä¼šå¤šæ¬¡è°ƒç”¨ load å‡½æ•°ã€‚å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™ React å°†æŠ›å‡ºæ‹’ç»åŸå› ç»™æœ€è¿‘çš„é”™è¯¯è¾¹ç•Œå¤„ç†ã€‚ è¿”å›å€¼
lazy è¿”å›ä¸€ä¸ª React ç»„ä»¶ï¼Œä½ å¯ä»¥åœ¨ fiber æ ‘ä¸­æ¸²æŸ“ã€‚å½“æ‡’åŠ è½½ç»„ä»¶çš„ä»£ç ä»åœ¨åŠ è½½æ—¶ï¼Œå°è¯•æ¸²æŸ“å®ƒå°†ä¼šå¤„äº æš‚åœ çŠ¶æ€ã€‚ä½¿ç”¨ å¯ä»¥åœ¨å…¶åŠ è½½æ—¶æ˜¾ç¤ºä¸€ä¸ªæ­£åœ¨åŠ è½½çš„æç¤ºã€‚ import { lazy } from 'react'; const MarkdownPreview = lazy(() => import('."><meta property="og:title" content="React API & ç»„ä»¶"><meta property="og:description" content="API react åŒ…è¿˜å¯¼å‡ºäº†ä¸€äº›å…¶ä»–çš„ APIï¼Œè¿™äº› API å¯¹äºåˆ›å»ºç»„ä»¶éå¸¸æœ‰ç”¨
createContext å¯ä»¥åˆ›å»ºä¸€ä¸ª contextï¼Œä½ å¯ä»¥å°†å…¶æä¾›ç»™å­ç»„ä»¶ï¼Œé€šå¸¸ä¼šä¸ useContext ä¸€èµ·é…åˆä½¿ç”¨ã€‚
forwardRef å…è®¸ç»„ä»¶å°† DOM èŠ‚ç‚¹ä½œä¸º ref æš´éœ²ç»™çˆ¶ç»„ä»¶ã€‚
lazy å…è®¸ä½ å»¶è¿ŸåŠ è½½ç»„ä»¶ï¼Œç›´åˆ°è¯¥ç»„ä»¶éœ€è¦ç¬¬ä¸€æ¬¡è¢«æ¸²æŸ“ã€‚
lazy(load) å‚æ•°
load: ä¸€ä¸ªè¿”å› Promise æˆ–å¦ä¸€ä¸ª thenableï¼ˆå…·æœ‰ then æ–¹æ³•çš„ç±» Promise å¯¹è±¡ï¼‰çš„å‡½æ•°ã€‚React ä¸ä¼šåœ¨ä½ å°è¯•é¦–æ¬¡æ¸²æŸ“è¿”å›çš„ç»„ä»¶ä¹‹å‰è°ƒç”¨ load å‡½æ•°ã€‚åœ¨ React é¦–æ¬¡è°ƒç”¨ load åï¼Œå®ƒå°†ç­‰å¾…å…¶è§£æï¼Œç„¶åå°†è§£æå€¼çš„ .default æ¸²æŸ“ä¸º React ç»„ä»¶ã€‚è¿”å›çš„ Promise å’Œ Promise çš„è§£æå€¼éƒ½å°†è¢«ç¼“å­˜ï¼Œå› æ­¤ React ä¸ä¼šå¤šæ¬¡è°ƒç”¨ load å‡½æ•°ã€‚å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™ React å°†æŠ›å‡ºæ‹’ç»åŸå› ç»™æœ€è¿‘çš„é”™è¯¯è¾¹ç•Œå¤„ç†ã€‚ è¿”å›å€¼
lazy è¿”å›ä¸€ä¸ª React ç»„ä»¶ï¼Œä½ å¯ä»¥åœ¨ fiber æ ‘ä¸­æ¸²æŸ“ã€‚å½“æ‡’åŠ è½½ç»„ä»¶çš„ä»£ç ä»åœ¨åŠ è½½æ—¶ï¼Œå°è¯•æ¸²æŸ“å®ƒå°†ä¼šå¤„äº æš‚åœ çŠ¶æ€ã€‚ä½¿ç”¨ å¯ä»¥åœ¨å…¶åŠ è½½æ—¶æ˜¾ç¤ºä¸€ä¸ªæ­£åœ¨åŠ è½½çš„æç¤ºã€‚ import { lazy } from 'react'; const MarkdownPreview = lazy(() => import('."><meta property="og:type" content="article"><meta property="og:url" content="https://chenkai.life/react/react-apicompoent/"><meta property="article:section" content="react"><meta property="article:published_time" content="2024-08-25T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-19T20:55:17+08:00"><title>React API & ç»„ä»¶ Â· CK's Blog</title><link rel=canonical href=https://chenkai.life/react/react-apicompoent/><link rel=stylesheet href=/css/coder.min.0e0f0ac9929898ae6625ca3789e3f9e2e630ead0a5e0f1fe96c1ba7d8774342c.css integrity="sha256-Dg8KyZKYmK5mJco3ieP54uYw6tCl4PH+lsG6fYd0NCw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.d8f89ef09509afb63b9b2595ee174e53cc51ce02a6f6a2179e1621f9389e4340.css integrity="sha256-2Pie8JUJr7Y7myWV7hdOU8xRzgKm9qIXnhYh+TieQ0A=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/custom.min.d12542c00c198b6a07ca9ea5981102805aecab0f5dfd5e3273d8c179088712c4.css integrity="sha256-0SVCwAwZi2oHyp6lmBECgFrsqw9d/V4yc9jBeQiHEsQ=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/favicon.ico><link rel=apple-touch-icon type=image/png sizes=256x256 href=/images/favicon-512x512.png><meta name=generator content="Hugo 0.119.0"><link rel=manifest href=/manifest.webmanifest></head><body class="preload-transitions colorscheme-auto"><div class=float-container><span id=dark-mode-toggle class=colorscheme-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-anheimoshi"/></svg></span></div><details id=table-of-contents-wapper><summary><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></summary></details><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>CK's Blog</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/>Home</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/marks/>Marks</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/ckvv/ckvv.github.io/tree/main/content>Create</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item id=search-content><input class=search-int type=text placeholder=Search>
<button class=search-btn data-type=github>GitHub</button>
<button class=search-btn data-type=google>Google</button></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=https://chenkai.life/react/react-apicompoent/>React API & ç»„ä»¶</a></h1><div class=edit-link style=float:right;color:#0366d6><a class=title rel=noopener target=_blank href=https://github.com/ckvv/ckvv.github.io/edit/main/content/react/react-api&amp;compoent.md>ç¼–è¾‘</a></div></header><div class=post-meta><div class=date><span class=posted-on><svg class="icon" aria-hidden="true"><use xlink:href="#icon-date"/></svg><time datetime=2024-08-25T00:00:00Z>2024-08-25</time></span></div><div class=tags><svg class="icon" aria-hidden="true"><use xlink:href="#icon-biaoqian"/></svg><span class=tag><a href=/tags/react/>React</a></span></div></div><h1 id=api>API
<a class=heading-link href=#api><i class="fa fa-link" aria-hidden=true></i></a></h1><p>react åŒ…è¿˜å¯¼å‡ºäº†ä¸€äº›å…¶ä»–çš„ APIï¼Œè¿™äº› API å¯¹äºåˆ›å»ºç»„ä»¶éå¸¸æœ‰ç”¨</p><h2 id=createcontext>createContext
<a class=heading-link href=#createcontext><i class="fa fa-link" aria-hidden=true></i></a></h2><p>å¯ä»¥åˆ›å»ºä¸€ä¸ª contextï¼Œä½ å¯ä»¥å°†å…¶æä¾›ç»™å­ç»„ä»¶ï¼Œé€šå¸¸ä¼šä¸ useContext ä¸€èµ·é…åˆä½¿ç”¨ã€‚</p><h2 id=forwardref>forwardRef
<a class=heading-link href=#forwardref><i class="fa fa-link" aria-hidden=true></i></a></h2><p>å…è®¸ç»„ä»¶å°† DOM èŠ‚ç‚¹ä½œä¸º ref æš´éœ²ç»™çˆ¶ç»„ä»¶ã€‚</p><h2 id=lazy>lazy
<a class=heading-link href=#lazy><i class="fa fa-link" aria-hidden=true></i></a></h2><p>å…è®¸ä½ å»¶è¿ŸåŠ è½½ç»„ä»¶ï¼Œç›´åˆ°è¯¥ç»„ä»¶éœ€è¦ç¬¬ä¸€æ¬¡è¢«æ¸²æŸ“ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>lazy</span>(<span style=color:#a6e22e>load</span>)
</span></span></code></pre></div><p>å‚æ•°</p><ul><li><code>load</code>: ä¸€ä¸ªè¿”å› Promise æˆ–å¦ä¸€ä¸ª thenableï¼ˆå…·æœ‰ then æ–¹æ³•çš„ç±» Promise å¯¹è±¡ï¼‰çš„å‡½æ•°ã€‚React ä¸ä¼šåœ¨ä½ å°è¯•é¦–æ¬¡æ¸²æŸ“è¿”å›çš„ç»„ä»¶ä¹‹å‰è°ƒç”¨ load å‡½æ•°ã€‚åœ¨ React é¦–æ¬¡è°ƒç”¨ load åï¼Œå®ƒå°†ç­‰å¾…å…¶è§£æï¼Œç„¶åå°†è§£æå€¼çš„ .default æ¸²æŸ“ä¸º React ç»„ä»¶ã€‚è¿”å›çš„ Promise å’Œ Promise çš„è§£æå€¼éƒ½å°†è¢«ç¼“å­˜ï¼Œå› æ­¤ React ä¸ä¼šå¤šæ¬¡è°ƒç”¨ load å‡½æ•°ã€‚å¦‚æœ Promise è¢«æ‹’ç»ï¼Œåˆ™ React å°†æŠ›å‡ºæ‹’ç»åŸå› ç»™æœ€è¿‘çš„é”™è¯¯è¾¹ç•Œå¤„ç†ã€‚</li></ul><p>è¿”å›å€¼</p><ul><li>lazy è¿”å›ä¸€ä¸ª React ç»„ä»¶ï¼Œä½ å¯ä»¥åœ¨ fiber æ ‘ä¸­æ¸²æŸ“ã€‚å½“æ‡’åŠ è½½ç»„ä»¶çš„ä»£ç ä»åœ¨åŠ è½½æ—¶ï¼Œå°è¯•æ¸²æŸ“å®ƒå°†ä¼šå¤„äº æš‚åœ çŠ¶æ€ã€‚ä½¿ç”¨ <suspense>å¯ä»¥åœ¨å…¶åŠ è½½æ—¶æ˜¾ç¤ºä¸€ä¸ªæ­£åœ¨åŠ è½½çš„æç¤ºã€‚</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>lazy</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>MarkdownPreview</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lazy</span>(() =&gt; <span style=color:#66d9ef>import</span>(<span style=color:#e6db74>&#39;./MarkdownPreview.js&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#75715e>// æ­¤ä»£ç ä¾èµ–äº åŠ¨æ€ import()ï¼Œå› æ­¤å¯èƒ½éœ€è¦ä½ çš„æ‰“åŒ…å·¥å…·æˆ–æ¡†æ¶æä¾›æ”¯æŒã€‚ä½¿ç”¨è¿™ç§æ¨¡å¼è¦æ±‚å¯¼å…¥çš„æ‡’åŠ è½½ç»„ä»¶å¿…é¡»ä½œä¸º default å¯¼å‡ºã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>Suspense</span> <span style=color:#a6e22e>fallback</span><span style=color:#f92672>=</span>{&lt;<span style=color:#f92672>Loading</span> /&gt;}&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>h2</span>&gt;<span style=color:#a6e22e>Preview</span>&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>MarkdownPreview</span> /&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>Suspense</span>&gt;
</span></span></code></pre></div><h3 id=ä¸è¦åœ¨å…¶ä»–ç»„ä»¶-å†…éƒ¨-å£°æ˜-lazy-ç»„ä»¶>ä¸è¦åœ¨å…¶ä»–ç»„ä»¶ å†…éƒ¨ å£°æ˜ lazy ç»„ä»¶
<a class=heading-link href=#%e4%b8%8d%e8%a6%81%e5%9c%a8%e5%85%b6%e4%bb%96%e7%bb%84%e4%bb%b6-%e5%86%85%e9%83%a8-%e5%a3%b0%e6%98%8e-lazy-%e7%bb%84%e4%bb%b6><i class="fa fa-link" aria-hidden=true></i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>lazy</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// âœ… Good: å°† lazy ç»„ä»¶å£°æ˜åœ¨ç»„ä»¶å¤–éƒ¨
</span></span></span><span style=display:flex><span><span style=color:#75715e>// const MarkdownPreview = lazy(() =&gt; import(&#39;./MarkdownPreview.js&#39;));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Editor</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ğŸ”´ Bad: è¿™å°†å¯¼è‡´åœ¨é‡æ–°æ¸²æŸ“æ—¶é‡ç½®æ‰€æœ‰çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>MarkdownPreview</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>lazy</span>(() =&gt; <span style=color:#66d9ef>import</span>(<span style=color:#e6db74>&#39;./MarkdownPreview.js&#39;</span>));
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h2 id=memo>memo
<a class=heading-link href=#memo><i class="fa fa-link" aria-hidden=true></i></a></h2><p>React é€šå¸¸åœ¨å…¶çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶é‡æ–°æ¸²æŸ“ä¸€ä¸ªç»„ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ memo åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼Œå½“å®ƒçš„çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œåªè¦å®ƒçš„æ–° props ä¸æ—§ props ç›¸åŒæ—¶ï¼ŒReact å°±ä¸ä¼šé‡æ–°æ¸²æŸ“å®ƒã€‚è¿™æ ·çš„ç»„ä»¶è¢«ç§°ä¸º è®°å¿†åŒ–çš„ï¼ˆmemoizedï¼‰ç»„ä»¶ã€‚é€šå¸¸ useMemo ä¸ useCallback ä¸€èµ·é…åˆä½¿ç”¨ã€‚</p><h3 id=å‚è€ƒ>å‚è€ƒ
<a class=heading-link href=#%e5%8f%82%e8%80%83><i class="fa fa-link" aria-hidden=true></i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>memo</span>(<span style=color:#a6e22e>Component</span>, <span style=color:#a6e22e>arePropsEqual</span><span style=color:#f92672>?</span>)
</span></span></code></pre></div><p>å‚æ•°</p><ul><li><code>Component</code>ï¼šè¦è¿›è¡Œè®°å¿†åŒ–çš„ç»„ä»¶ã€‚memo ä¸ä¼šä¿®æ”¹è¯¥ç»„ä»¶ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„ã€è®°å¿†åŒ–çš„ç»„ä»¶ã€‚å®ƒæ¥å—ä»»ä½•æœ‰æ•ˆçš„ React ç»„ä»¶ï¼ŒåŒ…æ‹¬å‡½æ•°ç»„ä»¶å’Œ forwardRef ç»„ä»¶ã€‚</li><li><code>arePropsEqual</code>ï¼šä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šç»„ä»¶çš„å‰ä¸€ä¸ª props å’Œæ–°çš„ propsã€‚å¦‚æœæ—§çš„å’Œæ–°çš„ props ç›¸ç­‰ï¼Œå³ç»„ä»¶ä½¿ç”¨æ–°çš„ props æ¸²æŸ“çš„è¾“å‡ºå’Œè¡¨ç°ä¸æ—§çš„ props å®Œå…¨ç›¸åŒï¼Œåˆ™å®ƒåº”è¯¥è¿”å› trueã€‚å¦åˆ™è¿”å› falseã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦æŒ‡å®šæ­¤å‡½æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact å°†ä½¿ç”¨ <code>Object.is</code> æ¯”è¾ƒæ¯ä¸ª propã€‚</li></ul><p>è¿”å›å€¼
memo è¿”å›ä¸€ä¸ªæ–°çš„ React ç»„ä»¶ã€‚å®ƒçš„è¡Œä¸ºä¸æä¾›ç»™ memo çš„ç»„ä»¶ç›¸åŒï¼Œåªæ˜¯å½“å®ƒçš„çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ React ä¸ä¼šæ€»æ˜¯é‡æ–°æ¸²æŸ“å®ƒï¼Œé™¤éå®ƒçš„ props å‘ç”Ÿäº†å˜åŒ–ã€‚</p><h3 id=å½“-props-æ²¡æœ‰æ”¹å˜æ—¶è·³è¿‡é‡æ–°æ¸²æŸ“>å½“ props æ²¡æœ‰æ”¹å˜æ—¶è·³è¿‡é‡æ–°æ¸²æŸ“
<a class=heading-link href=#%e5%bd%93-props-%e6%b2%a1%e6%9c%89%e6%94%b9%e5%8f%98%e6%97%b6%e8%b7%b3%e8%bf%87%e9%87%8d%e6%96%b0%e6%b8%b2%e6%9f%93><i class="fa fa-link" aria-hidden=true></i></a></h3><p>é€šè¿‡ä½¿ç”¨ <code>memo</code>ï¼Œåªè¦å…¶ props æ²¡æœ‰æ”¹å˜ï¼ŒReact å°±ä¸éœ€è¦é‡æ–°æ¸²æŸ“ã€‚<strong>å³ä½¿ä½¿ç”¨ memoï¼Œå¦‚æœå®ƒè‡ªå·±çš„ state æˆ–æ­£åœ¨ä½¿ç”¨çš„ context å‘ç”Ÿæ›´æ”¹ï¼Œç»„ä»¶ä¹Ÿä¼šé‡æ–°æ¸²æŸ“</strong>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Greeting</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>memo</span>(<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Greeting</span>({ <span style=color:#a6e22e>name</span> }) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>h1</span>&gt;<span style=color:#a6e22e>Hello</span>, {<span style=color:#a6e22e>name</span>}<span style=color:#f92672>!</span>&lt;/<span style=color:#f92672>h1</span>&gt;;
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=æœ€å°åŒ–-props-çš„å˜åŒ–>æœ€å°åŒ– props çš„å˜åŒ–
<a class=heading-link href=#%e6%9c%80%e5%b0%8f%e5%8c%96-props-%e7%9a%84%e5%8f%98%e5%8c%96><i class="fa fa-link" aria-hidden=true></i></a></h3><p>useMemo é¿å…çˆ¶ç»„ä»¶æ¯æ¬¡éƒ½é‡æ–°åˆ›å»ºè¯¥å¯¹è±¡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Page</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>setName</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#e6db74>&#39;Taylor&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>age</span>, <span style=color:#a6e22e>setAge</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#ae81ff>42</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>person</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useMemo</span>(
</span></span><span style=display:flex><span>    () =&gt; ({ <span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>age</span> }),
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>age</span>]
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>Profile</span> <span style=color:#a6e22e>person</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>person</span>} /&gt;;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Profile</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>memo</span>(<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Profile</span>({ <span style=color:#a6e22e>person</span> }) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>});
</span></span></code></pre></div><p>æ¥å—å•ç‹¬çš„å€¼è€Œä¸æ˜¯æ•´ä¸ªå¯¹è±¡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Page</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>setName</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#e6db74>&#39;Taylor&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>age</span>, <span style=color:#a6e22e>setAge</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#ae81ff>42</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>Profile</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>name</span>} <span style=color:#a6e22e>age</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>age</span>} /&gt;;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Profile</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>memo</span>(<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Profile</span>({ <span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>age</span> }) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>});
</span></span></code></pre></div><p>æ¥å—ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ï¼Œè€Œä¸æ˜¯å€¼æœ¬èº«</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>GroupsLanding</span>({ <span style=color:#a6e22e>person</span> }) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>hasGroups</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>person</span>.<span style=color:#a6e22e>groups</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>CallToAction</span> <span style=color:#a6e22e>hasGroups</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>hasGroups</span>} /&gt;;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>CallToAction</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>memo</span>(<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>CallToAction</span>({ <span style=color:#a6e22e>hasGroups</span> }) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>});
</span></span></code></pre></div><h3 id=è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°>è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°
<a class=heading-link href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e6%af%94%e8%be%83%e5%87%bd%e6%95%b0><i class="fa fa-link" aria-hidden=true></i></a></h3><p>ä½ å¯ä»¥æä¾›ä¸€ä¸ªè‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°ï¼ŒReact å°†ä½¿ç”¨å®ƒæ¥æ¯”è¾ƒæ—§çš„å’Œæ–°çš„ propsï¼Œè€Œä¸æ˜¯ä½¿ç”¨æµ…æ¯”è¾ƒã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Chart</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>memo</span>(<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Chart</span>({ <span style=color:#a6e22e>dataPoints</span> }) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}, <span style=color:#a6e22e>arePropsEqual</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>arePropsEqual</span>(<span style=color:#a6e22e>oldProps</span>, <span style=color:#a6e22e>newProps</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// åœ¨æ–°çš„ props ä¸æ—§çš„ props å…·æœ‰ç›¸åŒçš„è¾“å‡ºæ—¶è¿”å› trueï¼›å¦åˆ™åº”è¯¥è¿”å› false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> Object.<span style=color:#a6e22e>is</span>(<span style=color:#a6e22e>oldProps</span>, <span style=color:#a6e22e>newProps</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=starttransition>startTransition
<a class=heading-link href=#starttransition><i class="fa fa-link" aria-hidden=true></i></a></h2><p>startTransition å¯ä»¥è®©ä½ åœ¨ä¸é˜»å¡ UI çš„æƒ…å†µä¸‹æ›´æ–° stateï¼Œ startTransition ä¸ useTransition éå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒä¸æä¾› isPending æ ‡å¿—æ¥è·Ÿè¸ªä¸€ä¸ª transition æ˜¯å¦æ­£åœ¨è¿›è¡Œã€‚ä½ å¯ä»¥åœ¨ useTransition ä¸å¯ç”¨æ—¶è°ƒç”¨ startTransitionã€‚ä¾‹å¦‚ï¼Œåœ¨ç»„ä»¶å¤–éƒ¨ï¼ˆå¦‚ä»æ•°æ®åº“ä¸­ï¼‰ä½¿ç”¨ startTransition</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#a6e22e>startTransition</span>(<span style=color:#a6e22e>scope</span>)
</span></span></code></pre></div><p>å‚æ•°</p><ul><li><code>scope</code>ï¼šè°ƒç”¨ä¸€ä¸ªæˆ–å¤šä¸ª set å‡½æ•° æ¥æ›´æ–° state çš„å‡½æ•°ã€‚React ä¼šç«‹å³è°ƒç”¨æ²¡æœ‰å‚æ•°çš„ scopeï¼Œå¹¶å°†åœ¨ scope å‡½æ•°è°ƒç”¨æœŸé—´ï¼Œè°ƒåº¦æ‰€æœ‰çš„ stateï¼Œå¹¶å°†åŒæ­¥æ›´æ–°æ ‡è®°ä¸º transitionã€‚</li></ul><p>è¿”å›å€¼</p><ul><li>æ— </li></ul><p>æ³¨æ„äº‹é¡¹</p><ul><li>startTransition æ²¡æœ‰æä¾›ä¸€ç§è·Ÿè¸ª transition æ˜¯å¦å¤„äºå¾…å®šçŠ¶æ€çš„æ–¹æ³•ã€‚ä¸ºäº†åœ¨ transition è¿›è¡Œæ—¶æ˜¾ç¤ºä¸€ä¸ªå¾…å®šçŠ¶æ€çš„æŒ‡ç¤ºå™¨ï¼Œä½ éœ€è¦ä½¿ç”¨ useTransition</li><li>ä¼ é€’ç»™ startTransition çš„å‡½æ•°å¿…é¡»æ˜¯åŒæ­¥çš„ã€‚React ä¼šç«‹å³æ‰§è¡Œæ­¤å‡½æ•°ï¼Œå°†å…¶æ‰§è¡ŒæœŸé—´å‘ç”Ÿçš„æ‰€æœ‰ state æ›´æ–°æ ‡è®°ä¸º transitionã€‚</li><li>ä¸€ä¸ªè¢«æ ‡è®°ä¸º transition çš„ state æ›´æ–°æ—¶å°†ä¼šè¢«å…¶ä»– state æ›´æ–°æ‰“æ–­ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ transition å†…éƒ¨æ›´æ–°å›¾è¡¨ç»„ä»¶ï¼Œä½†åœ¨å›¾è¡¨é‡æ–°æ¸²æŸ“æ—¶åœ¨è¾“å…¥æ¡†ä¸­æ‰“å­—ï¼Œåˆ™ React å°†å…ˆå¤„ç†è¾“å…¥ state æ›´æ–°ï¼Œä¹‹åæ‰ä¼šé‡æ–°å¯åŠ¨å¯¹å›¾è¡¨ç»„ä»¶çš„æ¸²æŸ“å·¥ä½œã€‚</li><li>å¦‚æœæœ‰å¤šä¸ªæ­£åœ¨è¿›è¡Œçš„ transitionï¼Œå½“å‰ React ä¼šå°†å®ƒä»¬é›†ä¸­åœ¨ä¸€èµ·å¤„ç†ã€‚è¿™æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Œåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šè¢«ç§»é™¤ã€‚</li></ul><h3 id=å°†-state-æ›´æ–°æ ‡è®°ä¸ºéé˜»å¡-transition>å°† state æ›´æ–°æ ‡è®°ä¸ºéé˜»å¡ transition
<a class=heading-link href=#%e5%b0%86-state-%e6%9b%b4%e6%96%b0%e6%a0%87%e8%ae%b0%e4%b8%ba%e9%9d%9e%e9%98%bb%e5%a1%9e-transition><i class="fa fa-link" aria-hidden=true></i></a></h3><p>transition å¯ä»¥è®©ç”¨æˆ·ç•Œé¢åœ¨æ…¢é€Ÿè®¾å¤‡ä¸Šä¿æŒæ›´æ–°å“åº”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·å•å‡»ä¸€ä¸ªé€‰é¡¹å¡ååˆæ”¹å˜ä¸»æ„å¹¶å•å‡»å¦ä¸€ä¸ªé€‰é¡¹å¡ï¼Œåˆ™å¯ä»¥åœ¨ç¬¬ä¸€æ¬¡é‡æ–°æ¸²æŸ“å®Œæˆä¹‹å‰æ‰§è¡Œæ­¤æ“ä½œè€Œæ— éœ€ç­‰å¾…ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>startTransition</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>TabContainer</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>tab</span>, <span style=color:#a6e22e>setTab</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#e6db74>&#39;about&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>selectTab</span>(<span style=color:#a6e22e>nextTab</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>startTransition</span>(() =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>setTab</span>(<span style=color:#a6e22e>nextTab</span>);
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h1 id=ç»„ä»¶>ç»„ä»¶
<a class=heading-link href=#%e7%bb%84%e4%bb%b6><i class="fa fa-link" aria-hidden=true></i></a></h1><p>React æä¾›äº†ä¸€äº›å†…ç½®çš„ç»„ä»¶ï¼Œä½ å¯ä»¥åœ¨ JSX ä¸­ä½¿ç”¨å®ƒä»¬</p><h2 id=fragment>Fragment
<a class=heading-link href=#fragment><i class="fa fa-link" aria-hidden=true></i></a></h2><p>é€šå¸¸ä½¿ç”¨ &lt;>&mldr;&lt;/> ä»£æ›¿ï¼Œå®ƒä»¬éƒ½å…è®¸ä½ åœ¨ä¸æ·»åŠ é¢å¤–èŠ‚ç‚¹çš„æƒ…å†µä¸‹å°†å­å…ƒç´ ç»„åˆã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span>&lt;&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>OneChild</span> /&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>AnotherChild</span> /&gt;
</span></span><span style=display:flex><span>&lt;/&gt;
</span></span></code></pre></div><h2 id=profiler>Profiler
<a class=heading-link href=#profiler><i class="fa fa-link" aria-hidden=true></i></a></h2><p>å…è®¸ä½ ç¼–ç¨‹å¼æµ‹é‡ React æ ‘çš„æ¸²æŸ“æ€§èƒ½</p><p>å‚æ•°</p><ul><li>idï¼šå­—ç¬¦ä¸²ï¼Œç”¨äºæ ‡è¯†æ­£åœ¨æµ‹é‡çš„ UI éƒ¨åˆ†ã€‚</li><li>onRenderï¼šonRender å›è°ƒå‡½æ•°ï¼Œå½“åŒ…è£¹çš„ç»„ä»¶æ ‘æ›´æ–°æ—¶ï¼ŒReact éƒ½ä¼šè°ƒç”¨å®ƒã€‚å®ƒæ¥æ”¶æœ‰å…³æ¸²æŸ“å†…å®¹å’Œæ‰€èŠ±è´¹æ—¶é—´çš„ä¿¡æ¯ã€‚</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span>&lt;<span style=color:#f92672>Profiler</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;App&#34;</span> <span style=color:#a6e22e>onRender</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>onRender</span>}&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>App</span> /&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>Profiler</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>onRender</span>(<span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>phase</span>, <span style=color:#a6e22e>actualDuration</span>, <span style=color:#a6e22e>baseDuration</span>, <span style=color:#a6e22e>startTime</span>, <span style=color:#a6e22e>commitTime</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// å¯¹æ¸²æŸ“æ—¶é—´è¿›è¡Œæ±‡æ€»æˆ–è®°å½•...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h2 id=strictmode>StrictMode
<a class=heading-link href=#strictmode><i class="fa fa-link" aria-hidden=true></i></a></h2><p>å¸®åŠ©ä½ åœ¨å¼€å‘è¿‡ç¨‹ä¸­å°½æ—©åœ°å‘ç°ç»„ä»¶ä¸­çš„å¸¸è§é”™è¯¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>StrictMode</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>createRoot</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;react-dom/client&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>root</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createRoot</span>(document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;root&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#a6e22e>root</span>.<span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>StrictMode</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>App</span> /&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>StrictMode</span>&gt;
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>ä¸¥æ ¼æ¨¡å¼å¯ç”¨äº†ä»¥ä¸‹ä»…åœ¨å¼€å‘ç¯å¢ƒä¸‹æœ‰æ•ˆçš„è¡Œä¸ºï¼š</p><ul><li>ç»„ä»¶å°† é‡æ–°æ¸²æŸ“ä¸€æ¬¡ï¼Œä»¥æŸ¥æ‰¾ç”±äºéçº¯æ¸²æŸ“è€Œå¼•èµ·çš„é”™è¯¯ã€‚</li><li>ç»„ä»¶å°† é‡æ–°è¿è¡Œ Effect ä¸€æ¬¡ï¼Œä»¥æŸ¥æ‰¾ç”±äºç¼ºå°‘ Effect æ¸…ç†è€Œå¼•èµ·çš„é”™è¯¯ã€‚</li><li>ç»„ä»¶å°†è¢« æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†å·²å¼ƒç”¨çš„ APIã€‚</li></ul><h3 id=suspense>Suspense
<a class=heading-link href=#suspense><i class="fa fa-link" aria-hidden=true></i></a></h3><p>å…è®¸åœ¨å­ç»„ä»¶å®ŒæˆåŠ è½½å‰å±•ç¤ºåå¤‡æ–¹æ¡ˆ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span>&lt;<span style=color:#f92672>Suspense</span> <span style=color:#a6e22e>fallback</span><span style=color:#f92672>=</span>{&lt;<span style=color:#f92672>Loading</span> /&gt;}&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>SomeComponent</span> /&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>Suspense</span>&gt;
</span></span></code></pre></div><p>å‚æ•°</p><ul><li><code>children</code>ï¼šçœŸæ­£çš„ UI æ¸²æŸ“å†…å®¹ã€‚å¦‚æœ children åœ¨æ¸²æŸ“ä¸­è¢«æŒ‚èµ·ï¼ŒSuspense è¾¹ç•Œå°†ä¼šæ¸²æŸ“ fallbackã€‚</li><li><code>fallback</code>ï¼šçœŸæ­£çš„ UI æœªæ¸²æŸ“å®Œæˆæ—¶ä»£æ›¿å…¶æ¸²æŸ“çš„å¤‡ç”¨ UIï¼Œå®ƒå¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ React èŠ‚ç‚¹ã€‚åå¤‡æ–¹æ¡ˆé€šå¸¸æ˜¯ä¸€ä¸ªè½»é‡çš„å ä½ç¬¦ï¼Œä¾‹å¦‚è¡¨ç¤ºåŠ è½½ä¸­çš„å›¾æ ‡æˆ–è€…éª¨æ¶å±ã€‚å½“ children è¢«æŒ‚èµ·æ—¶ï¼ŒSuspense å°†è‡ªåŠ¨åˆ‡æ¢è‡³æ¸²æŸ“ fallbackï¼›å½“æ•°æ®å‡†å¤‡å¥½æ—¶ï¼Œåˆä¼šè‡ªåŠ¨åˆ‡æ¢è‡³æ¸²æŸ“ childrenã€‚å¦‚æœ fallback åœ¨æ¸²æŸ“ä¸­è¢«æŒ‚èµ·ï¼Œé‚£ä¹ˆå°†è‡ªåŠ¨æ¿€æ´»æœ€è¿‘çš„ Suspense è¾¹ç•Œã€‚</li></ul><p>æ³¨æ„äº‹é¡¹</p><ul><li>å¦‚æœ Suspense æ­£åœ¨å±•ç¤º React ç»„ä»¶æ ‘ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆå½“å†æ¬¡è¢«æŒ‚èµ·æ—¶ï¼Œé™¤éå¯¼è‡´æ­¤å¤„æ›´æ–°æ˜¯ç”± startTransition æˆ– useDeferredValue å¼•èµ·ï¼Œå¦åˆ™ Suspense å°†å±•ç¤º fallback</li><li>åªæœ‰å¯ç”¨äº† Suspense çš„æ•°æ®æºæ‰ä¼šæ¿€æ´» Suspense ç»„ä»¶ï¼Œ 1.æ”¯æŒ Suspense çš„æ¡†æ¶å¦‚ Relay å’Œ Next.jsï¼Œ 2.ä½¿ç”¨ lazy æ‡’åŠ è½½ç»„ä»¶ä»£ç ï¼Œ3.ä½¿ç”¨ use è¯»å– Promise çš„å€¼ã€‚ï¼ˆSuspense æ— æ³• æ£€æµ‹åœ¨ Effect æˆ–äº‹ä»¶å¤„ç†ç¨‹åºä¸­è·å–æ•°æ®çš„æƒ…å†µï¼‰</li></ul><h3 id=é€æ­¥åŠ è½½å†…å®¹>é€æ­¥åŠ è½½å†…å®¹
<a class=heading-link href=#%e9%80%90%e6%ad%a5%e5%8a%a0%e8%bd%bd%e5%86%85%e5%ae%b9><i class="fa fa-link" aria-hidden=true></i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#75715e>// è°ƒæ•´ä¹‹åï¼ŒBiography ä¸éœ€è¦â€œç­‰å¾…â€ Albums åŠ è½½å®Œæˆå°±å¯ä»¥å±•ç¤ºã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>Suspense</span> <span style=color:#a6e22e>fallback</span><span style=color:#f92672>=</span>{&lt;<span style=color:#f92672>BigSpinner</span> /&gt;}&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>Biography</span> /&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>Suspense</span> <span style=color:#a6e22e>fallback</span><span style=color:#f92672>=</span>{&lt;<span style=color:#f92672>AlbumsGlimmer</span> /&gt;}&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>Panel</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Albums</span> /&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>Panel</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>Suspense</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>Suspense</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 1.å¦‚æœ Biography æ²¡æœ‰åŠ è½½å®Œæˆï¼ŒBigSpinner ä¼šæ˜¾ç¤ºåœ¨æ•´ä¸ªå†…å®¹åŒºåŸŸçš„ä½ç½®ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 2.ä¸€æ—¦ Biography åŠ è½½å®Œæˆï¼ŒBigSpinner ä¼šè¢«å†…å®¹æ›¿æ¢ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 3.å¦‚æœ Albums æ²¡æœ‰åŠ è½½å®Œæˆï¼ŒAlbumsGlimmer ä¼šæ˜¾ç¤ºåœ¨ Albums å’Œå®ƒçš„çˆ¶çº§ Panel çš„ä½ç½®ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 4.æœ€åï¼Œä¸€æ—¦ Albums åŠ è½½å®Œæˆï¼Œå®ƒä¼šæ›¿æ¢ AlbumsGlimmerã€‚
</span></span></span></code></pre></div><h3 id=åœ¨æ–°å†…å®¹åŠ è½½æ—¶å±•ç¤ºè¿‡æ—¶å†…å®¹>åœ¨æ–°å†…å®¹åŠ è½½æ—¶å±•ç¤ºè¿‡æ—¶å†…å®¹
<a class=heading-link href=#%e5%9c%a8%e6%96%b0%e5%86%85%e5%ae%b9%e5%8a%a0%e8%bd%bd%e6%97%b6%e5%b1%95%e7%a4%ba%e8%bf%87%e6%97%b6%e5%86%85%e5%ae%b9><i class="fa fa-link" aria-hidden=true></i></a></h3><p>å»¶è¿Ÿå€¼å’Œ transition éƒ½å¯ä»¥è®©ä½ é¿å…æ˜¾ç¤º Suspense åå¤‡æ–¹æ¡ˆï¼Œè€Œæ˜¯ä½¿ç”¨å†…è”æŒ‡ç¤ºå™¨ã€‚transition å°†æ•´ä¸ªæ›´æ–°æ ‡è®°ä¸ºéç´§æ€¥çš„ï¼Œå› æ­¤å®ƒä»¬é€šå¸¸ç”±æ¡†æ¶å’Œè·¯ç”±åº“ç”¨äºå¯¼èˆªã€‚å¦ä¸€æ–¹é¢ï¼Œå»¶è¿Ÿå€¼åœ¨ä½ å¸Œæœ›å°† UI çš„ä¸€éƒ¨åˆ†æ ‡è®°ä¸ºéç´§æ€¥ï¼Œå¹¶è®©å®ƒâ€œè½åäºâ€ UI çš„å…¶ä½™éƒ¨åˆ†æ—¶éå¸¸æœ‰ç”¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Suspense</span>, <span style=color:#a6e22e>useState</span>, <span style=color:#a6e22e>useDeferredValue</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>SearchResults</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./SearchResults.js&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>App</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>query</span>, <span style=color:#a6e22e>setQuery</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>deferredQuery</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useDeferredValue</span>(<span style=color:#a6e22e>query</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isStale</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>query</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>deferredQuery</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>label</span>&gt;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Search</span> <span style=color:#a6e22e>albums</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>query</span>} <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>e</span> =&gt; <span style=color:#a6e22e>setQuery</span>(<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>value</span>)} /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>label</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Suspense</span> <span style=color:#a6e22e>fallback</span><span style=color:#f92672>=</span>{&lt;<span style=color:#f92672>h2</span>&gt;<span style=color:#a6e22e>Loading</span>...&lt;/<span style=color:#f92672>h2</span>&gt;}&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span>{{ <span style=color:#a6e22e>opacity</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>isStale</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> }}&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>SearchResults</span> <span style=color:#a6e22e>query</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>deferredQuery</span>} /&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Suspense</span>&gt;
</span></span><span style=display:flex><span>    &lt;/&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div id=cusdis_thread data-host=https://cusdis.com data-app-id=c2b015f9-9a4b-4997-b66f-f9c6ca26ebdd data-page-id=b4ca511be5186bd9af5b1b81e035ff02 data-page-url=https://chenkai.life/react/react-apicompoent/ data-page-title="React API & ç»„ä»¶" data-iframe=/js/cusdis/iframe.umd.js data-style=/js/cusdis/style.css></div></article></section></div></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script>
<script src=/js/custom.js></script>
<script src=/js/font.min.js></script></body><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script></html>