<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=theme-color content="#ffffff"><meta name=color-scheme content="light dark"><meta name=description content="useRef useRef è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ .current å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•°initialValueã€‚è¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜, ref å…è®¸ç»„ä»¶ ä¿å­˜ä¸€äº›ä¸ç”¨äºæ¸²æŸ“çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ DOM èŠ‚ç‚¹æˆ– timeout IDã€‚ä¸stateä¸åŒï¼Œæ›´æ–° ref ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚
å‚è€ƒ const ref = useRef(initialValue) å‚æ•°
initialValue: ref å¯¹è±¡çš„ current å±æ€§çš„åˆå§‹å€¼ã€‚å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„å€¼ã€‚è¿™ä¸ªå‚æ•°åœ¨é¦–æ¬¡æ¸²æŸ“åè¢«å¿½ç•¥ è¿”å›å€¼
ref: è¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªcurrentå±æ€§çš„å¯¹è±¡, åˆå§‹å€¼ä¸ºä¼ é€’çš„ initialValueã€‚ä¹‹åå¯ä»¥å°†å…¶è®¾ç½®ä¸ºå…¶ä»–å€¼ã€‚å¦‚æœå°† ref å¯¹è±¡ä½œä¸ºä¸€ä¸ª JSX èŠ‚ç‚¹çš„ ref å±æ€§ä¼ é€’ç»™ Reactï¼ŒReact å°†ä¸ºå®ƒè®¾ç½® current å±æ€§ã€‚ åœ¨åç»­çš„æ¸²æŸ“ä¸­ï¼ŒuseRef å°†è¿”å›åŒä¸€ä¸ªå¯¹è±¡ã€‚ æ³¨æ„äº‹é¡¹
ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥æˆ–è€…è¯»å– ref.current æ”¹å˜ ref.current å±æ€§æ—¶ï¼ŒReact ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ é™¤äº† åˆå§‹åŒ– å¤–ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥æˆ–è€…è¯»å– ref.current åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒReact å°†ä¼š è°ƒç”¨ä¸¤æ¬¡ç»„ä»¶æ–¹æ³• é€šè¿‡ ref æ“ä½œ DOM ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹ä¾¿æ˜¯å‘½ä»¤å¼åœ°è®¿é—®å­ç»„ä»¶
function TextInputWithFocusButton() { const inputRef = useRef(null); const onButtonClick = () => { // å½“ React åˆ›å»º DOM èŠ‚ç‚¹å¹¶å°†å…¶æ¸²æŸ“åˆ°å±å¹•æ—¶ï¼ŒReact å°†ä¼šæŠŠ DOM èŠ‚ç‚¹è®¾ç½®ä¸º ref å¯¹è±¡çš„ current å±æ€§ // å½“èŠ‚ç‚¹ä»å±å¹•ä¸Šç§»é™¤æ—¶ï¼ŒReact å°†æŠŠ current å±æ€§è®¾ç½®å› null // `current` æŒ‡å‘å·²æŒ‚è½½åˆ° DOM ä¸Šçš„æ–‡æœ¬è¾“å…¥å…ƒç´  inputRef."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="React Hook Ref"><meta name=twitter:description content="useRef useRef è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ .current å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•°initialValueã€‚è¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜, ref å…è®¸ç»„ä»¶ ä¿å­˜ä¸€äº›ä¸ç”¨äºæ¸²æŸ“çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ DOM èŠ‚ç‚¹æˆ– timeout IDã€‚ä¸stateä¸åŒï¼Œæ›´æ–° ref ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚
å‚è€ƒ const ref = useRef(initialValue) å‚æ•°
initialValue: ref å¯¹è±¡çš„ current å±æ€§çš„åˆå§‹å€¼ã€‚å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„å€¼ã€‚è¿™ä¸ªå‚æ•°åœ¨é¦–æ¬¡æ¸²æŸ“åè¢«å¿½ç•¥ è¿”å›å€¼
ref: è¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªcurrentå±æ€§çš„å¯¹è±¡, åˆå§‹å€¼ä¸ºä¼ é€’çš„ initialValueã€‚ä¹‹åå¯ä»¥å°†å…¶è®¾ç½®ä¸ºå…¶ä»–å€¼ã€‚å¦‚æœå°† ref å¯¹è±¡ä½œä¸ºä¸€ä¸ª JSX èŠ‚ç‚¹çš„ ref å±æ€§ä¼ é€’ç»™ Reactï¼ŒReact å°†ä¸ºå®ƒè®¾ç½® current å±æ€§ã€‚ åœ¨åç»­çš„æ¸²æŸ“ä¸­ï¼ŒuseRef å°†è¿”å›åŒä¸€ä¸ªå¯¹è±¡ã€‚ æ³¨æ„äº‹é¡¹
ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥æˆ–è€…è¯»å– ref.current æ”¹å˜ ref.current å±æ€§æ—¶ï¼ŒReact ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ é™¤äº† åˆå§‹åŒ– å¤–ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥æˆ–è€…è¯»å– ref.current åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒReact å°†ä¼š è°ƒç”¨ä¸¤æ¬¡ç»„ä»¶æ–¹æ³• é€šè¿‡ ref æ“ä½œ DOM ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹ä¾¿æ˜¯å‘½ä»¤å¼åœ°è®¿é—®å­ç»„ä»¶
function TextInputWithFocusButton() { const inputRef = useRef(null); const onButtonClick = () => { // å½“ React åˆ›å»º DOM èŠ‚ç‚¹å¹¶å°†å…¶æ¸²æŸ“åˆ°å±å¹•æ—¶ï¼ŒReact å°†ä¼šæŠŠ DOM èŠ‚ç‚¹è®¾ç½®ä¸º ref å¯¹è±¡çš„ current å±æ€§ // å½“èŠ‚ç‚¹ä»å±å¹•ä¸Šç§»é™¤æ—¶ï¼ŒReact å°†æŠŠ current å±æ€§è®¾ç½®å› null // `current` æŒ‡å‘å·²æŒ‚è½½åˆ° DOM ä¸Šçš„æ–‡æœ¬è¾“å…¥å…ƒç´  inputRef."><meta property="og:title" content="React Hook Ref"><meta property="og:description" content="useRef useRef è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ .current å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•°initialValueã€‚è¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜, ref å…è®¸ç»„ä»¶ ä¿å­˜ä¸€äº›ä¸ç”¨äºæ¸²æŸ“çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ DOM èŠ‚ç‚¹æˆ– timeout IDã€‚ä¸stateä¸åŒï¼Œæ›´æ–° ref ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚
å‚è€ƒ const ref = useRef(initialValue) å‚æ•°
initialValue: ref å¯¹è±¡çš„ current å±æ€§çš„åˆå§‹å€¼ã€‚å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„å€¼ã€‚è¿™ä¸ªå‚æ•°åœ¨é¦–æ¬¡æ¸²æŸ“åè¢«å¿½ç•¥ è¿”å›å€¼
ref: è¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªcurrentå±æ€§çš„å¯¹è±¡, åˆå§‹å€¼ä¸ºä¼ é€’çš„ initialValueã€‚ä¹‹åå¯ä»¥å°†å…¶è®¾ç½®ä¸ºå…¶ä»–å€¼ã€‚å¦‚æœå°† ref å¯¹è±¡ä½œä¸ºä¸€ä¸ª JSX èŠ‚ç‚¹çš„ ref å±æ€§ä¼ é€’ç»™ Reactï¼ŒReact å°†ä¸ºå®ƒè®¾ç½® current å±æ€§ã€‚ åœ¨åç»­çš„æ¸²æŸ“ä¸­ï¼ŒuseRef å°†è¿”å›åŒä¸€ä¸ªå¯¹è±¡ã€‚ æ³¨æ„äº‹é¡¹
ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥æˆ–è€…è¯»å– ref.current æ”¹å˜ ref.current å±æ€§æ—¶ï¼ŒReact ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ é™¤äº† åˆå§‹åŒ– å¤–ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥æˆ–è€…è¯»å– ref.current åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒReact å°†ä¼š è°ƒç”¨ä¸¤æ¬¡ç»„ä»¶æ–¹æ³• é€šè¿‡ ref æ“ä½œ DOM ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹ä¾¿æ˜¯å‘½ä»¤å¼åœ°è®¿é—®å­ç»„ä»¶
function TextInputWithFocusButton() { const inputRef = useRef(null); const onButtonClick = () => { // å½“ React åˆ›å»º DOM èŠ‚ç‚¹å¹¶å°†å…¶æ¸²æŸ“åˆ°å±å¹•æ—¶ï¼ŒReact å°†ä¼šæŠŠ DOM èŠ‚ç‚¹è®¾ç½®ä¸º ref å¯¹è±¡çš„ current å±æ€§ // å½“èŠ‚ç‚¹ä»å±å¹•ä¸Šç§»é™¤æ—¶ï¼ŒReact å°†æŠŠ current å±æ€§è®¾ç½®å› null // `current` æŒ‡å‘å·²æŒ‚è½½åˆ° DOM ä¸Šçš„æ–‡æœ¬è¾“å…¥å…ƒç´  inputRef."><meta property="og:type" content="article"><meta property="og:url" content="https://chenkai.life/react/react-hooks-ref/"><meta property="article:section" content="react"><meta property="article:published_time" content="2024-08-24T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-12T09:39:59+08:00"><title>React Hook Ref Â· CK's Blog</title><link rel=canonical href=https://chenkai.life/react/react-hooks-ref/><link rel=stylesheet href=/css/coder.min.0e0f0ac9929898ae6625ca3789e3f9e2e630ead0a5e0f1fe96c1ba7d8774342c.css integrity="sha256-Dg8KyZKYmK5mJco3ieP54uYw6tCl4PH+lsG6fYd0NCw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.d8f89ef09509afb63b9b2595ee174e53cc51ce02a6f6a2179e1621f9389e4340.css integrity="sha256-2Pie8JUJr7Y7myWV7hdOU8xRzgKm9qIXnhYh+TieQ0A=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/custom.min.d12542c00c198b6a07ca9ea5981102805aecab0f5dfd5e3273d8c179088712c4.css integrity="sha256-0SVCwAwZi2oHyp6lmBECgFrsqw9d/V4yc9jBeQiHEsQ=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/favicon.ico><link rel=apple-touch-icon type=image/png sizes=256x256 href=/images/favicon-512x512.png><meta name=generator content="Hugo 0.119.0"><link rel=manifest href=/manifest.webmanifest></head><body class="preload-transitions colorscheme-auto"><div class=float-container><span id=dark-mode-toggle class=colorscheme-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-anheimoshi"/></svg></span></div><details id=table-of-contents-wapper><summary><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></summary></details><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>CK's Blog</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/>Home</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/marks/>Marks</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/ckvv/ckvv.github.io/tree/main/content>Create</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item id=search-content><input class=search-int type=text placeholder=Search>
<button class=search-btn data-type=github>GitHub</button>
<button class=search-btn data-type=google>Google</button></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=https://chenkai.life/react/react-hooks-ref/>React Hook Ref</a></h1><div class=edit-link style=float:right;color:#0366d6><a class=title rel=noopener target=_blank href=https://github.com/ckvv/ckvv.github.io/edit/main/content/react/react-hooks-ref.md>ç¼–è¾‘</a></div></header><div class=post-meta><div class=date><span class=posted-on><svg class="icon" aria-hidden="true"><use xlink:href="#icon-date"/></svg><time datetime=2024-08-24T00:00:00Z>2024-08-24</time></span></div><div class=tags><svg class="icon" aria-hidden="true"><use xlink:href="#icon-biaoqian"/></svg><span class=tag><a href=/tags/react/>React</a></span></div></div><h2 id=useref>useRef
<a class=heading-link href=#useref><i class="fa fa-link" aria-hidden=true></i></a></h2><p><code>useRef</code> è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ <code>.current</code> å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•°<code>initialValue</code>ã€‚è¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜, ref å…è®¸ç»„ä»¶ ä¿å­˜ä¸€äº›ä¸ç”¨äºæ¸²æŸ“çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ DOM èŠ‚ç‚¹æˆ– timeout IDã€‚ä¸<code>state</code>ä¸åŒï¼Œæ›´æ–° <code>ref</code> ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚</p><h3 id=å‚è€ƒ>å‚è€ƒ
<a class=heading-link href=#%e5%8f%82%e8%80%83><i class="fa fa-link" aria-hidden=true></i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ref</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>(<span style=color:#a6e22e>initialValue</span>)
</span></span></code></pre></div><p>å‚æ•°</p><ul><li><code>initialValue</code>: ref å¯¹è±¡çš„ current å±æ€§çš„åˆå§‹å€¼ã€‚å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„å€¼ã€‚è¿™ä¸ªå‚æ•°åœ¨é¦–æ¬¡æ¸²æŸ“åè¢«å¿½ç•¥</li></ul><p>è¿”å›å€¼</p><ul><li><code>ref</code>: è¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ª<code>current</code>å±æ€§çš„å¯¹è±¡, åˆå§‹å€¼ä¸ºä¼ é€’çš„ initialValueã€‚ä¹‹åå¯ä»¥å°†å…¶è®¾ç½®ä¸ºå…¶ä»–å€¼ã€‚å¦‚æœå°† ref å¯¹è±¡ä½œä¸ºä¸€ä¸ª JSX èŠ‚ç‚¹çš„ ref å±æ€§ä¼ é€’ç»™ Reactï¼ŒReact å°†ä¸ºå®ƒè®¾ç½® current å±æ€§ã€‚
åœ¨åç»­çš„æ¸²æŸ“ä¸­ï¼ŒuseRef å°†è¿”å›åŒä¸€ä¸ªå¯¹è±¡ã€‚</li></ul><p>æ³¨æ„äº‹é¡¹</p><ul><li>ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥æˆ–è€…è¯»å– ref.current</li><li>æ”¹å˜ ref.current å±æ€§æ—¶ï¼ŒReact ä¸ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶</li><li>é™¤äº† åˆå§‹åŒ– å¤–ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥æˆ–è€…è¯»å– ref.current</li><li>åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒReact å°†ä¼š è°ƒç”¨ä¸¤æ¬¡ç»„ä»¶æ–¹æ³•</li></ul><h3 id=é€šè¿‡-ref-æ“ä½œ-dom>é€šè¿‡ ref æ“ä½œ DOM
<a class=heading-link href=#%e9%80%9a%e8%bf%87-ref-%e6%93%8d%e4%bd%9c-dom><i class="fa fa-link" aria-hidden=true></i></a></h3><p>ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹ä¾¿æ˜¯å‘½ä»¤å¼åœ°è®¿é—®å­ç»„ä»¶</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>TextInputWithFocusButton</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>inputRef</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>(<span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>onButtonClick</span> <span style=color:#f92672>=</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å½“ React åˆ›å»º DOM èŠ‚ç‚¹å¹¶å°†å…¶æ¸²æŸ“åˆ°å±å¹•æ—¶ï¼ŒReact å°†ä¼šæŠŠ DOM èŠ‚ç‚¹è®¾ç½®ä¸º ref å¯¹è±¡çš„ current å±æ€§
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// å½“èŠ‚ç‚¹ä»å±å¹•ä¸Šç§»é™¤æ—¶ï¼ŒReact å°†æŠŠ current å±æ€§è®¾ç½®å› null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// `current` æŒ‡å‘å·²æŒ‚è½½åˆ° DOM ä¸Šçš„æ–‡æœ¬è¾“å…¥å…ƒç´ 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>inputRef</span>.<span style=color:#a6e22e>current</span>.<span style=color:#a6e22e>focus</span>();
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>inputRef</span>} <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>onButtonClick</span>}&gt;<span style=color:#a6e22e>Focus</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>input</span>&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>    &lt;/&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=ä¿å­˜å®ä¾‹å˜é‡>ä¿å­˜å®ä¾‹å˜é‡
<a class=heading-link href=#%e4%bf%9d%e5%ad%98%e5%ae%9e%e4%be%8b%e5%8f%98%e9%87%8f><i class="fa fa-link" aria-hidden=true></i></a></h3><p><a href=https://react.docschina.org/docs/hooks-reference.html#useref><code>useRef()</code></a> Hook ä¸ä»…å¯ä»¥ç”¨äº DOM refsã€‚æœ¬è´¨ä¸Šï¼Œ<code>useRef</code> å°±åƒæ˜¯å¯ä»¥åœ¨å…¶ <code>.current</code> å±æ€§ä¸­ä¿å­˜ä¸€ä¸ªå¯å˜å€¼çš„â€œç›’å­â€, ç±»ä¼¼äºä¸€ä¸ª class çš„å®ä¾‹å±æ€§ã€‚<code>useRef()</code> å’Œè‡ªå»ºä¸€ä¸ª <code>{current: ...}</code> å¯¹è±¡çš„å”¯ä¸€åŒºåˆ«æ˜¯ï¼Œ<code>useRef</code> ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶è¿”å›åŒä¸€ä¸ª ref å¯¹è±¡.</p><p>å½“ ref å¯¹è±¡å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<code>useRef</code> å¹¶<em>ä¸ä¼š</em>é€šçŸ¥ä½ ã€‚å³å˜æ›´ <code>.current</code> å±æ€§ä¸ä¼šå¼•å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>TextInputWithFocusButton</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>countRes</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>countRes</span>.<span style=color:#a6e22e>current</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>countRes</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>countRes</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      }}&gt;<span style=color:#a6e22e>Focus</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>input</span>&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>countRes</span>.<span style=color:#a6e22e>current</span>}
</span></span><span style=display:flex><span>    &lt;/&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=è·å–ä¸Šä¸€è½®çš„-props-æˆ–-state>è·å–ä¸Šä¸€è½®çš„ props æˆ– state
<a class=heading-link href=#%e8%8e%b7%e5%8f%96%e4%b8%8a%e4%b8%80%e8%bd%ae%e7%9a%84-props-%e6%88%96-state><i class="fa fa-link" aria-hidden=true></i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>usePrevious</span>(<span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ref</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>useEffect</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ref</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ref</span>.<span style=color:#a6e22e>current</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Counter</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>count</span>, <span style=color:#a6e22e>setCount</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>prevCount</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>usePrevious</span>(<span style=color:#a6e22e>count</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>h1</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Now</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>count</span>}, <span style=color:#a6e22e>before</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>prevCount</span>}<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/h1&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() =&gt; <span style=color:#a6e22e>setCount</span>(<span style=color:#a6e22e>count</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)}<span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Add</span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/button&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/&gt;</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=å›è°ƒref>å›è°ƒRef
<a class=heading-link href=#%e5%9b%9e%e8%b0%83ref><i class="fa fa-link" aria-hidden=true></i></a></h3><p>å¦‚æœæƒ³è¦åœ¨ React ç»‘å®šæˆ–è§£ç»‘ DOM èŠ‚ç‚¹çš„ ref æ—¶è¿è¡ŒæŸäº›ä»£ç ï¼Œä½ ä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¸­æ¥å— React ç»„ä»¶å®ä¾‹æˆ– HTML DOM å…ƒç´ ä½œä¸ºå‚æ•°,å®ƒèƒ½åŠ©ä½ æ›´ç²¾ç»†åœ°æ§åˆ¶ä½•æ—¶ refs è¢«è®¾ç½®å’Œè§£é™¤ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>TextInput</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>textInput</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ä¸éœ€è¦ä½¿ç”¨useRef
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>inputRef</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>ele</span>)=&gt;{
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>ele</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>textInput</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ele</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>inputRef</span>} <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() =&gt; {<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>textInput</span>)}}&gt;<span style=color:#a6e22e>Focus</span> <span style=color:#a6e22e>the</span> <span style=color:#a6e22e>input</span>&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>    &lt;/&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä½¿ç”¨ ref å›è°ƒç®¡ç† ref åˆ—è¡¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>itemsRef</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>(<span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getMap</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>itemsRef</span>.<span style=color:#a6e22e>current</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// é¦–æ¬¡è¿è¡Œæ—¶åˆå§‹åŒ– Mapã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>itemsRef</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Map</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>itemsRef</span>.<span style=color:#a6e22e>current</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>li</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>cat</span>.<span style=color:#a6e22e>id</span>}
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>node</span> =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>map</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getMap</span>();
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>node</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Add to the Map
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>map</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>cat</span>, <span style=color:#a6e22e>node</span>);
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Remove from the Map
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>map</span>.<span style=color:#66d9ef>delete</span>(<span style=color:#a6e22e>cat</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }}
</span></span><span style=display:flex><span>  &gt;
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>æˆ–è€…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span>&lt;<span style=color:#f92672>li</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>cat</span>.<span style=color:#a6e22e>id</span>}
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>node</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>map</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getMap</span>();
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Add to the Map
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>map</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>cat</span>, <span style=color:#a6e22e>node</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Remove from the Map
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>map</span>.<span style=color:#66d9ef>delete</span>(<span style=color:#a6e22e>cat</span>);
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }}
</span></span><span style=display:flex><span>&gt;
</span></span></code></pre></div><h3 id=æ›´æ–°-state-åç«‹å³è®¿é—®-ref-dom>æ›´æ–° state åç«‹å³è®¿é—® ref Dom
<a class=heading-link href=#%e6%9b%b4%e6%96%b0-state-%e5%90%8e%e7%ab%8b%e5%8d%b3%e8%ae%bf%e9%97%ae-ref-dom><i class="fa fa-link" aria-hidden=true></i></a></h3><p>åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æœŸé—´ï¼ŒDOM èŠ‚ç‚¹å°šæœªåˆ›å»ºï¼Œå› æ­¤ ref.current å°†ä¸º nullã€‚åœ¨æ¸²æŸ“æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼ŒDOM èŠ‚ç‚¹è¿˜æ²¡æœ‰æ›´æ–°ã€‚æ‰€ä»¥è¯»å–å®ƒä»¬è¿˜ä¸ºæ—¶è¿‡æ—©, è¦è§£å†³æ­¤é—®é¢˜ï¼Œä½ å¯ä»¥å¼ºåˆ¶ React åŒæ­¥æ›´æ–°ï¼ˆâ€œåˆ·æ–°â€ï¼‰DOMã€‚ ä¸ºæ­¤ï¼Œä» <code>react-dom</code> å¯¼å…¥ <code>flushSync</code> å¹¶å°† state æ›´æ–°åŒ…è£¹ åˆ° <code>flushSync</code> è°ƒç”¨ä¸­ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#75715e>//  flushSync ä¸­çš„ä»£ç æ‰§è¡Œåï¼Œç«‹å³åŒæ­¥æ›´æ–° DOM
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>flushSync</span>(() =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setTodos</span>([ ...<span style=color:#a6e22e>todos</span>, <span style=color:#a6e22e>newTodo</span>]);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#a6e22e>listRef</span>.<span style=color:#a6e22e>current</span>.<span style=color:#a6e22e>lastChild</span>.<span style=color:#a6e22e>scrollIntoView</span>();
</span></span></code></pre></div><h3 id=è®¿é—®å¦ä¸€ä¸ªç»„ä»¶çš„-dom-èŠ‚ç‚¹>è®¿é—®å¦ä¸€ä¸ªç»„ä»¶çš„ DOM èŠ‚ç‚¹
<a class=heading-link href=#%e8%ae%bf%e9%97%ae%e5%8f%a6%e4%b8%80%e4%b8%aa%e7%bb%84%e4%bb%b6%e7%9a%84-dom-%e8%8a%82%e7%82%b9><i class="fa fa-link" aria-hidden=true></i></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact ä¸å…è®¸ç»„ä»¶è®¿é—®å…¶ä»–ç»„ä»¶çš„ DOM èŠ‚ç‚¹ã€‚ç”šè‡³è‡ªå·±çš„å­ç»„ä»¶ä¹Ÿä¸è¡Œï¼Œæƒ³è¦ æš´éœ²å…¶ DOM èŠ‚ç‚¹çš„ç»„ä»¶å¿…é¡»é€‰æ‹©è¯¥è¡Œä¸ºã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#75715e>// MyInput ç»„ä»¶æ˜¯ä½¿ç”¨ forwardRef å£°æ˜çš„ã€‚ è¿™è®©ä»ä¸Šé¢æ¥æ”¶çš„ inputRef ä½œä¸ºç¬¬äºŒä¸ªå‚æ•° ref ä¼ å…¥ç»„ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e>// MyInput ç»„ä»¶å°†è‡ªå·±æ¥æ”¶åˆ°çš„ ref ä¼ é€’ç»™å®ƒå†…éƒ¨çš„ &lt;input&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>// useImperativeHandleå¯ä»¥é™åˆ¶æš´éœ²çš„åŠŸèƒ½
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>MyInput</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>forwardRef</span>((<span style=color:#a6e22e>props</span>, <span style=color:#a6e22e>ref</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>input</span> {<span style=color:#a6e22e>...props</span>} <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>ref</span>} /&gt;;
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span>&lt;<span style=color:#f92672>MyInput</span> <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>inputRef</span>} /&gt;
</span></span></code></pre></div><h3 id=ä¸è¦åœ¨æ¸²æŸ“æœŸé—´è¯»å–å†™å…¥-ref>ä¸è¦åœ¨æ¸²æŸ“æœŸé—´è¯»å–ã€å†™å…¥ ref
<a class=heading-link href=#%e4%b8%8d%e8%a6%81%e5%9c%a8%e6%b8%b2%e6%9f%93%e6%9c%9f%e9%97%b4%e8%af%bb%e5%8f%96%e5%86%99%e5%85%a5-ref><i class="fa fa-link" aria-hidden=true></i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>MyComponent</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// ğŸš© ä¸è¦åœ¨æ¸²æŸ“æœŸé—´å†™å…¥ ref
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>myRef</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>123</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// ğŸš© ä¸è¦åœ¨æ¸²æŸ“æœŸé—´è¯»å– ref
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>h1</span>&gt;{<span style=color:#a6e22e>myOtherRef</span>.<span style=color:#a6e22e>current</span>}&lt;/<span style=color:#f92672>h1</span>&gt;;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¯ä»¥åœ¨ äº‹ä»¶å¤„ç†ç¨‹åºæˆ–è€… Effect ä¸­è¯»å–å’Œå†™å…¥ refã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>MyComponent</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>useEffect</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// âœ… å¯ä»¥åœ¨ Effect ä¸­è¯»å–å’Œå†™å…¥ ref
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>myRef</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>123</span>;
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleClick</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// âœ… å¯ä»¥åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­è¯»å–å’Œå†™å…¥ ref
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>doSomething</span>(<span style=color:#a6e22e>myOtherRef</span>.<span style=color:#a6e22e>current</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><ul><li>React çš„æ¸²æŸ“è¿‡ç¨‹éœ€è¦æ˜¯å¯é¢„æµ‹å’Œç¡®å®šçš„ã€‚å¦‚æœåœ¨æ¸²æŸ“æœŸé—´å…è®¸è¯»å–æˆ–å†™å…¥ refï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¸²æŸ“ç»“æœçš„ä¸ç¡®å®šæ€§</li><li>è¯»å–æˆ–å†™å…¥ ref å¯èƒ½ä¼šè§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œä»è€Œå¯¼è‡´æ— é™å¾ªç¯</li><li>React é€šå¸¸ä¼šå¯¹å¤šä¸ªçŠ¶æ€æ›´æ–°è¿›è¡Œæ‰¹å¤„ç†ï¼Œä»¥æé«˜æ€§èƒ½ã€‚å¦‚æœåœ¨æ¸²æŸ“æœŸé—´å…è®¸è¯»å–æˆ–å†™å…¥ refï¼Œå¯èƒ½ä¼šç ´åè¿™ç§æ‰¹å¤„ç†æœºåˆ¶ã€‚å› ä¸º ref çš„å€¼ä¸å— React çš„çŠ¶æ€ç®¡ç†ç³»ç»Ÿæ§åˆ¶ï¼Œç›´æ¥è¯»å–æˆ–å†™å…¥ ref å¯èƒ½ä¼šå¯¼è‡´ä¸ä¸€è‡´çš„çŠ¶æ€å’Œæ¸²æŸ“ç»“æœã€‚</li><li>React ä¹Ÿæ”¯æŒå¼‚æ­¥æ›´æ–°ï¼Œä¾‹å¦‚åœ¨ä½¿ç”¨ setState æˆ– useState çš„å›è°ƒå‡½æ•°ä¸­è¿›è¡ŒçŠ¶æ€æ›´æ–°æ—¶ï¼Œè¿™äº›æ›´æ–°å¯èƒ½ä¼šè¢«å»¶è¿Ÿæ‰§è¡Œã€‚å¦‚æœåœ¨æ¸²æŸ“æœŸé—´è¯»å–æˆ–å†™å…¥ refï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸å¼‚æ­¥æ›´æ–°çš„ä¸ä¸€è‡´æ€§</li><li>ä¾¿äºé”™è¯¯è¿½è¸ªå’Œè°ƒè¯•ï¼Œæ˜ç¡®é”™è¯¯æ¥æºï¼Œ</li></ul><h3 id=é¿å…é‡å¤åˆ›å»º-ref-çš„å†…å®¹>é¿å…é‡å¤åˆ›å»º ref çš„å†…å®¹
<a class=heading-link href=#%e9%81%bf%e5%85%8d%e9%87%8d%e5%a4%8d%e5%88%9b%e5%bb%ba-ref-%e7%9a%84%e5%86%85%e5%ae%b9><i class="fa fa-link" aria-hidden=true></i></a></h3><p>React ä¼šä¿å­˜ ref åˆå§‹å€¼ï¼Œå¹¶åœ¨åç»­çš„æ¸²æŸ“ä¸­å¿½ç•¥å®ƒ, å¦‚ <code>const playerRef = useRef(new VideoPlayer())</code>ï¼Œè™½ç„¶ new VideoPlayer() çš„ç»“æœåªä¼šåœ¨é¦–æ¬¡æ¸²æŸ“æ—¶ä½¿ç”¨ï¼Œä½†æ˜¯ä¾ç„¶åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½åœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Video</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>playerRef</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>(<span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å†™å…¥æˆ–è¯»å– ref.current æ˜¯ä¸å…è®¸çš„ã€‚ç„¶è€Œï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºç»“æœæ€»æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”æ¡ä»¶åªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œï¼Œæ‰€ä»¥æ˜¯å®Œå…¨å¯é¢„æµ‹çš„ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>playerRef</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>playerRef</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>VideoPlayer</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h3 id=è‡ªå®šä¹‰ç»„ä»¶çš„-ref>è‡ªå®šä¹‰ç»„ä»¶çš„ ref
<a class=heading-link href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e7%bb%84%e4%bb%b6%e7%9a%84-ref><i class="fa fa-link" aria-hidden=true></i></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè‡ªå®šä¹‰ç»„ä»¶ä¸ä¼šæš´éœ²å®ƒä»¬å†…éƒ¨ DOM èŠ‚ç‚¹çš„ refã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#75715e>// ä¸€ä¸ªç»„ä»¶å¯ä»¥æŒ‡å®šå°†å®ƒçš„ ref â€œè½¬å‘â€ç»™ä¸€ä¸ªå­ç»„ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>MyInput</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>forwardRef</span>((<span style=color:#a6e22e>props</span>, <span style=color:#a6e22e>ref</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>input</span> {<span style=color:#a6e22e>...props</span>} <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>ref</span>} /&gt;;
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=useimperativehandle>useImperativeHandle
<a class=heading-link href=#useimperativehandle><i class="fa fa-link" aria-hidden=true></i></a></h2><p><code>useImperativeHandle</code> å¯ä»¥è®©ä½ åœ¨ä½¿ç”¨ <code>ref</code> æ—¶è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ã€‚<code>useImperativeHandle</code> åº”å½“ä¸ <a href=https://react.docschina.org/reference/react/forwardRef><code>forwardRef</code></a> ä¸€èµ·ä½¿ç”¨ï¼š</p><h3 id=å‚è€ƒ-1>å‚è€ƒ
<a class=heading-link href=#%e5%8f%82%e8%80%83-1><i class="fa fa-link" aria-hidden=true></i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>useImperativeHandle</span>(<span style=color:#a6e22e>ref</span>, <span style=color:#a6e22e>createHandle</span>, <span style=color:#a6e22e>dependencies</span><span style=color:#f92672>?</span>)
</span></span></code></pre></div><p>å‚æ•°</p><ul><li><code>ref</code>ï¼šè¯¥ ref æ˜¯ä½ ä» forwardRef æ¸²æŸ“å‡½æ•° ä¸­è·å¾—çš„ç¬¬äºŒä¸ªå‚æ•°</li><li><code>create</code>Handleï¼šè¯¥å‡½æ•°æ— éœ€å‚æ•°ï¼Œå®ƒè¿”å›ä½ æƒ³è¦æš´éœ²çš„ ref çš„å¥æŸ„ã€‚è¯¥å¥æŸ„å¯ä»¥åŒ…å«ä»»ä½•ç±»å‹ã€‚é€šå¸¸ï¼Œä½ ä¼šè¿”å›ä¸€ä¸ªåŒ…å«ä½ æƒ³æš´éœ²çš„æ–¹æ³•çš„å¯¹è±¡</li><li><code>dependencies</code>ï¼šcreateHandle ä»£ç ä¸­æ‰€ç”¨åˆ°çš„æ‰€æœ‰ååº”å¼çš„å€¼çš„åˆ—è¡¨ã€‚ å¦‚æœä¸€æ¬¡é‡æ–°æ¸²æŸ“å¯¼è‡´æŸäº›ä¾èµ–é¡¹å‘ç”Ÿäº†æ”¹å˜ï¼Œæˆ–ä½ æ²¡æœ‰æä¾›è¿™ä¸ªå‚æ•°åˆ—è¡¨ï¼ŒcreateHandle å°†ä¼šè¢«é‡æ–°æ‰§è¡Œï¼Œè€Œæ–°ç”Ÿæˆçš„å¥æŸ„åˆ™ä¼šè¢«åˆ†é…ç»™ ref</li></ul><p>è¿”å›å€¼
undefined</p><h3 id=åŸºç¡€ç”¨æ³•>åŸºç¡€ç”¨æ³•
<a class=heading-link href=#%e5%9f%ba%e7%a1%80%e7%94%a8%e6%b3%95><i class="fa fa-link" aria-hidden=true></i></a></h3><p>çˆ¶ç»„ä»¶å¯ä»¥è°ƒç”¨ <code>inputRef.current.focus()</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#75715e>//è¯¥æ¸²æŸ“å‡½æ•°ä¼šå°† ref ä¼ é€’ç»™ &lt;input ref={ref}&gt; å…ƒç´ ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>FancyInput</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>forwardRef</span>(<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>FancyInput</span>(<span style=color:#a6e22e>props</span>, <span style=color:#a6e22e>ref</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>inputRef</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>useImperativeHandle</span>(<span style=color:#a6e22e>ref</span>, () =&gt; ({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>focus</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>inputRef</span>.<span style=color:#a6e22e>current</span>.<span style=color:#a6e22e>focus</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }));
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>inputRef</span>} /&gt;;
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Wrapper</span>(){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>inputRef</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>();
</span></span><span style=display:flex><span>  <span style=color:#75715e>// React ä¼šå°† &lt;FancyButton ref={ref}&gt; å…ƒç´ çš„ ref ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™ React.forwardRef å‡½æ•°ä¸­çš„æ¸²æŸ“å‡½æ•°ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>FancyInput</span> <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>inputRef</span>} /&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() =&gt; <span style=color:#a6e22e>inputRef</span>.<span style=color:#a6e22e>current</span>.<span style=color:#a6e22e>focus</span>()}&gt;<span style=color:#a6e22e>focus</span>&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=createhandle-æ¡ä»¶æ‰§è¡Œ>createHandle æ¡ä»¶æ‰§è¡Œ
<a class=heading-link href=#createhandle-%e6%9d%a1%e4%bb%b6%e6%89%a7%e8%a1%8c><i class="fa fa-link" aria-hidden=true></i></a></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ç»„å»ºé‡æ–°æ¸²æŸ“å <code>useImperativeHandle</code> ä¸­çš„ <code>createHandle</code> å‡ä¼šæ‰§è¡Œï¼Œä¸ºäº†ä¸å¿…è¦çš„æ€§èƒ½æŸå¤±æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¾èµ–é¿å…ä¸å¿…è¦çš„æ€§èƒ½æŸå¤±</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>useImperativeHandle</span>(<span style=color:#a6e22e>ref</span>, () =&gt; ({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>count</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>focus</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>inputRef</span>.<span style=color:#a6e22e>current</span>.<span style=color:#a6e22e>focus</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}), [<span style=color:#a6e22e>count</span>]);
</span></span></code></pre></div><h3 id=æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹
<a class=heading-link href=#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9><i class="fa fa-link" aria-hidden=true></i></a></h3><ul><li><strong>ä¸è¦æ»¥ç”¨ ref</strong>ã€‚ ä½ åº”å½“ä»…åœ¨ä½ æ²¡æ³•é€šè¿‡ prop æ¥è¡¨è¾¾ å‘½ä»¤å¼ è¡Œä¸ºçš„æ—¶å€™æ‰ä½¿ç”¨ refï¼šä¾‹å¦‚ï¼Œæ»šåŠ¨åˆ°æŒ‡å®šèŠ‚ç‚¹ã€èšç„¦æŸä¸ªèŠ‚ç‚¹ã€è§¦å‘ä¸€æ¬¡åŠ¨ç”»ï¼Œä»¥åŠé€‰æ‹©æ–‡æœ¬ç­‰ç­‰</li><li><strong>å¦‚æœå¯ä»¥é€šè¿‡ prop å®ç°ï¼Œé‚£å°±ä¸åº”è¯¥ä½¿ç”¨ ref</strong>ï¼šä½ ä¸åº”è¯¥ä»ä¸€ä¸ª Model ç»„ä»¶æš´éœ²å‡º {open, close} è¿™æ ·çš„å‘½ä»¤å¼å¥æŸ„ï¼Œæœ€å¥½æ˜¯åƒ <modal isopen={isOpen}>è¿™æ ·ï¼Œå°† isOpen ä½œä¸ºä¸€ä¸ª propã€‚å‰¯ä½œç”¨ å¯ä»¥å¸®ä½ é€šè¿‡ prop æ¥æš´éœ²ä¸€äº›å‘½ä»¤å¼çš„è¡Œä¸ºã€‚</li></ul><div id=cusdis_thread data-host=https://cusdis.com data-app-id=c2b015f9-9a4b-4997-b66f-f9c6ca26ebdd data-page-id=e7f74755385b2fcc3a192fa47911c8a3 data-page-url=https://chenkai.life/react/react-hooks-ref/ data-page-title="React Hook Ref" data-iframe=/js/cusdis/iframe.umd.js data-style=/js/cusdis/style.css></div></article></section></div></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script>
<script src=/js/custom.js></script>
<script src=/js/font.min.js></script></body><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script></html>