<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=theme-color content="#ffffff"><meta name=color-scheme content="light dark"><meta name=description content="转载自https://www.atlassian.com/git/tutorials/git-submodule
 Git子模块(git submodule)允许您将git存储库作为另一个git存储库的子目录。 Git子模块只是对特定时间快照中另一个存储库的引用。 Git子模块使Git存储库能够合并和跟踪外部代码的版本历史记录。
如果您需要对外部依赖项进行严格的版本管理，那么使用 git 子模块是有意义的。
什么是 Git子模块    通常，代码存储库将依赖于外部代码。可以通过几种不同的方式合并此外部代码。外部代码可以直接复制粘贴到主存储库中。这种方法的缺点是会丢失对外部存储库的任何上游更改。合并外部代码的另一种方法是使用语言的包管理系统，如 Ruby Gems 或 NPM。这种方法的缺点是需要在部署源代码的所有位置进行安装和版本管理。这两种建议的合并方法都不能跟踪对外部存储库的编辑和更改。
git 子模块是宿主 git 存储库中的一条记录，它指向另一个外部存储库中的特定提交。子模块非常静态，只跟踪特定的提交。子模块不跟踪 git refs 或分支，并且不会在主机存储库更新时自动更新。将子模块添加到存储库时，将创建一个新的 .gitmodules 文件。 .gitmodules 文件包含有关子模块项目的 URL 和本地目录之间映射的元数据。如果主机存储库有多个子模块，则 .gitmodules 文件将为每个子模块提供一个条目.
Add git submodule    The git submodule add is used to add a new submodule to an existing repository. The following is an example that creates an empty repo and explores git submodules."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Git 子模块"><meta name=twitter:description content="转载自https://www.atlassian.com/git/tutorials/git-submodule
 Git子模块(git submodule)允许您将git存储库作为另一个git存储库的子目录。 Git子模块只是对特定时间快照中另一个存储库的引用。 Git子模块使Git存储库能够合并和跟踪外部代码的版本历史记录。
如果您需要对外部依赖项进行严格的版本管理，那么使用 git 子模块是有意义的。
什么是 Git子模块    通常，代码存储库将依赖于外部代码。可以通过几种不同的方式合并此外部代码。外部代码可以直接复制粘贴到主存储库中。这种方法的缺点是会丢失对外部存储库的任何上游更改。合并外部代码的另一种方法是使用语言的包管理系统，如 Ruby Gems 或 NPM。这种方法的缺点是需要在部署源代码的所有位置进行安装和版本管理。这两种建议的合并方法都不能跟踪对外部存储库的编辑和更改。
git 子模块是宿主 git 存储库中的一条记录，它指向另一个外部存储库中的特定提交。子模块非常静态，只跟踪特定的提交。子模块不跟踪 git refs 或分支，并且不会在主机存储库更新时自动更新。将子模块添加到存储库时，将创建一个新的 .gitmodules 文件。 .gitmodules 文件包含有关子模块项目的 URL 和本地目录之间映射的元数据。如果主机存储库有多个子模块，则 .gitmodules 文件将为每个子模块提供一个条目.
Add git submodule    The git submodule add is used to add a new submodule to an existing repository. The following is an example that creates an empty repo and explores git submodules."><meta property="og:title" content="Git 子模块"><meta property="og:description" content="转载自https://www.atlassian.com/git/tutorials/git-submodule
 Git子模块(git submodule)允许您将git存储库作为另一个git存储库的子目录。 Git子模块只是对特定时间快照中另一个存储库的引用。 Git子模块使Git存储库能够合并和跟踪外部代码的版本历史记录。
如果您需要对外部依赖项进行严格的版本管理，那么使用 git 子模块是有意义的。
什么是 Git子模块    通常，代码存储库将依赖于外部代码。可以通过几种不同的方式合并此外部代码。外部代码可以直接复制粘贴到主存储库中。这种方法的缺点是会丢失对外部存储库的任何上游更改。合并外部代码的另一种方法是使用语言的包管理系统，如 Ruby Gems 或 NPM。这种方法的缺点是需要在部署源代码的所有位置进行安装和版本管理。这两种建议的合并方法都不能跟踪对外部存储库的编辑和更改。
git 子模块是宿主 git 存储库中的一条记录，它指向另一个外部存储库中的特定提交。子模块非常静态，只跟踪特定的提交。子模块不跟踪 git refs 或分支，并且不会在主机存储库更新时自动更新。将子模块添加到存储库时，将创建一个新的 .gitmodules 文件。 .gitmodules 文件包含有关子模块项目的 URL 和本地目录之间映射的元数据。如果主机存储库有多个子模块，则 .gitmodules 文件将为每个子模块提供一个条目.
Add git submodule    The git submodule add is used to add a new submodule to an existing repository. The following is an example that creates an empty repo and explores git submodules."><meta property="og:type" content="article"><meta property="og:url" content="https://chenkai.life/tools/git_submodule/"><meta property="article:published_time" content="2021-07-14T18:10:58+08:00"><meta property="article:modified_time" content="2021-07-14T18:10:58+08:00"><title>Git 子模块 · CK's Blog</title><link rel=canonical href=https://chenkai.life/tools/git_submodule/><link rel=stylesheet href=/css/coder.min.0e0f0ac9929898ae6625ca3789e3f9e2e630ead0a5e0f1fe96c1ba7d8774342c.css integrity="sha256-Dg8KyZKYmK5mJco3ieP54uYw6tCl4PH+lsG6fYd0NCw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.d8f89ef09509afb63b9b2595ee174e53cc51ce02a6f6a2179e1621f9389e4340.css integrity="sha256-2Pie8JUJr7Y7myWV7hdOU8xRzgKm9qIXnhYh+TieQ0A=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/custom.min.f7409395122caf2e97f6cd5fede3e37a895c29399061626e755affd90b7c9906.css integrity="sha256-90CTlRIsry6X9s1f7ePjeolcKTmQYWJudVr/2Qt8mQY=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/favicon.ico><link rel=apple-touch-icon type=image/png sizes=256x256 href=/images/favicon-512x512.png><meta name=generator content="Hugo 0.72.0"><link rel=manifest href=/manifest.webmanifest></head><body class="preload-transitions colorscheme-auto"><div class=float-container><span id=dark-mode-toggle class=colorscheme-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-anheimoshi"/></svg></span></div><details id=table-of-contents-wapper><summary><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></summary><nav id=TableOfContents><ul><li><ul><li><a href=#什么是-git子模块>什么是 Git子模块</a><ul><li><a href=#add-git-submodule>Add git submodule</a></li><li><a href=#cloning-git-submodules>Cloning git submodules</a></li><li><a href=#git-submodule-init>Git submodule Init</a></li><li><a href=#submodule-workflows>Submodule workflows</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></nav></details><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>CK's Blog</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/>Home</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/index.xml>RSS</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item id=search-content><input class=search-int type=text placeholder=Search>
<button class=search-btn data-type=github>GitHub</button>
<button class=search-btn data-type=google>Google</button></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=https://chenkai.life/tools/git_submodule/>Git 子模块</a></h1><div class=edit-link style=float:right;color:#0366d6><a class=title rel=noopener target=_blank href=https://github.com/chenkai0520/chenkai0520.github.io/edit/main/content/tools/git_submodule.md>编辑</a></div></header><div class=post-meta><div class=date><span class=posted-on><svg class="icon" aria-hidden="true"><use xlink:href="#icon-date"/></svg><time datetime=2021-07-14T18:10:58+08:00>2021-07-14</time></span></div><div class=tags><svg class="icon" aria-hidden="true"><use xlink:href="#icon-biaoqian"/></svg><span class=tag><a href=/tags/tool/>tool</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/git/>git</a></span></div></div><blockquote><p>转载自<a href=https://www.atlassian.com/git/tutorials/git-submodule>https://www.atlassian.com/git/tutorials/git-submodule</a></p></blockquote><p>Git子模块(<code>git submodule</code>)允许您将git存储库作为另一个git存储库的子目录。 Git子模块只是对特定时间快照中另一个存储库的引用。 Git子模块使Git存储库能够合并和跟踪外部代码的版本历史记录。</p><p>如果您需要对外部依赖项进行严格的版本管理，那么使用 git 子模块是有意义的。</p><h2 id=什么是-git子模块>什么是 Git子模块
<a class=heading-link href=#%e4%bb%80%e4%b9%88%e6%98%af-git%e5%ad%90%e6%a8%a1%e5%9d%97><i class="fa fa-link" aria-hidden=true></i></a></h2><p>通常，代码存储库将依赖于外部代码。可以通过几种不同的方式合并此外部代码。外部代码可以直接复制粘贴到主存储库中。这种方法的缺点是会丢失对外部存储库的任何上游更改。合并外部代码的另一种方法是使用语言的包管理系统，如 Ruby Gems 或 NPM。这种方法的缺点是需要在部署源代码的所有位置进行安装和版本管理。这两种建议的合并方法都不能跟踪对外部存储库的编辑和更改。</p><p>git 子模块是宿主 git 存储库中的一条记录，它指向另一个外部存储库中的特定提交。子模块非常静态，只跟踪特定的提交。子模块不跟踪 git refs 或分支，并且不会在主机存储库更新时自动更新。将子模块添加到存储库时，将创建一个新的 .gitmodules 文件。 .gitmodules 文件包含有关子模块项目的 URL 和本地目录之间映射的元数据。如果主机存储库有多个子模块，则 .gitmodules 文件将为每个子模块提供一个条目.</p><h3 id=add-git-submodule>Add git submodule
<a class=heading-link href=#add-git-submodule><i class="fa fa-link" aria-hidden=true></i></a></h3><p>The <code>git submodule add</code> is used to add a new submodule to an existing repository. The following is an example that creates an empty repo and explores git submodules.</p><pre><code>$ mkdir git-submodule-demo
$ cd git-submodule-demo/
$ git init
Initialized empty Git repository in /Users/atlassian/git-submodule-demo/.git/
</code></pre><p>This sequence of commands will create a new directory <code>git-submodule-demo</code>, enter that directory, and initialize it as a new repository. Next we will add a submodule to this fresh new repo.</p><pre><code>$ git submodule add https://bitbucket.org/jaredw/awesomelibrary
Cloning into '/Users/atlassian/git-submodule-demo/awesomelibrary'...
remote: Counting objects: 8, done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 8 (delta 1), reused 0 (delta 0)
Unpacking objects: 100% (8/8), done.
</code></pre><p>The <code>git submodule add</code> command takes a URL parameter that points to a git repository. Here we have added the <code>awesomelibrary</code> as a submodule. Git will immediately clone the submodule. We can now review the current state of the repository using <code>git status</code>&mldr;</p><pre><code>$ git status
On branch main

No commits yet

Changes to be committed:
  (use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)

 new file:   .gitmodules
 new file:   awesomelibrary
</code></pre><p>There are now two new files in the repository <code>.gitmodules</code> and the <code>awesomelibrary</code> directory. Looking at the contents of <code>.gitmodules</code> shows the new submodule mapping</p><pre><code>[submodule &quot;awesomelibrary&quot;]
 path = awesomelibrary
 url = https://bitbucket.org/jaredw/awesomelibrary
$ git add .gitmodules awesomelibrary/
$ git commit -m &quot;added submodule&quot;
[main (root-commit) d5002d0] added submodule
 2 files changed, 4 insertions(+)
 create mode 100644 .gitmodules
 create mode 160000 awesomelibrary
</code></pre><h3 id=cloning-git-submodules>Cloning git submodules
<a class=heading-link href=#cloning-git-submodules><i class="fa fa-link" aria-hidden=true></i></a></h3><pre><code>git clone /url/to/repo/with/submodules
git submodule init
git submodule update
</code></pre><h3 id=git-submodule-init>Git submodule Init
<a class=heading-link href=#git-submodule-init><i class="fa fa-link" aria-hidden=true></i></a></h3><p>The default behavior of <code>git submodule init</code> is to copy the mapping from the <code>.gitmodules</code> file into the local <code>./.git/config</code> file. This may seem redundant and lead to questioning <code>git submodule init</code> usefulness. <code>git submodule init</code> has extend behavior in which it accepts a list of explicit module names. This enables a workflow of activating only specific submodules that are needed for work on the repository. This can be helpful if there are many submodules in a repo but they don&rsquo;t all need to be fetched for work you are doing.</p><h3 id=submodule-workflows>Submodule workflows
<a class=heading-link href=#submodule-workflows><i class="fa fa-link" aria-hidden=true></i></a></h3><p>Once submodules are properly initialized and updated within a parent repository they can be utilized exactly like stand-alone repositories. This means that submodules have their own branches and history. When making changes to a submodule it is important to publish submodule changes and then update the parent repositories reference to the submodule. Let’s continue with the <code>awesomelibrary</code> example and make some changes:</p><pre><code>$ cd awesomelibrary/
$ git checkout -b new_awesome
Switched to a new branch 'new_awesome'
$ echo &quot;new awesome file&quot; &gt; new_awesome.txt
$ git status
On branch new_awesome
Untracked files:
  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)

 new_awesome.txt

nothing added to commit but untracked files present (use &quot;git add&quot; to track)
$ git add new_awesome.txt
$ git commit -m &quot;added new awesome textfile&quot;
[new_awesome 0567ce8] added new awesome textfile
 1 file changed, 1 insertion(+)
 create mode 100644 new_awesome.txt
$ git branch
  main
* new_awesome
</code></pre><p>Here we have changed directory to the awesomelibrary submodule. We have created a new text file <code>new_awesome.txt</code> with some content and we have added and committed this new file to the submodule. Now let us change directories back to the parent repository and review the current state of the parent repo.</p><pre><code>$ cd ..
$ git status
On branch main
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

 modified:   awesomelibrary (new commits)

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</code></pre><p>Executing <code>git status</code> shows us that the parent repository is aware of the new commits to the <code>awesomelibrary</code> submodule. It doesn&rsquo;t go into detail about the specific updates because that is the submodule repositories responsibility. The parent repository is only concerned with pinning the submodule to a commit. Now we can update the parent repository again by doing a <code>git add</code> and <code>git commit</code> on the submodule. This will put everything into a good state with the local content. If you are working in a team environment it is critical that you then <code>git push</code> the submodule updates, and the parent repository updates.</p><p>When working with submodules, a common pattern of confusion and error is forgetting to push updates for remote users. If we revisit the <code>awesomelibrary</code> work we just did, we pushed only the updates to the parent repository. Another developer would go to pull the latest parent repository and it would be pointing at a commit of <code>awesomelibrary</code> that they were unable to pull because we had forgotten to push the submodule. This would break the remote developers local repo. To avoid this failure scenario make sure to always commit and push the submodule and parent repository.</p><h2 id=conclusion>Conclusion
<a class=heading-link href=#conclusion><i class="fa fa-link" aria-hidden=true></i></a></h2><p>Git submodules are a powerful way to leverage git as an external dependency management tool. Weigh the pros and cons of git submodules before using them, as they are an advanced feature and may take a learning curve for team members to adopt.</p><div id=cusdis_thread data-host=https://cusdis.com data-app-id=c2b015f9-9a4b-4997-b66f-f9c6ca26ebdd data-page-id=6b44463ef6317ed9a6ab104534e61277 data-page-url=https://chenkai.life/tools/git_submodule/ data-page-title="Git 子模块" data-iframe=/js/cusdis/iframe.umd.js data-style=/js/cusdis/style.css></div></article></section></div></main><script src=/js/coder.min.a350362441276ec5c1671926420497bb8e52b63ead1d51d3c9bc4342d0039526.js integrity="sha256-o1A2JEEnbsXBZxkmQgSXu45Stj6tHVHTybxDQtADlSY="></script><script src=/js/custom.js></script><script src=/js/font.min.js></script></body><script>if('serviceWorker'in navigator){navigator.serviceWorker.register('/service-worker.js');}</script></html>