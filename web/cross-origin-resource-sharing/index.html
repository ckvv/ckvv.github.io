<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=theme-color content="#ffffff"><meta name=color-scheme content="light dark"><meta name=description content="转载自 web.dev
浏览器的同源策略阻止了浏览器读取不同源的资源。这种机制能够阻止恶意网站读取另一个网站的数据，但也会阻碍合法使用。如果您希望获取其他国家的天气数据该怎么办？
在现代网络应用程序中，应用程序通常希望从不同源获取资源。例如，您想要从不同的域读取 JSON 数据或者将另一个网站的图像加载到<canvas>元素中。
换句话说，部分公共资源应该可以供任何人读取，但同源策略会阻碍这一点。开发者使用过诸如 JSONP 之类的变通方法，但跨域资源共享 (CORS) 能够通过标准方式修复此问题。
启用 CORS 可以让服务器告知浏览器自己已获许使用其他源。
资源请求在网络上是如何运作的？ # 图：客户端请求和服务器响应图示
浏览器和服务器可以使用超文本传输协议 (HTTP) 来通过网络交换数据。HTTP 定义了请求者和响应者之间的通信规则，其中包括获取资源所需的信息。
HTTP 标头用于协商客户端和服务器之间的消息交换类型，并用于确定访问权限。浏览器的请求和服务器的响应消息都分为两部分：标头和主体：
标头 # 包含消息的相关信息，例如消息类型或消息编码。标头可以包括各种信息，这些信息通过键值对表示。请求头和响应头包含不同的信息。
请务必注意，标头不能包含评论。
请求头示例
Accept: text/html Cookie: Version=1 以上内容相当于表示“我希望收到 HTML 的响应。这是我的一个 cookie。”
响应头示例
Content-Encoding: gzip Cache-Control: no-store 以上内容相当于表示“数据是用 gzip 编码的。请不要将其缓存。”
主体 # 消息本身。主体可以是纯文本、二进制图像、JSON、HTML 等。
CORS 是如何运作的？ # 请记住，同源策略会让浏览器阻止跨域请求。当您想从不同的源获取公共资源时，提供资源的服务器需要告知浏览器“发出该请求的这个源可以访问我的资源”。浏览器会记住这一点，并允许跨域资源共享。
第一步：客户端（浏览器）请求 # 当浏览器发出跨域请求时，该浏览器会添加一个包含当前源（协议、主机和端口）的Origin标头。
第二步：服务器响应 # 在服务器端，当服务器看到该标头并想要允许访问时，就需要在响应中加入一个Access-Control-Allow-Origin标头来指定请求源（或加入*来允许任何源。）
第三步：浏览器接收响应 # 当浏览器看到带有相应Access-Control-Allow-Origin标头的响应时，即允许与客户端网站共享响应数据。
查看 CORS 的实际应用 # 这是一个使用 Express 的小型网络服务器。
第一个端点（第 8 行）没有设置任何响应头，该端点只会在响应中发送一个文件。"><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="跨域资源共享 (CORS)"><meta name=twitter:description content="转载自 web.dev
浏览器的同源策略阻止了浏览器读取不同源的资源。这种机制能够阻止恶意网站读取另一个网站的数据，但也会阻碍合法使用。如果您希望获取其他国家的天气数据该怎么办？
在现代网络应用程序中，应用程序通常希望从不同源获取资源。例如，您想要从不同的域读取 JSON 数据或者将另一个网站的图像加载到<canvas>元素中。
换句话说，部分公共资源应该可以供任何人读取，但同源策略会阻碍这一点。开发者使用过诸如 JSONP 之类的变通方法，但跨域资源共享 (CORS) 能够通过标准方式修复此问题。
启用 CORS 可以让服务器告知浏览器自己已获许使用其他源。
资源请求在网络上是如何运作的？ # 图：客户端请求和服务器响应图示
浏览器和服务器可以使用超文本传输协议 (HTTP) 来通过网络交换数据。HTTP 定义了请求者和响应者之间的通信规则，其中包括获取资源所需的信息。
HTTP 标头用于协商客户端和服务器之间的消息交换类型，并用于确定访问权限。浏览器的请求和服务器的响应消息都分为两部分：标头和主体：
标头 # 包含消息的相关信息，例如消息类型或消息编码。标头可以包括各种信息，这些信息通过键值对表示。请求头和响应头包含不同的信息。
请务必注意，标头不能包含评论。
请求头示例
Accept: text/html Cookie: Version=1 以上内容相当于表示“我希望收到 HTML 的响应。这是我的一个 cookie。”
响应头示例
Content-Encoding: gzip Cache-Control: no-store 以上内容相当于表示“数据是用 gzip 编码的。请不要将其缓存。”
主体 # 消息本身。主体可以是纯文本、二进制图像、JSON、HTML 等。
CORS 是如何运作的？ # 请记住，同源策略会让浏览器阻止跨域请求。当您想从不同的源获取公共资源时，提供资源的服务器需要告知浏览器“发出该请求的这个源可以访问我的资源”。浏览器会记住这一点，并允许跨域资源共享。
第一步：客户端（浏览器）请求 # 当浏览器发出跨域请求时，该浏览器会添加一个包含当前源（协议、主机和端口）的Origin标头。
第二步：服务器响应 # 在服务器端，当服务器看到该标头并想要允许访问时，就需要在响应中加入一个Access-Control-Allow-Origin标头来指定请求源（或加入*来允许任何源。）
第三步：浏览器接收响应 # 当浏览器看到带有相应Access-Control-Allow-Origin标头的响应时，即允许与客户端网站共享响应数据。
查看 CORS 的实际应用 # 这是一个使用 Express 的小型网络服务器。
第一个端点（第 8 行）没有设置任何响应头，该端点只会在响应中发送一个文件。"><meta property="og:title" content="跨域资源共享 (CORS)"><meta property="og:description" content="转载自 web.dev
浏览器的同源策略阻止了浏览器读取不同源的资源。这种机制能够阻止恶意网站读取另一个网站的数据，但也会阻碍合法使用。如果您希望获取其他国家的天气数据该怎么办？
在现代网络应用程序中，应用程序通常希望从不同源获取资源。例如，您想要从不同的域读取 JSON 数据或者将另一个网站的图像加载到<canvas>元素中。
换句话说，部分公共资源应该可以供任何人读取，但同源策略会阻碍这一点。开发者使用过诸如 JSONP 之类的变通方法，但跨域资源共享 (CORS) 能够通过标准方式修复此问题。
启用 CORS 可以让服务器告知浏览器自己已获许使用其他源。
资源请求在网络上是如何运作的？ # 图：客户端请求和服务器响应图示
浏览器和服务器可以使用超文本传输协议 (HTTP) 来通过网络交换数据。HTTP 定义了请求者和响应者之间的通信规则，其中包括获取资源所需的信息。
HTTP 标头用于协商客户端和服务器之间的消息交换类型，并用于确定访问权限。浏览器的请求和服务器的响应消息都分为两部分：标头和主体：
标头 # 包含消息的相关信息，例如消息类型或消息编码。标头可以包括各种信息，这些信息通过键值对表示。请求头和响应头包含不同的信息。
请务必注意，标头不能包含评论。
请求头示例
Accept: text/html Cookie: Version=1 以上内容相当于表示“我希望收到 HTML 的响应。这是我的一个 cookie。”
响应头示例
Content-Encoding: gzip Cache-Control: no-store 以上内容相当于表示“数据是用 gzip 编码的。请不要将其缓存。”
主体 # 消息本身。主体可以是纯文本、二进制图像、JSON、HTML 等。
CORS 是如何运作的？ # 请记住，同源策略会让浏览器阻止跨域请求。当您想从不同的源获取公共资源时，提供资源的服务器需要告知浏览器“发出该请求的这个源可以访问我的资源”。浏览器会记住这一点，并允许跨域资源共享。
第一步：客户端（浏览器）请求 # 当浏览器发出跨域请求时，该浏览器会添加一个包含当前源（协议、主机和端口）的Origin标头。
第二步：服务器响应 # 在服务器端，当服务器看到该标头并想要允许访问时，就需要在响应中加入一个Access-Control-Allow-Origin标头来指定请求源（或加入*来允许任何源。）
第三步：浏览器接收响应 # 当浏览器看到带有相应Access-Control-Allow-Origin标头的响应时，即允许与客户端网站共享响应数据。
查看 CORS 的实际应用 # 这是一个使用 Express 的小型网络服务器。
第一个端点（第 8 行）没有设置任何响应头，该端点只会在响应中发送一个文件。"><meta property="og:type" content="article"><meta property="og:url" content="https://chenkai.life/web/cross-origin-resource-sharing/"><meta property="article:section" content="web"><meta property="article:published_time" content="2022-02-09T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-05T10:50:03+08:00"><title>跨域资源共享 (CORS) · CK's Blog</title><link rel=canonical href=https://chenkai.life/web/cross-origin-resource-sharing/><link rel=stylesheet href=/css/coder.min.0e0f0ac9929898ae6625ca3789e3f9e2e630ead0a5e0f1fe96c1ba7d8774342c.css integrity="sha256-Dg8KyZKYmK5mJco3ieP54uYw6tCl4PH+lsG6fYd0NCw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.d8f89ef09509afb63b9b2595ee174e53cc51ce02a6f6a2179e1621f9389e4340.css integrity="sha256-2Pie8JUJr7Y7myWV7hdOU8xRzgKm9qIXnhYh+TieQ0A=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/custom.min.d12542c00c198b6a07ca9ea5981102805aecab0f5dfd5e3273d8c179088712c4.css integrity="sha256-0SVCwAwZi2oHyp6lmBECgFrsqw9d/V4yc9jBeQiHEsQ=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/favicon.ico><link rel=apple-touch-icon type=image/png sizes=256x256 href=/images/favicon-512x512.png><meta name=generator content="Hugo 0.119.0"><link rel=manifest href=/manifest.webmanifest></head><body class="preload-transitions colorscheme-auto"><div class=float-container><span id=dark-mode-toggle class=colorscheme-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-anheimoshi"/></svg></span></div><details id=table-of-contents-wapper><summary><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></summary></details><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>CK's Blog</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/>Home</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/marks/>Marks</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/ckvv/ckvv.github.io/tree/main/content>Create</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item id=search-content><input class=search-int type=text placeholder=Search>
<button class=search-btn data-type=github>GitHub</button>
<button class=search-btn data-type=google>Google</button></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=https://chenkai.life/web/cross-origin-resource-sharing/>跨域资源共享 (CORS)</a></h1><div class=edit-link style=float:right;color:#0366d6><a class=title rel=noopener target=_blank href=https://github.com/ckvv/ckvv.github.io/edit/main/content/web/cross-origin-resource-sharing.md>编辑</a></div></header><div class=post-meta><div class=date><span class=posted-on><svg class="icon" aria-hidden="true"><use xlink:href="#icon-date"/></svg><time datetime=2022-02-09T00:00:00Z>2022-02-09</time></span></div><div class=tags><svg class="icon" aria-hidden="true"><use xlink:href="#icon-biaoqian"/></svg><span class=tag><a href=/tags/web/>Web</a></span></div></div><p>转载自 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools">web.dev</a></p><p>浏览器的同源策略阻止了浏览器读取不同源的资源。这种机制能够阻止恶意网站读取另一个网站的数据，但也会阻碍合法使用。如果您希望获取其他国家的天气数据该怎么办？</p><p>在现代网络应用程序中，应用程序通常希望从不同源获取资源。例如，您想要从不同的域读取 JSON 数据或者将另一个网站的图像加载到<code>&lt;canvas></code>元素中。</p><p>换句话说，部分<strong>公共资源</strong>应该可以供任何人读取，但同源策略会阻碍这一点。开发者使用过诸如 <a href=https://stackoverflow.com/questions/2067472/what-is-jsonp-all-about>JSONP</a> 之类的变通方法，但<strong>跨域资源共享 (CORS)</strong> 能够通过标准方式修复此问题。</p><p>启用 <strong>CORS</strong> 可以让服务器告知浏览器自己已获许使用其他源。</p><h2 id=资源请求在网络上是如何运作的-httpswebdevcross-origin-resource-sharingutm_sourcedevtools>资源请求在网络上是如何运作的？ <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#">#</a>
<a class=heading-link href=#%e8%b5%84%e6%ba%90%e8%af%b7%e6%b1%82%e5%9c%a8%e7%bd%91%e7%bb%9c%e4%b8%8a%e6%98%af%e5%a6%82%e4%bd%95%e8%bf%90%e4%bd%9c%e7%9a%84-httpswebdevcross-origin-resource-sharingutm_sourcedevtools><i class="fa fa-link" aria-hidden=true></i></a></h2><p><img src="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/8J6A0Bk5YXdvyoj8HVzs.png?auto=format" alt=请求和响应>图：客户端请求和服务器响应图示</p><p>浏览器和服务器可以使用<strong>超文本传输协议</strong> (HTTP) 来通过网络交换数据。HTTP 定义了请求者和响应者之间的通信规则，其中包括获取资源所需的信息。</p><p>HTTP 标头用于协商客户端和服务器之间的消息交换类型，并用于确定访问权限。浏览器的请求和服务器的响应消息都分为两部分：<strong>标头</strong>和<strong>主体</strong>：</p><h3 id=标头-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-2>标头 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#-2">#</a>
<a class=heading-link href=#%e6%a0%87%e5%a4%b4-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-2><i class="fa fa-link" aria-hidden=true></i></a></h3><p>包含消息的相关信息，例如消息类型或消息编码。标头可以包括<a href=https://en.wikipedia.org/wiki/List_of_HTTP_header_fields>各种信息</a>，这些信息通过键值对表示。请求头和响应头包含不同的信息。</p><p>请务必注意，标头不能包含评论。</p><p><strong>请求头示例</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Accept: text/html
</span></span><span style=display:flex><span>Cookie: Version=1
</span></span></code></pre></div><p>以上内容相当于表示“我希望收到 HTML 的响应。这是我的一个 cookie。”</p><p><strong>响应头示例</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Content-Encoding: gzip
</span></span><span style=display:flex><span>Cache-Control: no-store
</span></span></code></pre></div><p>以上内容相当于表示“数据是用 gzip 编码的。请不要将其缓存。”</p><h3 id=主体-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-3>主体 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#-3">#</a>
<a class=heading-link href=#%e4%b8%bb%e4%bd%93-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-3><i class="fa fa-link" aria-hidden=true></i></a></h3><p>消息本身。主体可以是纯文本、二进制图像、JSON、HTML 等。</p><h2 id=cors-是如何运作的-httpswebdevcross-origin-resource-sharingutm_sourcedevtoolscors>CORS 是如何运作的？ <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#cors">#</a>
<a class=heading-link href=#cors-%e6%98%af%e5%a6%82%e4%bd%95%e8%bf%90%e4%bd%9c%e7%9a%84-httpswebdevcross-origin-resource-sharingutm_sourcedevtoolscors><i class="fa fa-link" aria-hidden=true></i></a></h2><p>请记住，同源策略会让浏览器阻止跨域请求。当您想从不同的源获取公共资源时，提供资源的服务器需要告知浏览器“发出该请求的这个源可以访问我的资源”。浏览器会记住这一点，并允许跨域资源共享。</p><h3 id=第一步客户端浏览器请求-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-4>第一步：客户端（浏览器）请求 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#-4">#</a>
<a class=heading-link href=#%e7%ac%ac%e4%b8%80%e6%ad%a5%e5%ae%a2%e6%88%b7%e7%ab%af%e6%b5%8f%e8%a7%88%e5%99%a8%e8%af%b7%e6%b1%82-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-4><i class="fa fa-link" aria-hidden=true></i></a></h3><p>当浏览器发出跨域请求时，该浏览器会添加一个包含当前源（协议、主机和端口）的<code>Origin</code>标头。</p><h3 id=第二步服务器响应-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-5>第二步：服务器响应 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#-5">#</a>
<a class=heading-link href=#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%93%8d%e5%ba%94-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-5><i class="fa fa-link" aria-hidden=true></i></a></h3><p>在服务器端，当服务器看到该标头并想要允许访问时，就需要在响应中加入一个<code>Access-Control-Allow-Origin</code>标头来指定请求源（或加入<code>*</code>来允许任何源。）</p><h3 id=第三步浏览器接收响应-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-6>第三步：浏览器接收响应 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#-6">#</a>
<a class=heading-link href=#%e7%ac%ac%e4%b8%89%e6%ad%a5%e6%b5%8f%e8%a7%88%e5%99%a8%e6%8e%a5%e6%94%b6%e5%93%8d%e5%ba%94-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-6><i class="fa fa-link" aria-hidden=true></i></a></h3><p>当浏览器看到带有相应<code>Access-Control-Allow-Origin</code>标头的响应时，即允许与客户端网站共享响应数据。</p><h2 id=查看-cors-的实际应用-httpswebdevcross-origin-resource-sharingutm_sourcedevtoolscors-2>查看 CORS 的实际应用 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#cors-2">#</a>
<a class=heading-link href=#%e6%9f%a5%e7%9c%8b-cors-%e7%9a%84%e5%ae%9e%e9%99%85%e5%ba%94%e7%94%a8-httpswebdevcross-origin-resource-sharingutm_sourcedevtoolscors-2><i class="fa fa-link" aria-hidden=true></i></a></h2><p>这是一个使用 Express 的小型网络服务器。</p><iframe allow="camera; clipboard-read; clipboard-write; encrypted-media; geolocation; microphone; midi" loading=lazy src="https://glitch.com/embed/#!/embed/cors-demo?attributionHidden=true&amp;sidebarCollapsed=true&amp;path=server.js&amp;previewSize=100" title="cors-demo on Glitch" style=box-sizing:border-box;border:0;height:480px;width:736px></iframe><p>第一个端点（第 8 行）没有设置任何响应头，该端点只会在响应中发送一个文件。</p><ul><li>Press <code>Control+Shift+J</code> (or <code>Command+Option+J</code> on Mac) to open DevTools. - Press <code>Control+Shift+J</code> (or <code>Command+Option+J</code> on Mac) to open DevTools.</li><li>Click the <strong>Console</strong> tab.</li><li>请尝试以下命令：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#34;https://cors-demo.glitch.me/&#34;</span>, { <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;cors&#34;</span> });
</span></span></code></pre></div><p>您应该会看到一条错误消息：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>请求已被 CORS 策略阻止：所请求的资源上无
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;Access-Control-Allow-Origin&#39;</span>标头。
</span></span></code></pre></div><p>第二个端点（第 13 行）在响应中发送的是相同的文件，但在标头中加入了<code>Access-Control-Allow-Origin: *</code>。请在控制台中尝试：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#34;https://cors-demo.glitch.me/allow-cors&#34;</span>, { <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;cors&#34;</span> });
</span></span></code></pre></div><p>您的此次请求应该不会被阻止。</p><h2 id=通过-cors-共享凭据-httpswebdevcross-origin-resource-sharingutm_sourcedevtoolscors-3>通过 CORS 共享凭据 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#cors-3">#</a>
<a class=heading-link href=#%e9%80%9a%e8%bf%87-cors-%e5%85%b1%e4%ba%ab%e5%87%ad%e6%8d%ae-httpswebdevcross-origin-resource-sharingutm_sourcedevtoolscors-3><i class="fa fa-link" aria-hidden=true></i></a></h2><p>出于隐私原因，CORS 通常用于“匿名请求”，即不识别请求方的请求。如果您想在使用 CORS 时发送 cookie（这样会识别发送者），就需要在请求和响应中添加额外的标头。</p><h3 id=请求-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-7>请求 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#-7">#</a>
<a class=heading-link href=#%e8%af%b7%e6%b1%82-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-7><i class="fa fa-link" aria-hidden=true></i></a></h3><p>请将<code>credentials: 'include'</code>添加到如下所示的获取选项中。该操作将包括请求中的 cookie。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#34;https://example.com&#34;</span>, {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;cors&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>credentials</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;include&#34;</span>,
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=响应-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-8>响应 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#-8">#</a>
<a class=heading-link href=#%e5%93%8d%e5%ba%94-httpswebdevcross-origin-resource-sharingutm_sourcedevtools-8><i class="fa fa-link" aria-hidden=true></i></a></h3><p>必须将<code>Access-Control-Allow-Origin</code>设置给一个特定的源（没有使用<code>*</code>通配符），并且必须将<code>Access-Control-Allow-Credentials</code>设置为<code>true</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>HTTP/1.1 200 OK
</span></span><span style=display:flex><span>Access-Control-Allow-Origin: https://example.com
</span></span><span style=display:flex><span>Access-Control-Allow-Credentials: true
</span></span></code></pre></div><h2 id=复杂-http-调用的预检请求-httpswebdevcross-origin-resource-sharingutm_sourcedevtoolshttp>复杂 HTTP 调用的预检请求 <a href="https://web.dev/cross-origin-resource-sharing/?utm_source=devtools#http">#</a>
<a class=heading-link href=#%e5%a4%8d%e6%9d%82-http-%e8%b0%83%e7%94%a8%e7%9a%84%e9%a2%84%e6%a3%80%e8%af%b7%e6%b1%82-httpswebdevcross-origin-resource-sharingutm_sourcedevtoolshttp><i class="fa fa-link" aria-hidden=true></i></a></h2><p>如果某个网络应用程序需要复杂的 HTTP 请求，那么浏览器会在请求链的前端添加一个**<a href=https://developer.mozilla.org/docs/Web/HTTP/CORS#preflighted_requests>预检请求</a>**。</p><p>CORS 规范将<strong>复杂请求</strong>定义为</p><ul><li>使用除 GET、POST 或 HEAD 以外方法的请求</li><li>包含除<code>Accept</code>、<code>Accept-Language</code>或<code>Content-Language</code>以外标头的请求</li><li>具有除<code>application/x-www-form-urlencoded</code>、<code>multipart/form-data</code>或<code>text/plain</code>以外的<code>Content-Type</code>标头的请求</li></ul><p>浏览器会根据需要创建预检请求。如下所示，该请求是一个<code>OPTIONS</code>请求，会在实际请求消息之前被发送。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>OPTIONS /data HTTP/1.1
</span></span><span style=display:flex><span>Origin: https://example.com
</span></span><span style=display:flex><span>Access-Control-Request-Method: DELETE
</span></span></code></pre></div><p>在服务器端，应用程序在响应预检请求时需要提供程序从该源接受的方法的相关信息。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>HTTP/1.1 200 OK
</span></span><span style=display:flex><span>Access-Control-Allow-Origin: https://example.com
</span></span><span style=display:flex><span>Access-Control-Allow-Methods: GET, DELETE, HEAD, OPTIONS
</span></span></code></pre></div><p>服务器响应还可以包含一个<code>Access-Control-Max-Age</code>标头，用于指定缓存预检结果的持续时间（以秒为单位），这样客户端就无需在每次发送复杂请求时都发出预检请求了。</p><div id=cusdis_thread data-host=https://cusdis.com data-app-id=c2b015f9-9a4b-4997-b66f-f9c6ca26ebdd data-page-id=12af43f34ff7bda37ed9d361151cb4a2 data-page-url=https://chenkai.life/web/cross-origin-resource-sharing/ data-page-title="跨域资源共享 (CORS)" data-iframe=/js/cusdis/iframe.umd.js data-style=/js/cusdis/style.css></div></article></section></div></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script>
<script src=/js/custom.js></script>
<script src=/js/font.min.js></script></body><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script></html>