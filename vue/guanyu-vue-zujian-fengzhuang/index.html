<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=Content-Language content="en"><meta name=theme-color content="#ffffff"><meta name=color-scheme content="light dark"><meta name=description content="在开发Vue项目我们一般使用第三方UI组件库进行开发，如element-plus, @arco-design/web-Vue, naive-ui等, 但是这些组件提供的接口并不一定满足我们的需求，这时我们可以通过对组件库组件的二次封装，来满足我们特殊的需求。 对于封装组件有一个大原则就是我们应该尽量保持原有组件的接口，除了我们需要封装的功能外，我们不应该改变原有组件的接口，即保持原有组件提供的接口如props,events,slots等不变。 为了实现这一原则我们就需要将新组件的接口与旧组件的接口一一对应, 当然我们可以通过在新组件中一一声明对应的接口来实现（或者只实现我们目前需要用到的接口）但这种办法虽然简单但看起来却极其很繁琐, 有没有一种方法可以实现props,events,slots的自动透传呢？
透传 Attribute 我们可以使用一个没有参数的 v-bind来实现props,events的透传， 它会将一个对象的所有属性都作为 attribute 应用到目标元素或组件上, 这在官方文档中有着详细介绍。
<BaseButton v-bind=&#34;$attrs&#34;/> 其中$attrs包含组件可以透传属性的对象, 透传属性包括props,events, class,style,id等。(不包含接收组件显式声明的 props、emits以及slots )
如下,是一个封装el-input的默认可清空的的组件，由于我们已经在defineProps声明过clearable, 所以此时我们需要显性传递clearable属性
<template> <div class=&#34;my-input&#34;> {{ label }} <el-input v-bind=&#34;$attrs&#34; :clearable=&#34;clearable&#34;></el-input> </div> </template> <script setup> defineProps({ label: String, clearable: { type: Boolean, default: true, }, }); </script> 如果我们不希望透传某些属性比如class, 我们可以通过useAttrs来实现
<template> <div class=&#34;my-input&#34;> {{ label }} <el-input v-bind=&#34;filteredAttrs&#34; :clearable=&#34;clearable&#34;></el-input> </div> </template> <script setup> import { computed, useAttrs } from 'Vue'; defineProps({ label: String, clearable: { type: Boolean, default: true, }, }); const attrs = useAttrs(); const filteredAttrs = computed(() => { return { ."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="关于Vue组件二次封装的技巧总结"><meta name=twitter:description content="在开发Vue项目我们一般使用第三方UI组件库进行开发，如element-plus, @arco-design/web-Vue, naive-ui等, 但是这些组件提供的接口并不一定满足我们的需求，这时我们可以通过对组件库组件的二次封装，来满足我们特殊的需求。 对于封装组件有一个大原则就是我们应该尽量保持原有组件的接口，除了我们需要封装的功能外，我们不应该改变原有组件的接口，即保持原有组件提供的接口如props,events,slots等不变。 为了实现这一原则我们就需要将新组件的接口与旧组件的接口一一对应, 当然我们可以通过在新组件中一一声明对应的接口来实现（或者只实现我们目前需要用到的接口）但这种办法虽然简单但看起来却极其很繁琐, 有没有一种方法可以实现props,events,slots的自动透传呢？
透传 Attribute 我们可以使用一个没有参数的 v-bind来实现props,events的透传， 它会将一个对象的所有属性都作为 attribute 应用到目标元素或组件上, 这在官方文档中有着详细介绍。
<BaseButton v-bind=&#34;$attrs&#34;/> 其中$attrs包含组件可以透传属性的对象, 透传属性包括props,events, class,style,id等。(不包含接收组件显式声明的 props、emits以及slots )
如下,是一个封装el-input的默认可清空的的组件，由于我们已经在defineProps声明过clearable, 所以此时我们需要显性传递clearable属性
<template> <div class=&#34;my-input&#34;> {{ label }} <el-input v-bind=&#34;$attrs&#34; :clearable=&#34;clearable&#34;></el-input> </div> </template> <script setup> defineProps({ label: String, clearable: { type: Boolean, default: true, }, }); </script> 如果我们不希望透传某些属性比如class, 我们可以通过useAttrs来实现
<template> <div class=&#34;my-input&#34;> {{ label }} <el-input v-bind=&#34;filteredAttrs&#34; :clearable=&#34;clearable&#34;></el-input> </div> </template> <script setup> import { computed, useAttrs } from 'Vue'; defineProps({ label: String, clearable: { type: Boolean, default: true, }, }); const attrs = useAttrs(); const filteredAttrs = computed(() => { return { ."><meta property="og:title" content="关于Vue组件二次封装的技巧总结"><meta property="og:description" content="在开发Vue项目我们一般使用第三方UI组件库进行开发，如element-plus, @arco-design/web-Vue, naive-ui等, 但是这些组件提供的接口并不一定满足我们的需求，这时我们可以通过对组件库组件的二次封装，来满足我们特殊的需求。 对于封装组件有一个大原则就是我们应该尽量保持原有组件的接口，除了我们需要封装的功能外，我们不应该改变原有组件的接口，即保持原有组件提供的接口如props,events,slots等不变。 为了实现这一原则我们就需要将新组件的接口与旧组件的接口一一对应, 当然我们可以通过在新组件中一一声明对应的接口来实现（或者只实现我们目前需要用到的接口）但这种办法虽然简单但看起来却极其很繁琐, 有没有一种方法可以实现props,events,slots的自动透传呢？
透传 Attribute 我们可以使用一个没有参数的 v-bind来实现props,events的透传， 它会将一个对象的所有属性都作为 attribute 应用到目标元素或组件上, 这在官方文档中有着详细介绍。
<BaseButton v-bind=&#34;$attrs&#34;/> 其中$attrs包含组件可以透传属性的对象, 透传属性包括props,events, class,style,id等。(不包含接收组件显式声明的 props、emits以及slots )
如下,是一个封装el-input的默认可清空的的组件，由于我们已经在defineProps声明过clearable, 所以此时我们需要显性传递clearable属性
<template> <div class=&#34;my-input&#34;> {{ label }} <el-input v-bind=&#34;$attrs&#34; :clearable=&#34;clearable&#34;></el-input> </div> </template> <script setup> defineProps({ label: String, clearable: { type: Boolean, default: true, }, }); </script> 如果我们不希望透传某些属性比如class, 我们可以通过useAttrs来实现
<template> <div class=&#34;my-input&#34;> {{ label }} <el-input v-bind=&#34;filteredAttrs&#34; :clearable=&#34;clearable&#34;></el-input> </div> </template> <script setup> import { computed, useAttrs } from 'Vue'; defineProps({ label: String, clearable: { type: Boolean, default: true, }, }); const attrs = useAttrs(); const filteredAttrs = computed(() => { return { ."><meta property="og:type" content="article"><meta property="og:url" content="https://chenkai.life/vue/guanyu-vue-zujian-fengzhuang/"><meta property="article:section" content="vue"><meta property="article:published_time" content="2022-04-06T00:00:00+00:00"><meta property="article:modified_time" content="2023-12-08T17:25:52+08:00"><title>关于Vue组件二次封装的技巧总结 · CK's Blog
</title><link rel=canonical href=https://chenkai.life/vue/guanyu-vue-zujian-fengzhuang/><link rel=stylesheet href=/css/coder.min.0e0f0ac9929898ae6625ca3789e3f9e2e630ead0a5e0f1fe96c1ba7d8774342c.css integrity="sha256-Dg8KyZKYmK5mJco3ieP54uYw6tCl4PH+lsG6fYd0NCw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.d8f89ef09509afb63b9b2595ee174e53cc51ce02a6f6a2179e1621f9389e4340.css integrity="sha256-2Pie8JUJr7Y7myWV7hdOU8xRzgKm9qIXnhYh+TieQ0A=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/custom.min.d12542c00c198b6a07ca9ea5981102805aecab0f5dfd5e3273d8c179088712c4.css integrity="sha256-0SVCwAwZi2oHyp6lmBECgFrsqw9d/V4yc9jBeQiHEsQ=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/favicon.ico><link rel=apple-touch-icon type=image/png sizes=256x256 href=/images/favicon-512x512.png><meta name=generator content="Hugo 0.121.0"><link rel=manifest href=/manifest.webmanifest></head><body class="preload-transitions colorscheme-auto"><div class=float-container><span id=dark-mode-toggle class=colorscheme-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-anheimoshi"/></svg></span></div><details id=table-of-contents-wapper><summary><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></summary></details><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>CK's Blog
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/>Home</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/marks/>Marks</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/ckvv/ckvv.github.io/tree/main/content>Create</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item id=search-content><input class=search-int type=text placeholder=Search>
<button class=search-btn data-type=github>GitHub</button>
<button class=search-btn data-type=google>Google</button></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=https://chenkai.life/vue/guanyu-vue-zujian-fengzhuang/>关于Vue组件二次封装的技巧总结</a></h1><div class=edit-link style=float:right;color:#0366d6><a class=title rel=noopener target=_blank href=https://github.com/ckvv/ckvv.github.io/edit/main/content/vue/guanyu-vue-zujian-fengzhuang.md>编辑</a></div></header><div class=post-meta><div class=date><span class=posted-on><svg class="icon" aria-hidden="true"><use xlink:href="#icon-date"/></svg><time datetime=2022-04-06T00:00:00Z>2022-04-06</time></span></div><div class=tags><svg class="icon" aria-hidden="true"><use xlink:href="#icon-biaoqian"/></svg><span class=tag><a href=/tags/vue/>Vue</a></span></div></div><p>在开发Vue项目我们一般使用第三方UI组件库进行开发，如<code>element-plus</code>, <code>@arco-design/web-Vue</code>, <code>naive-ui</code>等, 但是这些组件提供的接口并不一定满足我们的需求，这时我们可以通过对组件库组件的二次封装，来满足我们特殊的需求。
对于封装组件有一个大原则就是我们应该尽量保持原有组件的接口，除了我们需要封装的功能外，我们不应该改变原有组件的接口，即保持原有组件提供的接口如<code>props</code>,<code>events</code>,<code>slots</code>等不变。
为了实现这一原则我们就需要将新组件的接口与旧组件的接口一一对应, 当然我们可以通过在新组件中一一声明对应的接口来实现（或者只实现我们目前需要用到的接口）但这种办法虽然简单但看起来却极其很繁琐, 有没有一种方法可以实现<code>props</code>,<code>events</code>,<code>slots</code>的自动透传呢？</p><h2 id=透传-attribute>透传 Attribute
<a class=heading-link href=#%e9%80%8f%e4%bc%a0-attribute><i class="fa fa-link" aria-hidden=true></i></a></h2><p>我们可以使用一个没有参数的 <code>v-bind</code>来实现<code>props</code>,<code>events</code>的透传， 它会将一个对象的所有属性都作为 <code>attribute</code> 应用到目标元素或组件上, 这在<a href=https://vuejs.org/guide/components/attrs.html>官方文档中</a>有着详细介绍。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>BaseButton</span> <span style=color:#a6e22e>v</span><span style=color:#f92672>-bind</span><span style=color:#960050;background-color:#1e0010>=&#34;$</span><span style=color:#a6e22e>attrs</span><span style=color:#960050;background-color:#1e0010>&#34;</span>/&gt;
</span></span></code></pre></div><p>其中<code>$attrs</code>包含组件可以透传属性的对象, 透传属性包括<code>props</code>,<code>events</code>, <code>class</code>,<code>style</code>,<code>id</code>等。(不包含接收组件显式声明的 <code>props</code>、<code>emits</code>以及<code>slots</code> )</p><p>如下,是一个封装<code>el-input</code>的默认可清空的的组件，由于我们已经在<code>defineProps</code>声明过<code>clearable</code>, 所以此时我们需要显性传递<code>clearable</code>属性</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;my-input&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ <span style=color:#a6e22e>label</span> }}
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>el-input</span> <span style=color:#f92672>v-bind</span><span style=color:#e6db74>=&#34;$attrs&#34; </span><span style=color:#f92672>:clearable</span><span style=color:#e6db74>=&#34;clearable&#34;</span>&gt;<span style=color:#960050;background-color:#1e0010>&lt;/</span><span style=color:#a6e22e>el</span><span style=color:#f92672>-input</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>setup</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>defineProps</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>clearable</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> Boolean,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>如果我们不希望透传某些属性比如<code>class</code>, 我们可以通过<code>useAttrs</code>来实现</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;my-input&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ <span style=color:#a6e22e>label</span> }}
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>el-input</span> <span style=color:#f92672>v-bind</span><span style=color:#e6db74>=&#34;filteredAttrs&#34; </span><span style=color:#f92672>:clearable</span><span style=color:#e6db74>=&#34;clearable&#34;</span>&gt;<span style=color:#960050;background-color:#1e0010>&lt;/</span><span style=color:#a6e22e>el</span><span style=color:#f92672>-input</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>setup</span>&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>computed</span>, <span style=color:#a6e22e>useAttrs</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;Vue&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>defineProps</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>clearable</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> Boolean,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>attrs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useAttrs</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>filteredAttrs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> { ...<span style=color:#a6e22e>attrs</span>, <span style=color:#66d9ef>class</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>undefined</span> };
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>上述封装的组件还有个缺点, 就是我们将无法使用<code>el-input</code>本身提供的<code>slot</code>,下面我们就来实现一个可以透传 <code>slot</code>的组件</p><h2 id=透传-slot>透传 slot
<a class=heading-link href=#%e9%80%8f%e4%bc%a0-slot><i class="fa fa-link" aria-hidden=true></i></a></h2><p>slot可以通过下面这种方式透传的</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span><span style=color:#75715e>&lt;!--</span> <span style=color:#a6e22e>在组件中创建新的对应名称的插槽</span> <span style=color:#f92672>--&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>template</span> <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>slotName</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!--</span> <span style=color:#a6e22e>在插槽内部使用对应名称的插槽</span> <span style=color:#f92672>--&gt;</span>
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>slot</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slotName&#34;</span> /&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span></code></pre></div><h3 id=普通slot>普通slot
<a class=heading-link href=#%e6%99%ae%e9%80%9aslot><i class="fa fa-link" aria-hidden=true></i></a></h3><p>如果透传的slot比较少，我们可以通过在封装组件内部定义并使用插槽<code>&lt;template v-slot:slotName>&lt;slot name="slotName" />&lt;/template></code>来透传插槽</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>template</span> <span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>slotName</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>slot</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slotName&#34;</span> /&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span></code></pre></div><h3 id=动态插槽名>动态插槽名
<a class=heading-link href=#%e5%8a%a8%e6%80%81%e6%8f%92%e6%a7%bd%e5%90%8d><i class="fa fa-link" aria-hidden=true></i></a></h3><p>如果需要透传的<code>slot</code>不固定或者较多，我们可以通过动态插槽名称透传</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>template</span> <span style=color:#960050;background-color:#1e0010>#[</span><span style=color:#a6e22e>slotName</span><span style=color:#960050;background-color:#1e0010>]</span> <span style=color:#a6e22e>v</span><span style=color:#f92672>-for</span><span style=color:#960050;background-color:#1e0010>=&#34;(</span><span style=color:#a6e22e>slot</span><span style=color:#960050;background-color:#1e0010>,</span> <span style=color:#a6e22e>slotName</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#a6e22e>in</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>slots</span><span style=color:#960050;background-color:#1e0010>&#34;</span> &gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>slot</span> <span style=color:#f92672>:name</span><span style=color:#e6db74>=&#34;slotName&#34;</span> /&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span></code></pre></div><p>如下是一个透传的slot的<code>el-input</code>组件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;my-input&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ <span style=color:#a6e22e>label</span> }}
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>el-input</span> <span style=color:#f92672>v-bind</span><span style=color:#e6db74>=&#34;$attrs&#34; </span><span style=color:#f92672>:clearable</span><span style=color:#e6db74>=&#34;clearable&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>template</span> <span style=color:#960050;background-color:#1e0010>#[</span><span style=color:#a6e22e>slotName</span><span style=color:#960050;background-color:#1e0010>]</span> <span style=color:#f92672>v-for</span><span style=color:#e6db74>=&#34;(slot, slotName) in $slots&#34;</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>slot</span> <span style=color:#f92672>:name</span><span style=color:#e6db74>=&#34;slotName&#34;</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/el-input&gt;</span>
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>setup</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>defineProps</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>clearable</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> Boolean,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><h3 id=作用域插槽>作用域插槽
<a class=heading-link href=#%e4%bd%9c%e7%94%a8%e5%9f%9f%e6%8f%92%e6%a7%bd><i class="fa fa-link" aria-hidden=true></i></a></h3><p>如果需要封装组件使用了作用域插槽，我们可以通过<code>&lt;template v-slot:slotName="slotProps">&lt;slot name="slotName" v-bind="slotProps"/>&lt;/template></code>来透传作用域插槽插槽。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>template</span> <span style=color:#960050;background-color:#1e0010>#[</span><span style=color:#a6e22e>slotName</span><span style=color:#960050;background-color:#1e0010>]=&#34;</span><span style=color:#a6e22e>slotProps</span><span style=color:#960050;background-color:#1e0010>&#34;</span> <span style=color:#a6e22e>v</span><span style=color:#f92672>-for</span><span style=color:#960050;background-color:#1e0010>=&#34;(</span><span style=color:#a6e22e>slot</span><span style=color:#960050;background-color:#1e0010>,</span> <span style=color:#a6e22e>slotName</span><span style=color:#960050;background-color:#1e0010>)</span> <span style=color:#a6e22e>in</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>slots</span><span style=color:#960050;background-color:#1e0010>&#34;</span> &gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>slot</span> <span style=color:#f92672>:name</span><span style=color:#e6db74>=&#34;slotName&#34;</span> <span style=color:#a6e22e>v</span><span style=color:#f92672>-bind</span><span style=color:#960050;background-color:#1e0010>=&#34;</span><span style=color:#a6e22e>slotProps</span><span style=color:#960050;background-color:#1e0010>&#34;</span>/&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span></code></pre></div><h2 id=封装组件存在的问题>封装组件存在的问题
<a class=heading-link href=#%e5%b0%81%e8%a3%85%e7%bb%84%e4%bb%b6%e5%ad%98%e5%9c%a8%e7%9a%84%e9%97%ae%e9%a2%98><i class="fa fa-link" aria-hidden=true></i></a></h2><h3 id=组件实例属性和方法的调用>组件实例属性和方法的调用
<a class=heading-link href=#%e7%bb%84%e4%bb%b6%e5%ae%9e%e4%be%8b%e5%b1%9e%e6%80%a7%e5%92%8c%e6%96%b9%e6%b3%95%e7%9a%84%e8%b0%83%e7%94%a8><i class="fa fa-link" aria-hidden=true></i></a></h3><p>封装后的组件我们无法按照之前的情况调用组件实例中的属性和方法，比如<code>BaseButton</code>有<code>focus</code>方法,在封装之前我们可以通过下面这种方式调用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 调用BaseButton的组件父组件
</span></span></span><span style=display:flex><span><span style=color:#75715e>// &lt;BaseButton ref=&#34;button&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>focus</span>()
</span></span></code></pre></div><p>对于封装后的组件，由于此时<code>button</code>指向我们的<code>MyButton</code>,并不指向<code>BaseButton</code>的实例，所以我们需要在包装的组件中声明并暴露<code>BaseButton</code>事例</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>//我们封装的组件
</span></span></span><span style=display:flex><span><span style=color:#75715e>// MyButton.Vue
</span></span></span><span style=display:flex><span><span style=color:#75715e>// &lt;BaseButton ref=&#34;button&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>();
</span></span></code></pre></div><blockquote><p>注意如果我们使用 <code>&lt;script setup></code>，是没办法访问实例中的属性的，详情参考<a href=https://vuejs.org/api/sfc-script-setup.html#defineexpose>https://vuejs.org/api/sfc-script-setup.html#defineexpose</a>
此时可以通过<code>defineExpose</code>显式公开<code>ref</code>属性</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 我们封装的组件
</span></span></span><span style=display:flex><span><span style=color:#75715e>// MyButton.Vue
</span></span></span><span style=display:flex><span><span style=color:#75715e>// &lt;BaseButton ref=&#34;button&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>defineExpose</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>button</span>
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>然后在父组件中我就可以通过实例链式调用封装的组件了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// &lt;MyButton ref=&#34;button&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>button</span>.<span style=color:#a6e22e>focus</span>()
</span></span></code></pre></div><h3 id=类型提示消失>类型提示消失
<a class=heading-link href=#%e7%b1%bb%e5%9e%8b%e6%8f%90%e7%a4%ba%e6%b6%88%e5%a4%b1><i class="fa fa-link" aria-hidden=true></i></a></h3><p>如果我们使用了<code>Type Script</code>,我们会发现封装后的组件没有类型提示，解决方法也比较简单，分为以下两种情况</p><h4 id=如果原始类型有导出>如果原始类型有导出
<a class=heading-link href=#%e5%a6%82%e6%9e%9c%e5%8e%9f%e5%a7%8b%e7%b1%bb%e5%9e%8b%e6%9c%89%e5%af%bc%e5%87%ba><i class="fa fa-link" aria-hidden=true></i></a></h4><p>使用<code>Options API</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ts&#34;</span>&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineComponent</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;vue&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>inputProps</span>, <span style=color:#a6e22e>inputEmits</span>, <span style=color:#a6e22e>ElInput</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;element-plus&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>defineComponent</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>components</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>ElInput</span> },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    ...<span style=color:#a6e22e>inputProps</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>emits</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>inputEmits</span>,
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;w-input&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ label }}
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>ElInput</span> <span style=color:#a6e22e>v-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;$attrs&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>template</span> <span style=color:#960050;background-color:#1e0010>#[</span><span style=color:#a6e22e>slotName</span><span style=color:#960050;background-color:#1e0010>]=&#34;</span><span style=color:#a6e22e>slotProps</span><span style=color:#960050;background-color:#1e0010>&#34;</span> <span style=color:#a6e22e>v-for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;(slot, slotName) in $slots&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>slot</span> <span style=color:#a6e22e>:name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slotName&#34;</span> <span style=color:#a6e22e>v-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slotProps&#34;</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>ElInput</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span></code></pre></div><p>使用<code>defineProps</code>以及<code>defineEmits</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>setup</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ts&#34;</span>&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ElInput</span>, <span style=color:#a6e22e>inputEmits</span>, <span style=color:#a6e22e>inputProps</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;element-plus&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>defineProps</span>({
</span></span><span style=display:flex><span>  ...<span style=color:#a6e22e>inputProps</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> String,
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#a6e22e>defineEmits</span>(<span style=color:#a6e22e>inputEmits</span>);
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;w-input&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ label }}
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>el-input</span> <span style=color:#a6e22e>v-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;$attrs&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>template</span> <span style=color:#960050;background-color:#1e0010>#[</span><span style=color:#a6e22e>slotName</span><span style=color:#960050;background-color:#1e0010>]=&#34;</span><span style=color:#a6e22e>slotProps</span><span style=color:#960050;background-color:#1e0010>&#34;</span> <span style=color:#a6e22e>v-for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;(slot, slotName) in $slots&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>slot</span> <span style=color:#a6e22e>:name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slotName&#34;</span> <span style=color:#a6e22e>v-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slotProps&#34;</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>el-input</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span></code></pre></div><blockquote><p>由于目前在<code>defineEmits</code> 以及<code>defineProps</code>中均不能引用导出的类型定义,所以下面的写法是不能生效的，详情参考<a href=https://github.com/vuejs/core/issues/4294>https://github.com/vuejs/core/issues/4294</a></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>setup</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ts&#34;</span>&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ElInput</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;element-plus&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>type</span> { <span style=color:#a6e22e>InputEmits</span>, <span style=color:#a6e22e>InputProps</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;element-plus&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>defineProps</span><span style=color:#f92672>&lt;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>InputProps</span> <span style=color:#f92672>&amp;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>label</span><span style=color:#f92672>?:</span> <span style=color:#a6e22e>string</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>defineEmits</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>InputEmits</span><span style=color:#f92672>&gt;</span>();
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;w-input&#34;</span>&gt;
</span></span><span style=display:flex><span>    {{ label }}
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>el-input</span> <span style=color:#a6e22e>v-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;$attrs&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>template</span> <span style=color:#960050;background-color:#1e0010>#[</span><span style=color:#a6e22e>slotName</span><span style=color:#960050;background-color:#1e0010>]=&#34;</span><span style=color:#a6e22e>slotProps</span><span style=color:#960050;background-color:#1e0010>&#34;</span> <span style=color:#a6e22e>v-for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;(slot, slotName) in $slots&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>slot</span> <span style=color:#a6e22e>:name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slotName&#34;</span> <span style=color:#a6e22e>v-bind</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;slotProps&#34;</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>template</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>el-input</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>template</span>&gt;
</span></span></code></pre></div><h4 id=如果原始类型没有导出>如果原始类型没有导出
<a class=heading-link href=#%e5%a6%82%e6%9e%9c%e5%8e%9f%e5%a7%8b%e7%b1%bb%e5%9e%8b%e6%b2%a1%e6%9c%89%e5%af%bc%e5%87%ba><i class="fa fa-link" aria-hidden=true></i></a></h4><p>我们可以选择将原始代码中定义<code>props</code>和<code>emits</code>并拷贝过来，这种方法对<code>&lt;script setup lang='ts'></code>及<code>&lt;script lang='ts'></code> 均适合</p><div id=cusdis_thread data-host=https://cusdis.com data-app-id=c2b015f9-9a4b-4997-b66f-f9c6ca26ebdd data-page-id=d17c971a997bfa4830e60772ba37f2ec data-page-url=https://chenkai.life/vue/guanyu-vue-zujian-fengzhuang/ data-page-title=关于Vue组件二次封装的技巧总结 data-iframe=/js/cusdis/iframe.umd.js data-style=/js/cusdis/style.css></div></article></section></div></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script><script src=/js/custom.js></script><script src=/js/font.min.js></script></body><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script></html>