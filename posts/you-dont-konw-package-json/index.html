<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=theme-color content="#ffffff"><meta name=color-scheme content="light dark"><meta name=description content="engines 描述模块的兼容性如:
指定模块运行的 node 版本
{ &#34;engines&#34;: { &#34;Node.js&#34;: &#34;>=0.10.3 <15&#34; } } 指定模块运行的 npm 版本
{ &#34;engines&#34;: { &#34;npm&#34;: &#34;~1.0.20&#34; } } 禁止使用 yarn
{ &#34;engines&#34;: { &#34;yarn&#34;: &#34;please use npm&#34; } } files 指定发布到 npm 中的文件,默认是所有文件[&#34;*&#34;] 你也可以通过.npmignore防止某些文件被包含在内，它不会覆盖files字段，但会覆盖其子目录。 如果不存在.npmignore将使用.gitignore替代
一般来说npm上我们只需要发布打包好的文件，对于git则恰好相反我们只需要提交源代码
bin 安装可执行文件 如果你的包都有一个或多个想要安装到 PATH 中的可执行文件，请在package.json中提供一个bin字段，它是命令名到本地文件名的映射。当这个包被全局安装时，该文件将被链接到全局bin所在的位置，因此它可以按名称运行。当这个包作为另一个包的依赖项安装时，该文件将被链接到该包可以直接通过 npm exec 或通过 npm run-script 调用它们时在其他脚本中的名称, 以typescript举例，在package.json文件中存在
{ &#34;bin&#34;: { &#34;tsc&#34;: &#34;./bin/tsc&#34;, &#34;tsserver&#34;: &#34;./bin/tsserver&#34; } } 全局安装 所以通过全局安装npm install -g typescript 我们可以在命令行中使用tsc命令, 通过which tsc 我们可以查看可执行文件在/Users/chenkai/."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="你不知道的package.json"><meta name=twitter:description content="engines 描述模块的兼容性如:
指定模块运行的 node 版本
{ &#34;engines&#34;: { &#34;Node.js&#34;: &#34;>=0.10.3 <15&#34; } } 指定模块运行的 npm 版本
{ &#34;engines&#34;: { &#34;npm&#34;: &#34;~1.0.20&#34; } } 禁止使用 yarn
{ &#34;engines&#34;: { &#34;yarn&#34;: &#34;please use npm&#34; } } files 指定发布到 npm 中的文件,默认是所有文件[&#34;*&#34;] 你也可以通过.npmignore防止某些文件被包含在内，它不会覆盖files字段，但会覆盖其子目录。 如果不存在.npmignore将使用.gitignore替代
一般来说npm上我们只需要发布打包好的文件，对于git则恰好相反我们只需要提交源代码
bin 安装可执行文件 如果你的包都有一个或多个想要安装到 PATH 中的可执行文件，请在package.json中提供一个bin字段，它是命令名到本地文件名的映射。当这个包被全局安装时，该文件将被链接到全局bin所在的位置，因此它可以按名称运行。当这个包作为另一个包的依赖项安装时，该文件将被链接到该包可以直接通过 npm exec 或通过 npm run-script 调用它们时在其他脚本中的名称, 以typescript举例，在package.json文件中存在
{ &#34;bin&#34;: { &#34;tsc&#34;: &#34;./bin/tsc&#34;, &#34;tsserver&#34;: &#34;./bin/tsserver&#34; } } 全局安装 所以通过全局安装npm install -g typescript 我们可以在命令行中使用tsc命令, 通过which tsc 我们可以查看可执行文件在/Users/chenkai/."><meta property="og:title" content="你不知道的package.json"><meta property="og:description" content="engines 描述模块的兼容性如:
指定模块运行的 node 版本
{ &#34;engines&#34;: { &#34;Node.js&#34;: &#34;>=0.10.3 <15&#34; } } 指定模块运行的 npm 版本
{ &#34;engines&#34;: { &#34;npm&#34;: &#34;~1.0.20&#34; } } 禁止使用 yarn
{ &#34;engines&#34;: { &#34;yarn&#34;: &#34;please use npm&#34; } } files 指定发布到 npm 中的文件,默认是所有文件[&#34;*&#34;] 你也可以通过.npmignore防止某些文件被包含在内，它不会覆盖files字段，但会覆盖其子目录。 如果不存在.npmignore将使用.gitignore替代
一般来说npm上我们只需要发布打包好的文件，对于git则恰好相反我们只需要提交源代码
bin 安装可执行文件 如果你的包都有一个或多个想要安装到 PATH 中的可执行文件，请在package.json中提供一个bin字段，它是命令名到本地文件名的映射。当这个包被全局安装时，该文件将被链接到全局bin所在的位置，因此它可以按名称运行。当这个包作为另一个包的依赖项安装时，该文件将被链接到该包可以直接通过 npm exec 或通过 npm run-script 调用它们时在其他脚本中的名称, 以typescript举例，在package.json文件中存在
{ &#34;bin&#34;: { &#34;tsc&#34;: &#34;./bin/tsc&#34;, &#34;tsserver&#34;: &#34;./bin/tsserver&#34; } } 全局安装 所以通过全局安装npm install -g typescript 我们可以在命令行中使用tsc命令, 通过which tsc 我们可以查看可执行文件在/Users/chenkai/."><meta property="og:type" content="article"><meta property="og:url" content="https://chenkai.life/posts/you-dont-konw-package-json/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-09T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-19T20:55:17+08:00"><title>你不知道的package.json · CK's Blog</title><link rel=canonical href=https://chenkai.life/posts/you-dont-konw-package-json/><link rel=stylesheet href=/css/coder.min.0e0f0ac9929898ae6625ca3789e3f9e2e630ead0a5e0f1fe96c1ba7d8774342c.css integrity="sha256-Dg8KyZKYmK5mJco3ieP54uYw6tCl4PH+lsG6fYd0NCw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.d8f89ef09509afb63b9b2595ee174e53cc51ce02a6f6a2179e1621f9389e4340.css integrity="sha256-2Pie8JUJr7Y7myWV7hdOU8xRzgKm9qIXnhYh+TieQ0A=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/custom.min.d12542c00c198b6a07ca9ea5981102805aecab0f5dfd5e3273d8c179088712c4.css integrity="sha256-0SVCwAwZi2oHyp6lmBECgFrsqw9d/V4yc9jBeQiHEsQ=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/favicon.ico><link rel=apple-touch-icon type=image/png sizes=256x256 href=/images/favicon-512x512.png><meta name=generator content="Hugo 0.119.0"><link rel=manifest href=/manifest.webmanifest></head><body class="preload-transitions colorscheme-auto"><div class=float-container><span id=dark-mode-toggle class=colorscheme-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-anheimoshi"/></svg></span></div><details id=table-of-contents-wapper><summary><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></summary></details><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>CK's Blog</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/>Home</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/marks/>Marks</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/ckvv/ckvv.github.io/tree/main/content>Create</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item id=search-content><input class=search-int type=text placeholder=Search>
<button class=search-btn data-type=github>GitHub</button>
<button class=search-btn data-type=google>Google</button></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://chenkai.life/posts/you-dont-konw-package-json/>你不知道的package.json</a></h1><div class=edit-link style=float:right;color:#0366d6><a class=title rel=noopener target=_blank href=https://github.com/ckvv/ckvv.github.io/edit/main/content/posts/you-dont-konw-package-json.md>编辑</a></div></div><div class=post-meta><div class=date><span class=posted-on><svg class="icon" aria-hidden="true"><use xlink:href="#icon-date"/></svg><time datetime=2021-07-09T00:00:00Z>2021-07-09</time></span></div><div class=tags><svg class="icon" aria-hidden="true"><use xlink:href="#icon-biaoqian"/></svg><span class=tag><a href=/tags/npm/>NPM</a></span></div></div></header><div><h2 id=engines>engines
<a class=heading-link href=#engines><i class="fa fa-link" aria-hidden=true></i></a></h2><p>描述模块的兼容性如:</p><p>指定模块运行的 node 版本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;engines&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;Node.js&#34;</span>: <span style=color:#e6db74>&#34;&gt;=0.10.3 &lt;15&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>指定模块运行的 npm 版本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;engines&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;npm&#34;</span>: <span style=color:#e6db74>&#34;~1.0.20&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>禁止使用 yarn</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;engines&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;yarn&#34;</span>: <span style=color:#e6db74>&#34;please use npm&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=files>files
<a class=heading-link href=#files><i class="fa fa-link" aria-hidden=true></i></a></h2><p>指定发布到 npm 中的文件,默认是所有文件<code>["*"]</code>
你也可以通过<code>.npmignore</code>防止某些文件被包含在内，它不会覆盖<code>files</code>字段，但会覆盖其子目录。 如果不存在<code>.npmignore</code>将使用<code>.gitignore</code>替代</p><blockquote><p>一般来说<code>npm</code>上我们只需要发布打包好的文件，对于<code>git</code>则恰好相反我们只需要提交源代码</p></blockquote><h2 id=bin>bin
<a class=heading-link href=#bin><i class="fa fa-link" aria-hidden=true></i></a></h2><p>安装可执行文件
如果你的包都有一个或多个想要安装到 PATH 中的可执行文件，请在<code>package.json</code>中提供一个<code>bin</code>字段，它是命令名到本地文件名的映射。当这个包被全局安装时，该文件将被链接到全局<code>bin</code>所在的位置，因此它可以按名称运行。当这个包作为另一个包的依赖项安装时，该文件将被链接到该包可以直接通过 npm exec 或通过 npm run-script 调用它们时在其他脚本中的名称,
以<code>typescript</code>举例，在<a href=https://github.com/microsoft/TypeScript/blob/315b807489b8ff3a892179488fb0c00398d9b2c3/package.json#L24-L27><code>package.json</code></a>文件中存在</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;bin&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;tsc&#34;</span>: <span style=color:#e6db74>&#34;./bin/tsc&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;tsserver&#34;</span>: <span style=color:#e6db74>&#34;./bin/tsserver&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=全局安装>全局安装
<a class=heading-link href=#%e5%85%a8%e5%b1%80%e5%ae%89%e8%a3%85><i class="fa fa-link" aria-hidden=true></i></a></h3><p>所以通过全局安装<code>npm install -g typescript</code> 我们可以在命令行中使用<code>tsc</code>命令,
通过<code>which tsc</code> 我们可以查看可执行文件在<code>/Users/chenkai/.nvm/versions/node/v14.17.1/bin/tsc</code>
<code>$PATH</code>中定义了<code>/Users/chenkai/.nvm/versions/node/v14.17.1/bin</code>目录，所以我们可以直接运行<code>tsc</code>命令</p><h3 id=作为另一个包的依赖项安装>作为另一个包的依赖项安装
<a class=heading-link href=#%e4%bd%9c%e4%b8%ba%e5%8f%a6%e4%b8%80%e4%b8%aa%e5%8c%85%e7%9a%84%e4%be%9d%e8%b5%96%e9%a1%b9%e5%ae%89%e8%a3%85><i class="fa fa-link" aria-hidden=true></i></a></h3><p>此时我们不能作为全局命令使用<code>tsc</code>, 但是在<code>node_modules/.bin</code>中多了<code>tsc</code>文件指向<code>node_modules/typescript/bin/tsc</code>,我们可以在<code>scripts</code>中调用<code>tsc</code> 如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;scripts&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;build&#34;</span>: <span style=color:#e6db74>&#34;tsc index.ts&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=dependencies>dependencies
<a class=heading-link href=#dependencies><i class="fa fa-link" aria-hidden=true></i></a></h2><p>设置包的依赖项,<code>dependencies</code>设置的依赖包也会被默认安装到<code>node_modules</code>。 一般用来存放代码运行中实际依赖的包。</p><h2 id=devdependencies>devDependencies
<a class=heading-link href=#devdependencies><i class="fa fa-link" aria-hidden=true></i></a></h2><p>设置包的依赖项,和<code>dependencies</code>不同的是，只有在该包根目录执行<code>npm link</code>或者<code>npm install</code>时才会被安装到<code>node_modules</code>。当你把该包作为一个依赖时，<code>devDependencies</code>设置的依赖包***不会**被安装到<code>node_modules</code>。 一般用来存放打包（rollup、esbuild、webpack）、构建（typescript）、测试（jest）等只有在开发环境依赖的包。</p><h2 id=peerdependencies>peerdependencies
<a class=heading-link href=#peerdependencies><i class="fa fa-link" aria-hidden=true></i></a></h2><p>设置包的依赖项, <code>peerdependencies</code>设置的依赖包表达您的包与主机工具或库的兼容性，
如你开发了一个 vue 组件库需要指定在<code>vue 3.x</code>版本中使用，可以这样设置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;peerdependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;vue&#34;</span>: <span style=color:#e6db74>&#34;^3.0&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>如果用户安装了该组件库，并且安装<code>peerdependencies</code>设置的依赖包与用户安装的依赖包指定的版本不一致时，npm 会提示 vue 版本不兼容的信息</p><blockquote><p><code>npm v7</code>开始如果用户没有安装<code>peerdependencies</code>设置的依赖包, <code>peerdependencies</code>设置的依赖包会被默认安装到<code>node_modules</code>，</p></blockquote><h2 id=workspaces>workspaces
<a class=heading-link href=#workspaces><i class="fa fa-link" aria-hidden=true></i></a></h2><p>它支持从单个顶级根包中管理本地文件系统中的多个包,避免手动使用 npm link 来添加对应符号链接到当前 node_modules 文件夹的包的引用。如
当前工作目录中，包含一个名为 workspace-a 的文件夹，其中本身包含一个 package.json</p><pre tabindex=0><code>.
+-- package.json
`-- workspace-a
   `-- package.json
</code></pre><p>在当前工作目录中运行 npm install 后, 文件夹 workspace-a 将符号链接到当前工作目录的 node_modules 文件夹</p><pre tabindex=0><code>.
+-- node_modules
|  `-- workspace-a -&gt; ../workspace-a
+-- package-lock.json
+-- package.json
`-- workspace-a
   `-- package.json
</code></pre><h2 id=其他>其他
<a class=heading-link href=#%e5%85%b6%e4%bb%96><i class="fa fa-link" aria-hidden=true></i></a></h2><h3 id=module>module
<a class=heading-link href=#module><i class="fa fa-link" aria-hidden=true></i></a></h3><p>指定模块入口文件，不同于<code>main</code>字段，将指向一个具有 ES2015 模块语法的模块入口文件，你可以与<code>main</code>字段同时命名，当你用<code>es6</code>语法导入时，打包工具（<code>rollup</code>,<code>webpack</code>）会优先使用该字段对应的入口文件，</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;my-package&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.1.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;main&#34;</span>: <span style=color:#e6db74>&#34;dist/my-package.umd.js&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;module&#34;</span>: <span style=color:#e6db74>&#34;dist/my-package.esm.js&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=type>type
<a class=heading-link href=#type><i class="fa fa-link" aria-hidden=true></i></a></h3><p><a href=https://nodejs.org/dist/latest-v16.x/docs/api/packages.html#packages_type><code>type</code></a>字段定义了 Node.js 用于所有以 package.json 文件作为其最近父级的 .js 文件的模块格式。 当最近的父 package.json 文件包含值为“module”的顶级字段<code>type</code>时，以 .js 结尾的文件将作为 ES 模块加载。</p><h3 id=exports>exports
<a class=heading-link href=#exports><i class="fa fa-link" aria-hidden=true></i></a></h3><p><a href=https://nodejs.org/dist/latest-v16.x/docs/api/packages.html#packages_exports><code>exports</code></a> 字段允许定义包的入口点，当通过 node_modules 查找或对其自身名称的自引用加载的名称导入时。 Node.js 12+ 支持它作为“main”的替代方案，</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;a-package&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;exports&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;.&#34;</span>: <span style=color:#e6db74>&#34;./main.mjs&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;./foo&#34;</span>: <span style=color:#e6db74>&#34;./foo.js&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>并且<code>exports</code>还支持按条件导出</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;module&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;main&#34;</span>: <span style=color:#e6db74>&#34;./index.cjs&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;exports&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;import&#34;</span>: <span style=color:#e6db74>&#34;./wrapper.mjs&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;require&#34;</span>: <span style=color:#e6db74>&#34;./index.cjs&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer></footer><div id=cusdis_thread data-host=https://cusdis.com data-app-id=c2b015f9-9a4b-4997-b66f-f9c6ca26ebdd data-page-id=f0c34e0256c94c434663c2ed2fb4a7d6 data-page-url=https://chenkai.life/posts/you-dont-konw-package-json/ data-page-title=你不知道的package.json data-iframe=/js/cusdis/iframe.umd.js data-style=/js/cusdis/style.css></div></article></section></div></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script>
<script src=/js/custom.js></script>
<script src=/js/font.min.js></script></body><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script></html>