<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta name=theme-color content="#ffffff"><meta name=color-scheme content="light dark"><meta name=description content="背景 某次更新@ckpack/vue-color时引入了严重bug，影响的版本是>=1.0.0,<=1.1.3，并在1.1.4中修复了该问题，问题来了，如何优雅的提示安装该包的人需要升级1.1.4版本呢？
解决办法 首先想到的是百度、谷歌没有，但是找到🤷‍♂️ 哪就看看npm有哪些命令吧npm help access, adduser, audit, bin, bugs, cache, ci, completion, config, dedupe, deprecate, diff, dist-tag, docs, doctor, edit, exec, explain, explore, find-dupes, fund, get, help, hook, init, install, install-ci-test, install-test, link, ll, login, logout, ls, org, outdated, owner, pack, ping, pkg, prefix, profile, prune, publish, rebuild, repo, restart, root, run-script, search, set, set-script, shrinkwrap, star, stars, start, stop, team, test, token, uninstall, unpublish, unstar, update, version, view, whoami 直觉告诉我用unpublish，npm help unpublish 试试, 帮助信息中有一句 Warning Consider using the npm help deprecate command instead, if your intent is to encourage users to upgrade, or if you no longer want to maintain a package."><meta name=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="如何优雅的提示用户需要升级npm依赖包版本？"><meta name=twitter:description content="背景 某次更新@ckpack/vue-color时引入了严重bug，影响的版本是>=1.0.0,<=1.1.3，并在1.1.4中修复了该问题，问题来了，如何优雅的提示安装该包的人需要升级1.1.4版本呢？
解决办法 首先想到的是百度、谷歌没有，但是找到🤷‍♂️ 哪就看看npm有哪些命令吧npm help access, adduser, audit, bin, bugs, cache, ci, completion, config, dedupe, deprecate, diff, dist-tag, docs, doctor, edit, exec, explain, explore, find-dupes, fund, get, help, hook, init, install, install-ci-test, install-test, link, ll, login, logout, ls, org, outdated, owner, pack, ping, pkg, prefix, profile, prune, publish, rebuild, repo, restart, root, run-script, search, set, set-script, shrinkwrap, star, stars, start, stop, team, test, token, uninstall, unpublish, unstar, update, version, view, whoami 直觉告诉我用unpublish，npm help unpublish 试试, 帮助信息中有一句 Warning Consider using the npm help deprecate command instead, if your intent is to encourage users to upgrade, or if you no longer want to maintain a package."><meta property="og:title" content="如何优雅的提示用户需要升级npm依赖包版本？"><meta property="og:description" content="背景 某次更新@ckpack/vue-color时引入了严重bug，影响的版本是>=1.0.0,<=1.1.3，并在1.1.4中修复了该问题，问题来了，如何优雅的提示安装该包的人需要升级1.1.4版本呢？
解决办法 首先想到的是百度、谷歌没有，但是找到🤷‍♂️ 哪就看看npm有哪些命令吧npm help access, adduser, audit, bin, bugs, cache, ci, completion, config, dedupe, deprecate, diff, dist-tag, docs, doctor, edit, exec, explain, explore, find-dupes, fund, get, help, hook, init, install, install-ci-test, install-test, link, ll, login, logout, ls, org, outdated, owner, pack, ping, pkg, prefix, profile, prune, publish, rebuild, repo, restart, root, run-script, search, set, set-script, shrinkwrap, star, stars, start, stop, team, test, token, uninstall, unpublish, unstar, update, version, view, whoami 直觉告诉我用unpublish，npm help unpublish 试试, 帮助信息中有一句 Warning Consider using the npm help deprecate command instead, if your intent is to encourage users to upgrade, or if you no longer want to maintain a package."><meta property="og:type" content="article"><meta property="og:url" content="https://chenkai.life/posts/npm-deprecate-version/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-09T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-25T19:31:20+08:00"><title>如何优雅的提示用户需要升级npm依赖包版本？ · CK's Blog</title><link rel=canonical href=https://chenkai.life/posts/npm-deprecate-version/><link rel=stylesheet href=/css/coder.min.0e0f0ac9929898ae6625ca3789e3f9e2e630ead0a5e0f1fe96c1ba7d8774342c.css integrity="sha256-Dg8KyZKYmK5mJco3ieP54uYw6tCl4PH+lsG6fYd0NCw=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.d8f89ef09509afb63b9b2595ee174e53cc51ce02a6f6a2179e1621f9389e4340.css integrity="sha256-2Pie8JUJr7Y7myWV7hdOU8xRzgKm9qIXnhYh+TieQ0A=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/custom.min.56610f8c63ea4ca06cdac03f4fafe3e818c64566f988301b72895eb047082c51.css integrity="sha256-VmEPjGPqTKBs2sA/T6/j6BjGRWb5iDAbcolesEcILFE=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/favicon.ico><link rel=apple-touch-icon type=image/png sizes=256x256 href=/images/favicon-512x512.png><meta name=generator content="Hugo 0.101.0"><link rel=manifest href=/manifest.webmanifest></head><body class="preload-transitions colorscheme-auto"><div class=float-container><span id=dark-mode-toggle class=colorscheme-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-anheimoshi"/></svg></span></div><details id=table-of-contents-wapper><summary><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></summary></details><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>CK's Blog</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><svg class="icon" aria-hidden="true"><use xlink:href="#icon-caidan"/></svg></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/>Home</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/marks/>Marks</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/ckvv/ckvv.github.io/new/main/content>Create</a></li><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item id=search-content><input class=search-int type=text placeholder=Search>
<button class=search-btn data-type=github>GitHub</button>
<button class=search-btn data-type=google>Google</button></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://chenkai.life/posts/npm-deprecate-version/>如何优雅的提示用户需要升级npm依赖包版本？</a></h1><div class=edit-link style=float:right;color:#0366d6><a class=title rel=noopener target=_blank href=https://github.com/ckvv/ckvv.github.io/edit/main/content/posts/npm-deprecate-version.md>编辑</a></div></div><div class=post-meta><div class=date><span class=posted-on><svg class="icon" aria-hidden="true"><use xlink:href="#icon-date"/></svg><time datetime=2021-07-09T00:00:00Z>2021-07-09</time></span></div><div class=tags><svg class="icon" aria-hidden="true"><use xlink:href="#icon-biaoqian"/></svg><span class=tag><a href=/tags/npm/>NPM</a></span></div></div></header><div><h2 id=背景>背景
<a class=heading-link href=#%e8%83%8c%e6%99%af><i class="fa fa-link" aria-hidden=true></i></a></h2><p>某次更新<code>@ckpack/vue-color</code>时引入了严重bug，影响的版本是<code>>=1.0.0</code>,<code>&lt;=1.1.3</code>，并在<code>1.1.4</code>中修复了该问题，问题来了，如何优雅的提示安装该包的人需要升级<code>1.1.4</code>版本呢？</p><h2 id=解决办法>解决办法
<a class=heading-link href=#%e8%a7%a3%e5%86%b3%e5%8a%9e%e6%b3%95><i class="fa fa-link" aria-hidden=true></i></a></h2><ul><li>首先想到的是百度、谷歌没有，但是找到🤷‍♂️</li><li>哪就看看npm有哪些命令吧<code>npm help</code></li></ul><pre tabindex=0><code>    access, adduser, audit, bin, bugs, cache, ci, completion,
    config, dedupe, deprecate, diff, dist-tag, docs, doctor,
    edit, exec, explain, explore, find-dupes, fund, get, help,
    hook, init, install, install-ci-test, install-test, link,
    ll, login, logout, ls, org, outdated, owner, pack, ping,
    pkg, prefix, profile, prune, publish, rebuild, repo,
    restart, root, run-script, search, set, set-script,
    shrinkwrap, star, stars, start, stop, team, test, token,
    uninstall, unpublish, unstar, update, version, view, whoami
</code></pre><ul><li>直觉告诉我用<code>unpublish</code>，<code>npm help unpublish</code> 试试,
帮助信息中有一句</li></ul><pre tabindex=0><code>   Warning
       Consider using the npm help deprecate command instead, if your intent is to encourage users to upgrade, or if you no longer want to maintain a package.
</code></pre><p>很明显直觉是不对的，这里npm告诉我们鼓励用户升级的话用<code>deprecate</code>命令</p><ul><li>看看<code>deprecate</code>是干什么的，<code>npm help deprecate</code></li></ul><pre tabindex=0><code>Deprecate a version of a package
</code></pre><p>中文意思弃用包版本，用起来很简单<code>npm deprecate my-thing@"&lt; 0.2.3" "critical bug fixed in v0.2.3"</code> 其中的版本只要是<a href=https://github.com/npm/node-semver#versions>https://github.com/npm/node-semver#versions</a>支持的均可以，</p><ul><li>声明弃用版本</li></ul><pre tabindex=0><code>npm deprecate @ckpack/vue-color@&#34;&gt;=1.0.0 &lt;=1.1.3&#34; &#34;Critical bug fixed in v1.1.4
</code></pre><h2 id=声明弃用版本后npm做了什么>声明弃用版本后npm做了什么
<a class=heading-link href=#%e5%a3%b0%e6%98%8e%e5%bc%83%e7%94%a8%e7%89%88%e6%9c%ac%e5%90%8enpm%e5%81%9a%e4%ba%86%e4%bb%80%e4%b9%88><i class="fa fa-link" aria-hidden=true></i></a></h2><h3 id=官网的变化>官网的变化
<a class=heading-link href=#%e5%ae%98%e7%bd%91%e7%9a%84%e5%8f%98%e5%8c%96><i class="fa fa-link" aria-hidden=true></i></a></h3><p>打开npm对应地址<a href=https://www.npmjs.com/package/@ckpack/vue-color>https://www.npmjs.com/package/@ckpack/vue-color</a></p><p><img src=https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89c5356a0f764e5c84eb094d833cb073~tplv-k3u1fbpfcp-watermark.image? alt="截屏2021-10-21 下午7.09.29.png">
我们可以发现被声明弃用的版本被隐藏掉了，点击<code>show deprecated versions</code>后才会显示出来</p><h3 id=如果我们安装弃用的版本呢>如果我们安装弃用的版本呢？
<a class=heading-link href=#%e5%a6%82%e6%9e%9c%e6%88%91%e4%bb%ac%e5%ae%89%e8%a3%85%e5%bc%83%e7%94%a8%e7%9a%84%e7%89%88%e6%9c%ac%e5%91%a2><i class="fa fa-link" aria-hidden=true></i></a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;dependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@ckpack/vue-color&#34;</span>: <span style=color:#e6db74>&#34;^1.1.3&#34;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>yarn install</code>没有任何变化，命令行也没有任何提醒？？<strong><code>不是吧</code></strong> 那我声明弃用版本有什么用呢？别急，我们打开<code>node_modules</code> 对应的包看看，果然<code>package.json</code>中对应的版本是<code>"version": "1.1.4",</code>这是由于<code>"@ckpack/vue-color": "^1.1.3",</code> 其中<code>^version</code>是与版本兼容的意思,我们试试</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;dependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@ckpack/vue-color&#34;</span>: <span style=color:#e6db74>&#34;1.1.3&#34;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>果然命令行中出现了警告<code>warning @ckpack/vue-color@1.1.3: Critical bug fixed in v1.1.4</code> 此时npm自动不会升级版本，我们安装的版本就是<code>1.1.3</code></p></div><footer></footer><div id=cusdis_thread data-host=https://cusdis.com data-app-id=c2b015f9-9a4b-4997-b66f-f9c6ca26ebdd data-page-id=a96d64fc9f41db1ec949db67cede0a90 data-page-url=https://chenkai.life/posts/npm-deprecate-version/ data-page-title=如何优雅的提示用户需要升级npm依赖包版本？ data-iframe=/js/cusdis/iframe.umd.js data-style=/js/cusdis/style.css></div></article></section></div></main><script src=/js/coder.min.cb0c595e02234420f3ad3886bf4a9bd2874d0e1e78e090138a9ef158b35aaf17.js integrity="sha256-ywxZXgIjRCDzrTiGv0qb0odNDh544JATip7xWLNarxc="></script>
<script src=/js/custom.js></script>
<script src=/js/font.min.js></script></body><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script></html>